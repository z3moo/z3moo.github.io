@tailwind base;
@tailwind components;
@tailwind utilities;

@font-face {
  font-family: 'Geist';
  src: url('/fonts/GeistVF.subset.woff2') format('woff2');
  font-weight: 100 900;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: 'Geist Mono';
  src: url('/fonts/GeistMonoVF.subset.woff2') format('woff2');
  font-weight: 100 900;
  font-style: normal;
  font-display: swap;
}

@layer base {
  :root {
    --flexoki-black: 16.96% 0.002 17.32;
    --flexoki-black-rgb: 22.28% 0.002 67.7;
    --flexoki-paper: 99.01% 0.016 95.22;
    --flexoki-paper-rgb: 0.99 0.0159 98.99;
    --flexoki-200-rgb: 0.85 0.0137 102.05;
    --flexoki-50: 95.37% 0.015 98.29;
    --flexoki-100: 91.74% 0.015 98.3;
    --flexoki-150: 88.1% 0.014 97.46;
    --flexoki-200: 84.63% 0.014 102.05;
    --flexoki-300: 77.21% 0.013 96.47;
    --flexoki-400: 0.7 0.0103 93.62;
    --flexoki-500: 61.69% 0.008 88.67;
    --flexoki-600: 53.75% 0.008 97.45;
    --flexoki-700: 45.31% 0.005 91.5;
    --flexoki-800: 36.51% 0.004 67.69;
    --flexoki-850: 32.14% 0.004 84.58;
    --flexoki-900: 27.34% 0.002 67.73;
    --flexoki-950: 22.28% 0.002 67.7;

    --flexoki-red-50: #ffe1d5;
    --flexoki-red-100: #ffcabb;
    --flexoki-red-150: #fdb2a2;
    --flexoki-red-200: #f89a8a;
    --flexoki-red-300: #e8705f;
    --flexoki-red-400: #d14d41;
    --flexoki-red-500: #c03e35;
    --flexoki-red-600: #af3029;
    --flexoki-red-700: #942822;
    --flexoki-red-800: #6c201c;
    --flexoki-red-850: #551b18;
    --flexoki-red-900: #3e1715;
    --flexoki-red-950: #261312;
    --flexoki-orange-50: #ffe7ce;
    --flexoki-orange-100: #fed3af;
    --flexoki-orange-150: #fcc192;
    --flexoki-orange-200: #f9ae77;
    --flexoki-orange-300: #ec8b49;
    --flexoki-orange-400: #da702c;
    --flexoki-orange-500: #cb6120;
    --flexoki-orange-600: #bc5215;
    --flexoki-orange-700: #9d4310;
    --flexoki-orange-800: #71320d;
    --flexoki-orange-850: #59290d;
    --flexoki-orange-900: #40200d;
    --flexoki-orange-950: #27180e;
    --flexoki-yellow-50: #faeec6;
    --flexoki-yellow-100: #f6e2a0;
    --flexoki-yellow-150: #f1d67e;
    --flexoki-yellow-200: #eccb60;
    --flexoki-yellow-300: #dfb431;
    --flexoki-yellow-400: #d0a215;
    --flexoki-yellow-500: #be9207;
    --flexoki-yellow-600: #ad8301;
    --flexoki-yellow-700: #8e6b01;
    --flexoki-yellow-800: #664d01;
    --flexoki-yellow-850: #503d02;
    --flexoki-yellow-900: #3a2d04;
    --flexoki-yellow-950: #241e08;
    --flexoki-green-50: #edeecf;
    --flexoki-green-100: #dde2b2;
    --flexoki-green-150: #cdd597;
    --flexoki-green-200: #bec97e;
    --flexoki-green-300: #a0af54;
    --flexoki-green-400: #879a39;
    --flexoki-green-500: #768d21;
    --flexoki-green-600: #66800b;
    --flexoki-green-700: #536907;
    --flexoki-green-800: #3d4c07;
    --flexoki-green-850: #313d07;
    --flexoki-green-900: #252d09;
    --flexoki-green-950: #1a1e0c;
    --flexoki-cyan-50: #ddf1e4;
    --flexoki-cyan-100: #bfe8d9;
    --flexoki-cyan-150: #a2dece;
    --flexoki-cyan-200: #87d3c3;
    --flexoki-cyan-300: #5abdac;
    --flexoki-cyan-400: #3aa99f;
    --flexoki-cyan-500: #2f968d;
    --flexoki-cyan-600: #24837b;
    --flexoki-cyan-700: #1c6c66;
    --flexoki-cyan-800: #164f4a;
    --flexoki-cyan-850: #143f3c;
    --flexoki-cyan-900: #122f2c;
    --flexoki-cyan-950: #101f1d;
    --flexoki-blue-50: #e1eceb;
    --flexoki-blue-100: #c6dde8;
    --flexoki-blue-150: #abcfe2;
    --flexoki-blue-200: #92bfdb;
    --flexoki-blue-300: #66a0c8;
    --flexoki-blue-400: #4385be;
    --flexoki-blue-500: #3171b2;
    --flexoki-blue-600: #205ea6;
    --flexoki-blue-700: #1a4f8c;
    --flexoki-blue-800: #163b66;
    --flexoki-blue-850: #133051;
    --flexoki-blue-900: #12253b;
    --flexoki-blue-950: #101a24;
    --flexoki-purple-50: #f0eaec;
    --flexoki-purple-100: #e2d9e9;
    --flexoki-purple-150: #d3cae6;
    --flexoki-purple-200: #c4b9e0;
    --flexoki-purple-300: #a699d0;
    --flexoki-purple-400: #8b7ec8;
    --flexoki-purple-500: #735eb5;
    --flexoki-purple-600: #5e409d;
    --flexoki-purple-700: #4f3685;
    --flexoki-purple-800: #3c2a62;
    --flexoki-purple-850: #31234e;
    --flexoki-purple-900: #261c39;
    --flexoki-purple-950: #1a1623;
    --flexoki-magenta-50: #fee4e5;
    --flexoki-magenta-100: #fccfda;
    --flexoki-magenta-150: #f9b9cf;
    --flexoki-magenta-200: #f4a4c2;
    --flexoki-magenta-300: #e47da8;
    --flexoki-magenta-400: #ce5d97;
    --flexoki-magenta-500: #b74583;
    --flexoki-magenta-600: #a02f6f;
    --flexoki-magenta-700: #87285e;
    --flexoki-magenta-800: #641f46;
    --flexoki-magenta-850: #4f1b39;
    --flexoki-magenta-900: #39172b;
    --flexoki-magenta-950: #24131d;

    --flexoki-bg: var(--flexoki-paper);
    --flexoki-bg-2: var(--flexoki-paper-rgb);

    --flexoki-ui: var(--flexoki-100);
    --flexoki-ui-2: var(--flexoki-150);
    --flexoki-ui-3: var(--flexoki-200);

    --flexoki-tx: var(--flexoki-black);
    --flexoki-tx-2: var(--flexoki-600);
    --flexoki-tx-3: var(--flexoki-300);

    --flexoki-re: var(--flexoki-red-600);

    --additive: 0.56 0.1497 141.12;
    --additive-foreground: 0.2 0 0;

    --background: var(--flexoki-bg);
    --foreground: var(--flexoki-tx);
    --card: var(--flexoki-bg);
    --card-foreground: var(--flexoki-tx);
    --popover: var(--flexoki-bg);
    --popover-foreground: var(--flexoki-tx);
    --primary: var(--flexoki-tx);
    --primary-foreground: var(--flexoki-bg);
    --secondary: var(--flexoki-ui-2);
    --secondary-foreground: var(--flexoki-tx-2);
    --muted: var(--flexoki-bg-2);
    --muted-foreground: var(--flexoki-tx-2);
    --accent: var(--flexoki-ui);
    --accent-foreground: var(--flexoki-tx-2);
    --destructive: var(--flexoki-re);
    --destructive-foreground: var(--flexoki-bg);
    --border: var(--flexoki-ui-2);
    --input: var(--flexoki-ui-2);
    --ring: var(--flexoki-ui-3);
    --radius: 0.5rem;
  }

  .dark {
    --flexoki-bg: var(--flexoki-black);
    --flexoki-bg-2: var(--flexoki-black-rgb);

    --flexoki-ui: var(--flexoki-900);
    --flexoki-ui-2: var(--flexoki-850);
    --flexoki-ui-3: var(--flexoki-800);

    --flexoki-tx: var(--flexoki-200);
    --flexoki-tx-2: var(--flexoki-500);
    --flexoki-tx-3: var(--flexoki-700);

    --flexoki-re: var(--flexoki-red-400);
  }

  *,
  *::before,
  *::after {
    @apply border-border;
  }

  html {
    color-scheme: light;
    @apply bg-background text-foreground;
    position: relative;

    &::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: url('../assets/images/grain.png');
      background-repeat: repeat;
      background-size: 100px 100px;
      z-index: -1;
    }

    &.dark {
      color-scheme: dark;

      &::before {
        filter: invert(1);
      }
    }

    ::-webkit-scrollbar-corner {
      @apply bg-transparent;
    }
  }

  .disable-transitions,
  .disable-transitions * {
    @apply !transition-none;
  }
}

@layer components {
  article {
    @apply prose-headings:scroll-mt-20 prose-headings:break-words first:prose-headings:mt-0 prose-p:break-words prose-a:!break-words prose-a:!decoration-muted-foreground prose-a:underline-offset-[3px] prose-a:transition-colors hover:prose-a:!decoration-foreground prose-pre:!px-0 prose-img:mx-auto;

    .katex-display {
      @apply overflow-x-auto overflow-y-hidden py-4;
    }

    /* Removes background from <mark> elements */
    mark {
      @apply bg-transparent;
    }

    /* Blanket syntax highlighting */
    code[data-theme*=' '] {
      span {
        color: var(--shiki-light);
      }

      .dark & span {
        color: var(--shiki-dark);
      }
    }

    /* Inline code */
    :not(pre) > code {
      @apply relative rounded bg-muted/50 px-[0.3rem] py-[0.2rem] font-mono text-sm font-medium;
    }

    /* Code blocks */
    figure[data-rehype-pretty-code-figure] {
      @apply relative;

      /* Code block titles */
      [data-rehype-pretty-code-title] {
        @apply break-words rounded-t-xl border-x border-t px-4 py-2 text-sm font-medium text-foreground;

        /* Remove top margin from code block if a title is present */
        & + pre {
          @apply mt-0 rounded-t-none;
        }
      }

      /* Shadcn-like scrollbar */
      pre::-webkit-scrollbar {
        @apply h-2.5 w-2.5;
      }
      pre::-webkit-scrollbar-track {
        @apply bg-transparent;
      }
      pre::-webkit-scrollbar-thumb {
        @apply rounded-full bg-border bg-clip-padding p-px;
      }

      /* Code block styles */
      pre {
        @apply static max-h-[600px] overflow-auto rounded-xl border bg-secondary/20 py-4 text-sm leading-loose;

        /* Code block content */
        > code {
          @apply whitespace-pre-wrap;
          counter-reset: line;

          /* For code blocks with line numbers */
          &[data-line-numbers] {
            > [data-line]::before {
              counter-increment: line;
              content: counter(line);
              @apply mr-4 inline-block w-4 text-right text-muted-foreground;
            }
          }

          /* For each line in the code block */
          > [data-line] {
            @apply px-4;
          }

          /* Highlighted lines */
          [data-highlighted-line] {
            @apply bg-foreground/10;
          }

          /* Highlighted characters */
          [data-highlighted-chars] > span {
            @apply bg-muted-foreground/40 py-[7px];
          }

          /* Diff lines */
          .diff {
            &.add {
              @apply bg-additive/15;
            }
            &.remove {
              @apply bg-destructive/15;
            }
          }

          /* Copy button */
          > button:has(> span) {
            @apply right-0.5 top-[3px] m-0 size-8 rounded-md bg-background p-1 backdrop-blur-none transition-all;
          }
        }
      }
    }
  }
}

.gallery-item {
  @apply rounded-sm transition-all;
}

.image-container {
  @apply relative flex items-center justify-center;
}

.gallery-image {
  @apply animate-fade cursor-zoom-in grayscale hover:grayscale-0;
}

.gallery-placeholder {
  @apply relative z-[1] h-full max-h-[90vh] w-full object-contain opacity-100 transition-opacity duration-100 ease-in-out sm:max-w-[90vw];
}

.gallery-placeholder-loaded {
  @apply opacity-0 blur-none;
}

.gallery-image-zoom {
  @apply relative z-[2] mx-auto aspect-auto h-auto max-h-[90vh] w-auto object-contain opacity-0 transition-opacity duration-100 ease-in-out sm:max-w-[90vw];
}

.gallery-image-zoom-loaded {
  @apply cursor-zoom-out opacity-100;
}
